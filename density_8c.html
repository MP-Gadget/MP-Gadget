<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/density.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">density.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SPH density computation and smoothing length determination.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &quot;<a class="el" href="physconst_8h_source.html">physconst.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="walltime_8h_source.html">walltime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cooling_8h_source.html">cooling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="density_8h_source.html">density.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="treewalk_8h_source.html">treewalk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timefac_8h_source.html">timefac.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slotsmanager_8h_source.html">slotsmanager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timestep_8h_source.html">timestep.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gravity_8h_source.html">gravity.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="winds_8h_source.html">winds.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for density.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c__incl.svg" width="2851" height="710"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="density_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDensityPriv.html">DensityPriv</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afa3ec824b4fabad29715d26181bd89d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)&#160;&#160;&#160;((struct <a class="el" href="structDensityPriv.html">DensityPriv</a>*) ((tw)-&gt;priv))</td></tr>
<tr class="separator:afa3ec824b4fabad29715d26181bd89d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a539fe4bcf5b8522bc5d345799f1503e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a539fe4bcf5b8522bc5d345799f1503e1">set_densitypar</a> (struct <a class="el" href="structdensity__params.html">density_params</a> dp)</td></tr>
<tr class="separator:a539fe4bcf5b8522bc5d345799f1503e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfed12ec8143f2406ebd7b8d140bf2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a6cfed12ec8143f2406ebd7b8d140bf2c">set_density_params</a> (<a class="el" href="structParameterSet.html">ParameterSet</a> *ps)</td></tr>
<tr class="separator:a6cfed12ec8143f2406ebd7b8d140bf2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e510a287a10de773a4a0f14db2ff52"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a> (enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a> KernelType)</td></tr>
<tr class="separator:a23e510a287a10de773a4a0f14db2ff52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40e53af730ce9956d564e3dc18d6f0e"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a> (void)</td></tr>
<tr class="separator:ac40e53af730ce9956d564e3dc18d6f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300eea2fe5e00af45e3c65215ff5bfe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a> (int PI, double MinEgySpec, double a3inv, double <a class="el" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>)</td></tr>
<tr class="separator:a300eea2fe5e00af45e3c65215ff5bfe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d3cfe0024d97740707f82efde883ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a> (int i, <a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *VelPred, const double FgravkickB, double gravkick, double hydrokick)</td></tr>
<tr class="separator:a10d3cfe0024d97740707f82efde883ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a146d61fe2d2f53ea9b7fabf2ea5e90b7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a146d61fe2d2f53ea9b7fabf2ea5e90b7">density_ngbiter</a> (<a class="el" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a> *I, <a class="el" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a> *O, <a class="el" href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a> *iter, <a class="el" href="structLocalTreeWalk.html">LocalTreeWalk</a> *lv)</td></tr>
<tr class="separator:a146d61fe2d2f53ea9b7fabf2ea5e90b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9776b9b60703f24e380d743918248c3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#af9776b9b60703f24e380d743918248c3">density_haswork</a> (int n, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:af9776b9b60703f24e380d743918248c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39f5a18f937d210e258c8e8cb710044"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#ae39f5a18f937d210e258c8e8cb710044">density_postprocess</a> (int i, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:ae39f5a18f937d210e258c8e8cb710044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb05cdc00cf397be5c4dd467308cc4bd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#abb05cdc00cf397be5c4dd467308cc4bd">density_check_neighbours</a> (int i, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:abb05cdc00cf397be5c4dd467308cc4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad169b636ff2e25d362af36cdedb8a3f2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#ad169b636ff2e25d362af36cdedb8a3f2">density_reduce</a> (int place, <a class="el" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a> *remote, enum <a class="el" href="treewalk_8h.html#a504d8280eaa376504899398c68577cef">TreeWalkReduceMode</a> mode, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:ad169b636ff2e25d362af36cdedb8a3f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338ab2cf6c2f52522edb746f04061af9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a338ab2cf6c2f52522edb746f04061af9">density_copy</a> (int place, <a class="el" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a> *I, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:a338ab2cf6c2f52522edb746f04061af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49d34dfc3f4e37cac0953d5bc1417a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> (const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *act, int update_hsml, int DoEgyDensity, int BlackHoleOn, double MinEgySpec, const <a class="el" href="structDriftKickTimes.html">DriftKickTimes</a> times, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *SPH_predicted, <a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *GradRho, const <a class="el" href="structForceTree.html">ForceTree</a> *const tree)</td></tr>
<tr class="separator:ac49d34dfc3f4e37cac0953d5bc1417a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6af534268ae11ed2bad17f5300af23bc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a> (int nsph)</td></tr>
<tr class="separator:a6af534268ae11ed2bad17f5300af23bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c7ec2e7345138dfdd37b64f3f4554a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a> (struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *sph_scratch)</td></tr>
<tr class="separator:ab4c7ec2e7345138dfdd37b64f3f4554a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9c4ca3648e6ac54cdb5adb45acc2e4e3"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structdensity__params.html">density_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a></td></tr>
<tr class="separator:a9c4ca3648e6ac54cdb5adb45acc2e4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SPH density computation and smoothing length determination. </p>
<p>This file contains the "first SPH loop", where the SPH densities and some auxiliary quantities are computed. There is also functionality that corrects the smoothing length if needed. </p>

<p class="definition">Definition in file <a class="el" href="density_8c_source.html">density.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afa3ec824b4fabad29715d26181bd89d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3ec824b4fabad29715d26181bd89d7">&#9670;&nbsp;</a></span>DENSITY_GET_PRIV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DENSITY_GET_PRIV</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tw</td><td>)</td>
          <td>&#160;&#160;&#160;((struct <a class="el" href="structDensityPriv.html">DensityPriv</a>*) ((tw)-&gt;priv))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00166">166</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac49d34dfc3f4e37cac0953d5bc1417a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49d34dfc3f4e37cac0953d5bc1417a4">&#9670;&nbsp;</a></span>density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void density </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>update_hsml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DoEgyDensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackHoleOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structDriftKickTimes.html">DriftKickTimes</a>&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *&#160;</td>
          <td class="paramname"><em>SPH_predicted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *&#160;</td>
          <td class="paramname"><em>GradRho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structForceTree.html">ForceTree</a> *const&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the local density for each active SPH particle, the number of neighbours in the current smoothing radius, and the divergence and rotation of the velocity field. The pressure is updated as well. If a particle with its smoothing region is fully inside the local domain, it is not exported to the other processors. The function also detects particles that have a number of neighbours outside the allowed tolerance range. For these particles, the smoothing length is adjusted accordingly, and the <a class="el" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density()</a> computation is called again. Note that the smoothing length is not allowed to fall below the lower bound set by MinGasHsml (this may mean that one has to deal with substantially more than normal number of neighbours.) </p>

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00203">203</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="structTreeWalk.html">TreeWalk</a> tw[1] = {{0}};</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">struct </span><a class="code" href="structDensityPriv.html">DensityPriv</a> priv[1];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">ev_label</a> = <span class="stringliteral">&quot;DENSITY&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">visit</a> = (<a class="code" href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a>) <a class="code" href="treewalk_8c.html#a1878fddf49185074fd570a46f3eea372">treewalk_visit_nolist_ngbiter</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aafe4f27abb67d3959e711ef6787c9b75">NoNgblist</a> = 1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">ngbiter_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">ngbiter</a> = (<a class="code" href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a>) <a class="code" href="density_8c.html#a146d61fe2d2f53ea9b7fabf2ea5e90b7">density_ngbiter</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">haswork</a> = <a class="code" href="density_8c.html#af9776b9b60703f24e380d743918248c3">density_haswork</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">fill</a> = (<a class="code" href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a>) <a class="code" href="density_8c.html#a338ab2cf6c2f52522edb746f04061af9">density_copy</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">reduce</a> = (<a class="code" href="treewalk_8h.html#a2b5a07b25001ac6e9e628d4eb0493b8c">TreeWalkReduceResultFunction</a>) <a class="code" href="density_8c.html#ad169b636ff2e25d362af36cdedb8a3f2">density_reduce</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">postprocess</a> = (<a class="code" href="treewalk_8h.html#a80f59f147efe7c27b601024d819769db">TreeWalkProcessFunction</a>) <a class="code" href="density_8c.html#ae39f5a18f937d210e258c8e8cb710044">density_postprocess</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">query_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">result_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">priv</a> = priv;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a> = tree;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">double</span> timeall = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">double</span> timecomp, timecomm, timewait;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> atime = exp(<a class="code" href="test__timefac_8c.html#a5b77523ed91eb413cb28b12d8c2ceb46">loga_from_ti</a>(<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Left = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Left&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Right = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Right&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;NumNgb&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> (*) [3]) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Rot&quot;</span>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a> * <span class="keyword">sizeof</span>(priv-&gt;Rot[0]));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/* This one stores the gradient for h finding. The factor stored in SPHP-&gt;DhsmlEgyDensityFactor depends on whether PE SPH is enabled.*/</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DhsmlDensityFactor = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENSITY_GET_PRIV(tw)-&gt;DhsmlDensity&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;update_hsml = <a class="code" href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">update_hsml</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DoEgyDensity = <a class="code" href="structDensityPriv.html#a30a0d9c3929eff9d2b5036c99af08aae">DoEgyDensity</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DesNumNgb = <a class="code" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a>(<a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml = <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">MinGasHsmlFractional</a> * (<a class="code" href="gravity_8h.html#ad2fea9ffa95e668ed71b563e817d2e1b">FORCE_SOFTENING</a>(1, 1)/2.8);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;BlackHoleOn = <a class="code" href="structDensityPriv.html#aa937dcae41f2029c427ea18b69c23b63">BlackHoleOn</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;SPH_predicted = <a class="code" href="structDensityPriv.html#a3f351782202a9b99b8642dc873e870cd">SPH_predicted</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;GradRho = <a class="code" href="structDensityPriv.html#a90b86b68ad79acb839c327694fadd8be">GradRho</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">/* Init Left and Right: this has to be done before treewalk */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>; i++)  {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordtype">int</span> p_i = act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> ? act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>[i] : i;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">/* We only really need active particles with work</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         * but I don&#39;t want to read the particle table here*/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Right[p_i] = tree-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb[p_i] = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Left[p_i] = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    priv-&gt;a3inv = pow(atime, -3);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    priv-&gt;MinEgySpec = <a class="code" href="structDensityPriv.html#aab71415faa924332b63c73a53dab3032">MinEgySpec</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* Factor this out since all particles have the same drift time*/</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    priv-&gt;FgravkickB = <a class="code" href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a1c5fe7d114a58455177e26d13db726cf">PM_kick</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    memset(priv-&gt;gravkicks, 0, <span class="keyword">sizeof</span>(priv-&gt;gravkicks[0])*(<a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>+1));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    memset(priv-&gt;hydrokicks, 0, <span class="keyword">sizeof</span>(priv-&gt;hydrokicks[0])*(<a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>+1));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">/* Compute the factors to move a current kick times velocity to the drift time velocity.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">     * We need to do the computation for all timebins up to the maximum because even inactive</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">     * particles may have interactions. */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span>(i = <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">mintimebin</a>; i &lt;= <a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>; i++)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        priv-&gt;gravkicks[i] = <a class="code" href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">Ti_kick</a>[i], <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        priv-&gt;hydrokicks[i] = <a class="code" href="timefac_8c.html#a2bfd65177ba7cde60bbe22eb0a84f96b">get_exact_hydrokick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">Ti_kick</a>[i], <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    priv-&gt;times = &amp;<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>; i++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordtype">int</span> p_i = act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> ? act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>[i] : i;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].Type == 0 &amp;&amp; !<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].IsGarbage) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordtype">int</span> bin = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].TimeBin;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a> = <a class="code" href="timebinmgr_8c.html#a7166c93d068baea59abf2ef8cee3c7aa">dloga_from_dti</a>(priv-&gt;times-&gt;Ti_Current - priv-&gt;times-&gt;Ti_kick[bin], priv-&gt;times-&gt;Ti_Current);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            priv-&gt;SPH_predicted-&gt;EntVarPred[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI] = <a class="code" href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI, priv-&gt;MinEgySpec, priv-&gt;a3inv, <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a>(p_i, priv-&gt;SPH_predicted-&gt;VelPred + 3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI, priv-&gt;FgravkickB, priv-&gt;gravkicks[bin], priv-&gt;hydrokicks[bin]);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">/* allocate buffers to arrange communication */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/SPH/Density/Init&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* Do the treewalk with looping for hsml*/</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="treewalk_8c.html#a72643adf5c7952933b8f5fbb27d45a97">treewalk_do_hsml_loop</a>(tw, act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>, act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>, <a class="code" href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">update_hsml</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#ac506e8ace51a716a2fec6c17e0b5dcc5">DhsmlDensityFactor</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#a9e58815ff452f7207307fff63c8abf2e">Rot</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#aa152970e40c653538d5c43853537a154">NumNgb</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#aac6a03e3c7969e390efeafea0c9c56be">Right</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#a52ab30c25d6f44a990491893a9be9f2a">Left</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">/* collect some timing information */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    timeall = <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<a class="code" href="walltime_8h.html#a5cedff8706bf3a249bd5e3c365b67964">WALLTIME_IGNORE</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    timecomp = tw-&gt;<a class="code" href="structTreeWalk.html#a714d0465e0498a5a8d0b698d37348ce6">timecomp3</a> + tw-&gt;<a class="code" href="structTreeWalk.html#ada69256fab1ba3b0e5ff0f837f749b2e">timecomp1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#a6518c361d396be49a9d1c676d8769802">timecomp2</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    timewait = tw-&gt;<a class="code" href="structTreeWalk.html#ae62aa594cbe693d40de9334cc0f7c820">timewait1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#aacf67d9ea224563ae4006114d97e473c">timewait2</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    timecomm = tw-&gt;<a class="code" href="structTreeWalk.html#a80f3ba2d463ce192ccb0f42eed264f56">timecommsumm1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#ae663d6653b464f02c95c57ae4a5bdd3a">timecommsumm2</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Compute&quot;</span>, timecomp);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Wait&quot;</span>, timewait);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Comm&quot;</span>, timecomm);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Misc&quot;</span>, timeall - (timecomp + timewait + timecomm));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_a10d3cfe0024d97740707f82efde883ea"><div class="ttname"><a href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a></div><div class="ttdeci">void SPH_VelPred(int i, MyFloat *VelPred, const double FgravkickB, double gravkick, double hydrokick)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00089">density.c:89</a></div></div>
<div class="ttc" id="adensity_8c_html_a146d61fe2d2f53ea9b7fabf2ea5e90b7"><div class="ttname"><a href="density_8c.html#a146d61fe2d2f53ea9b7fabf2ea5e90b7">density_ngbiter</a></div><div class="ttdeci">static void density_ngbiter(TreeWalkQueryDensity *I, TreeWalkResultDensity *O, TreeWalkNgbIterDensity *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00388">density.c:388</a></div></div>
<div class="ttc" id="adensity_8c_html_a23e510a287a10de773a4a0f14db2ff52"><div class="ttname"><a href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a></div><div class="ttdeci">double GetNumNgb(enum DensityKernelType KernelType)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:55</a></div></div>
<div class="ttc" id="adensity_8c_html_a300eea2fe5e00af45e3c65215ff5bfe7"><div class="ttname"><a href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a></div><div class="ttdeci">MyFloat SPH_EntVarPred(int PI, double MinEgySpec, double a3inv, double dloga)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00071">density.c:71</a></div></div>
<div class="ttc" id="adensity_8c_html_a338ab2cf6c2f52522edb746f04061af9"><div class="ttname"><a href="density_8c.html#a338ab2cf6c2f52522edb746f04061af9">density_copy</a></div><div class="ttdeci">static void density_copy(int place, TreeWalkQueryDensity *I, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00316">density.c:316</a></div></div>
<div class="ttc" id="adensity_8c_html_a9c4ca3648e6ac54cdb5adb45acc2e4e3"><div class="ttname"><a href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a></div><div class="ttdeci">static struct density_params DensityParams</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00001">density.c:21</a></div></div>
<div class="ttc" id="adensity_8c_html_ad169b636ff2e25d362af36cdedb8a3f2"><div class="ttname"><a href="density_8c.html#ad169b636ff2e25d362af36cdedb8a3f2">density_reduce</a></div><div class="ttdeci">static void density_reduce(int place, TreeWalkResultDensity *remote, enum TreeWalkReduceMode mode, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00339">density.c:339</a></div></div>
<div class="ttc" id="adensity_8c_html_ae39f5a18f937d210e258c8e8cb710044"><div class="ttname"><a href="density_8c.html#ae39f5a18f937d210e258c8e8cb710044">density_postprocess</a></div><div class="ttdeci">static void density_postprocess(int i, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00512">density.c:512</a></div></div>
<div class="ttc" id="adensity_8c_html_af9776b9b60703f24e380d743918248c3"><div class="ttname"><a href="density_8c.html#af9776b9b60703f24e380d743918248c3">density_haswork</a></div><div class="ttdeci">static int density_haswork(int n, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00501">density.c:501</a></div></div>
<div class="ttc" id="adensity_8c_html_afa3ec824b4fabad29715d26181bd89d7"><div class="ttname"><a href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a></div><div class="ttdeci">#define DENSITY_GET_PRIV(tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00166">density.c:166</a></div></div>
<div class="ttc" id="agravity_8h_html_ad2fea9ffa95e668ed71b563e817d2e1b"><div class="ttname"><a href="gravity_8h.html#ad2fea9ffa95e668ed71b563e817d2e1b">FORCE_SOFTENING</a></div><div class="ttdeci">double FORCE_SOFTENING(int i, int type)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00036">gravshort-tree.c:36</a></div></div>
<div class="ttc" id="alightcone_8c_html_a8f3ab427b30a3327076ffcc7c683562c"><div class="ttname"><a href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a></div><div class="ttdeci">static double dloga</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00021">lightcone.c:21</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a1b0b230f3890d70bae976516719b7d07"><div class="ttname"><a href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticles::ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00013">timestep.h:13</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a847ab898fdabc62a4723c7c3a66038d4"><div class="ttname"><a href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">ActiveParticles::NumActiveParticle</a></div><div class="ttdeci">int64_t NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00012">timestep.h:12</a></div></div>
<div class="ttc" id="astructDensityPriv_html"><div class="ttname"><a href="structDensityPriv.html">DensityPriv</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00131">density.c:131</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a2adaf9b9125b7af932d0777d7dbfc13c"><div class="ttname"><a href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">DensityPriv::update_hsml</a></div><div class="ttdeci">int update_hsml</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00148">density.c:148</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a30a0d9c3929eff9d2b5036c99af08aae"><div class="ttname"><a href="structDensityPriv.html#a30a0d9c3929eff9d2b5036c99af08aae">DensityPriv::DoEgyDensity</a></div><div class="ttdeci">int DoEgyDensity</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00149">density.c:149</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a3f351782202a9b99b8642dc873e870cd"><div class="ttname"><a href="structDensityPriv.html#a3f351782202a9b99b8642dc873e870cd">DensityPriv::SPH_predicted</a></div><div class="ttdeci">struct sph_pred_data * SPH_predicted</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00133">density.c:133</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a52ab30c25d6f44a990491893a9be9f2a"><div class="ttname"><a href="structDensityPriv.html#a52ab30c25d6f44a990491893a9be9f2a">DensityPriv::Left</a></div><div class="ttdeci">MyFloat * Left</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00140">density.c:140</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a6568d579150578cfe8fbbaca391de06d"><div class="ttname"><a href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">DensityPriv::times</a></div><div class="ttdeci">DriftKickTimes const  * times</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00160">density.c:160</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a90b86b68ad79acb839c327694fadd8be"><div class="ttname"><a href="structDensityPriv.html#a90b86b68ad79acb839c327694fadd8be">DensityPriv::GradRho</a></div><div class="ttdeci">MyFloat * GradRho</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00136">density.c:136</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a9e58815ff452f7207307fff63c8abf2e"><div class="ttname"><a href="structDensityPriv.html#a9e58815ff452f7207307fff63c8abf2e">DensityPriv::Rot</a></div><div class="ttdeci">MyFloat(* Rot)[3]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00141">density.c:141</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aa152970e40c653538d5c43853537a154"><div class="ttname"><a href="structDensityPriv.html#aa152970e40c653538d5c43853537a154">DensityPriv::NumNgb</a></div><div class="ttdeci">MyFloat * NumNgb</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00138">density.c:138</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aa937dcae41f2029c427ea18b69c23b63"><div class="ttname"><a href="structDensityPriv.html#aa937dcae41f2029c427ea18b69c23b63">DensityPriv::BlackHoleOn</a></div><div class="ttdeci">int BlackHoleOn</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00155">density.c:155</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aab71415faa924332b63c73a53dab3032"><div class="ttname"><a href="structDensityPriv.html#aab71415faa924332b63c73a53dab3032">DensityPriv::MinEgySpec</a></div><div class="ttdeci">double MinEgySpec</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00159">density.c:159</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aac6a03e3c7969e390efeafea0c9c56be"><div class="ttname"><a href="structDensityPriv.html#aac6a03e3c7969e390efeafea0c9c56be">DensityPriv::Right</a></div><div class="ttdeci">MyFloat * Right</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00140">density.c:140</a></div></div>
<div class="ttc" id="astructDensityPriv_html_ac506e8ace51a716a2fec6c17e0b5dcc5"><div class="ttname"><a href="structDensityPriv.html#ac506e8ace51a716a2fec6c17e0b5dcc5">DensityPriv::DhsmlDensityFactor</a></div><div class="ttdeci">MyFloat * DhsmlDensityFactor</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00147">density.c:147</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_a1c5fe7d114a58455177e26d13db726cf"><div class="ttname"><a href="structDriftKickTimes.html#a1c5fe7d114a58455177e26d13db726cf">DriftKickTimes::PM_kick</a></div><div class="ttdeci">inttime_t PM_kick</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00031">timestep.h:31</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_a8cbfa406f883f7f7e6ef53cfa4608f7d"><div class="ttname"><a href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">DriftKickTimes::Ti_Current</a></div><div class="ttdeci">inttime_t Ti_Current</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00027">timestep.h:27</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_ac18ed0905144485b014ce19c6db2a4d5"><div class="ttname"><a href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">DriftKickTimes::Ti_kick</a></div><div class="ttdeci">inttime_t Ti_kick[TIMEBINS+1]</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00023">timestep.h:23</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_ad3b4fe6ff2b0e0be706882c59323621e"><div class="ttname"><a href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">DriftKickTimes::mintimebin</a></div><div class="ttdeci">int mintimebin</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00020">timestep.h:20</a></div></div>
<div class="ttc" id="astructForceTree_html_a8915a4ff849c9e97448ae30089a05966"><div class="ttname"><a href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">ForceTree::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00106">forcetree.h:106</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterDensity_html"><div class="ttname"><a href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00100">density.c:100</a></div></div>
<div class="ttc" id="astructTreeWalkQueryDensity_html"><div class="ttname"><a href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00106">density.c:107</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html"><div class="ttname"><a href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00115">density.c:115</a></div></div>
<div class="ttc" id="astructTreeWalk_html"><div class="ttname"><a href="structTreeWalk.html">TreeWalk</a></div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00084">treewalk.h:84</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2ae51082ebb6332e558024b6a45506b2"><div class="ttname"><a href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">TreeWalk::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00085">treewalk.h:85</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2f6bc842f407a44d99de52e9b5140454"><div class="ttname"><a href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">TreeWalk::haswork</a></div><div class="ttdeci">TreeWalkHasWorkFunction haswork</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00100">treewalk.h:100</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a36bf2eb0e0d65ace233ef30335e04659"><div class="ttname"><a href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">TreeWalk::ngbiter_type_elsize</a></div><div class="ttdeci">size_t ngbiter_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00097">treewalk.h:97</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a6518c361d396be49a9d1c676d8769802"><div class="ttname"><a href="structTreeWalk.html#a6518c361d396be49a9d1c676d8769802">TreeWalk::timecomp2</a></div><div class="ttdeci">double timecomp2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00124">treewalk.h:124</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a714d0465e0498a5a8d0b698d37348ce6"><div class="ttname"><a href="structTreeWalk.html#a714d0465e0498a5a8d0b698d37348ce6">TreeWalk::timecomp3</a></div><div class="ttdeci">double timecomp3</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00125">treewalk.h:125</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a80f3ba2d463ce192ccb0f42eed264f56"><div class="ttname"><a href="structTreeWalk.html#a80f3ba2d463ce192ccb0f42eed264f56">TreeWalk::timecommsumm1</a></div><div class="ttdeci">double timecommsumm1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00126">treewalk.h:126</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8525705e365e7c07027f372b66aff149"><div class="ttname"><a href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">TreeWalk::tree</a></div><div class="ttdeci">const ForceTree * tree</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00088">treewalk.h:88</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8c4dcda60d680c3d56423fca8647472f"><div class="ttname"><a href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">TreeWalk::postprocess</a></div><div class="ttdeci">TreeWalkProcessFunction postprocess</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00104">treewalk.h:104</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a96381f9f61cf2c56dac48927cd997ec3"><div class="ttname"><a href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">TreeWalk::ngbiter</a></div><div class="ttdeci">TreeWalkNgbIterFunction ngbiter</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00103">treewalk.h:103</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa08a0586a68d1f4f87e0caa1e59dcc5e"><div class="ttname"><a href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">TreeWalk::reduce</a></div><div class="ttdeci">TreeWalkReduceResultFunction reduce</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00102">treewalk.h:102</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa3ff3d4a5a82422609ac154aa4a461ea"><div class="ttname"><a href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">TreeWalk::ev_label</a></div><div class="ttdeci">const char * ev_label</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00091">treewalk.h:91</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aacf67d9ea224563ae4006114d97e473c"><div class="ttname"><a href="structTreeWalk.html#aacf67d9ea224563ae4006114d97e473c">TreeWalk::timewait2</a></div><div class="ttdeci">double timewait2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00122">treewalk.h:122</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aafe4f27abb67d3959e711ef6787c9b75"><div class="ttname"><a href="structTreeWalk.html#aafe4f27abb67d3959e711ef6787c9b75">TreeWalk::NoNgblist</a></div><div class="ttdeci">int NoNgblist</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00156">treewalk.h:156</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ab4e96e67f2e72ac33dca9dd06cdac6c0"><div class="ttname"><a href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">TreeWalk::visit</a></div><div class="ttdeci">TreeWalkVisitFunction visit</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00099">treewalk.h:99</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ac8c67faaf2c360ed510c4508f11f7c2d"><div class="ttname"><a href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">TreeWalk::result_type_elsize</a></div><div class="ttdeci">size_t result_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00096">treewalk.h:96</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ad0b91dafd46de132917e7993869514c5"><div class="ttname"><a href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">TreeWalk::fill</a></div><div class="ttdeci">TreeWalkFillQueryFunction fill</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00101">treewalk.h:101</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ada69256fab1ba3b0e5ff0f837f749b2e"><div class="ttname"><a href="structTreeWalk.html#ada69256fab1ba3b0e5ff0f837f749b2e">TreeWalk::timecomp1</a></div><div class="ttdeci">double timecomp1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00123">treewalk.h:123</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ae62aa594cbe693d40de9334cc0f7c820"><div class="ttname"><a href="structTreeWalk.html#ae62aa594cbe693d40de9334cc0f7c820">TreeWalk::timewait1</a></div><div class="ttdeci">double timewait1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00121">treewalk.h:121</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ae663d6653b464f02c95c57ae4a5bdd3a"><div class="ttname"><a href="structTreeWalk.html#ae663d6653b464f02c95c57ae4a5bdd3a">TreeWalk::timecommsumm2</a></div><div class="ttdeci">double timecommsumm2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00127">treewalk.h:127</a></div></div>
<div class="ttc" id="astructTreeWalk_html_affd5eae4b5a63dcce236ac15b00b4c7c"><div class="ttname"><a href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">TreeWalk::query_type_elsize</a></div><div class="ttdeci">size_t query_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00095">treewalk.h:95</a></div></div>
<div class="ttc" id="astructdensity__params_html_a6f446e3119fb05626ccb93c492b02f9f"><div class="ttname"><a href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">density_params::MinGasHsmlFractional</a></div><div class="ttdeci">double MinGasHsmlFractional</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00022">density.h:22</a></div></div>
<div class="ttc" id="astructdensity__params_html_a9a6f34afbd604c08a8f2ec57f7cc5e48"><div class="ttname"><a href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">density_params::DensityKernelType</a></div><div class="ttdeci">enum DensityKernelType DensityKernelType</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00016">density.h:18</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
<div class="ttc" id="atest__timefac_8c_html_a5b77523ed91eb413cb28b12d8c2ceb46"><div class="ttname"><a href="test__timefac_8c.html#a5b77523ed91eb413cb28b12d8c2ceb46">loga_from_ti</a></div><div class="ttdeci">double loga_from_ti(int ti)</div><div class="ttdef"><b>Definition:</b> <a href="test__timefac_8c_source.html#l00051">test_timefac.c:51</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a7166c93d068baea59abf2ef8cee3c7aa"><div class="ttname"><a href="timebinmgr_8c.html#a7166c93d068baea59abf2ef8cee3c7aa">dloga_from_dti</a></div><div class="ttdeci">double dloga_from_dti(inttime_t dti, const inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00256">timebinmgr.c:256</a></div></div>
<div class="ttc" id="atimebinmgr_8h_html_a4668a3a5f210b5742a179c8d258a703d"><div class="ttname"><a href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a></div><div class="ttdeci">#define TIMEBINS</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00013">timebinmgr.h:13</a></div></div>
<div class="ttc" id="atimefac_8c_html_a2bfd65177ba7cde60bbe22eb0a84f96b"><div class="ttname"><a href="timefac_8c.html#a2bfd65177ba7cde60bbe22eb0a84f96b">get_exact_hydrokick_factor</a></div><div class="ttdeci">double get_exact_hydrokick_factor(Cosmology *CP, inttime_t ti0, inttime_t ti1)</div><div class="ttdef"><b>Definition:</b> <a href="timefac_8c_source.html#l00075">timefac.c:75</a></div></div>
<div class="ttc" id="atimefac_8c_html_ae45524bb6dcfabd035dd6edfda728079"><div class="ttname"><a href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a></div><div class="ttdeci">double get_exact_gravkick_factor(Cosmology *CP, inttime_t ti0, inttime_t ti1)</div><div class="ttdef"><b>Definition:</b> <a href="timefac_8c_source.html#l00070">timefac.c:70</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a1878fddf49185074fd570a46f3eea372"><div class="ttname"><a href="treewalk_8c.html#a1878fddf49185074fd570a46f3eea372">treewalk_visit_nolist_ngbiter</a></div><div class="ttdeci">int treewalk_visit_nolist_ngbiter(TreeWalkQueryBase *I, TreeWalkResultBase *O, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l01143">treewalk.c:1143</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a72643adf5c7952933b8f5fbb27d45a97"><div class="ttname"><a href="treewalk_8c.html#a72643adf5c7952933b8f5fbb27d45a97">treewalk_do_hsml_loop</a></div><div class="ttdeci">void treewalk_do_hsml_loop(TreeWalk *tw, int *queue, int64_t queuesize, int update_hsml)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l01254">treewalk.c:1254</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a01b18ab132aa3a45e2f2bed8aef94633"><div class="ttname"><a href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a></div><div class="ttdeci">int(* TreeWalkVisitFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00068">treewalk.h:68</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a2b5a07b25001ac6e9e628d4eb0493b8c"><div class="ttname"><a href="treewalk_8h.html#a2b5a07b25001ac6e9e628d4eb0493b8c">TreeWalkReduceResultFunction</a></div><div class="ttdeci">void(* TreeWalkReduceResultFunction)(const int j, TreeWalkResultBase *result, const enum TreeWalkReduceMode mode, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00076">treewalk.h:76</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a80f59f147efe7c27b601024d819769db"><div class="ttname"><a href="treewalk_8h.html#a80f59f147efe7c27b601024d819769db">TreeWalkProcessFunction</a></div><div class="ttdeci">void(* TreeWalkProcessFunction)(const int i, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00073">treewalk.h:73</a></div></div>
<div class="ttc" id="atreewalk_8h_html_aade20e4cc34b64ecf3bd6f5525465371"><div class="ttname"><a href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a></div><div class="ttdeci">void(* TreeWalkNgbIterFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, TreeWalkNgbIterBase *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00070">treewalk.h:70</a></div></div>
<div class="ttc" id="atreewalk_8h_html_ac9a8ade7817c58b83859399364deb1a1"><div class="ttname"><a href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a></div><div class="ttdeci">void(* TreeWalkFillQueryFunction)(const int j, TreeWalkQueryBase *query, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00075">treewalk.h:75</a></div></div>
<div class="ttc" id="atypes_8h_html_af1ada7381a1118c6d51bdbb0b5e72811"><div class="ttname"><a href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a></div><div class="ttdeci">LOW_PRECISION MyFloat</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00019">types.h:19</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
<div class="ttc" id="awalltime_8h_html_a5cedff8706bf3a249bd5e3c365b67964"><div class="ttname"><a href="walltime_8h.html#a5cedff8706bf3a249bd5e3c365b67964">WALLTIME_IGNORE</a></div><div class="ttdeci">#define WALLTIME_IGNORE</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00006">walltime.h:6</a></div></div>
<div class="ttc" id="awalltime_8h_html_a9266fc830d2aac1ad7d6e5322be6f489"><div class="ttname"><a href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a></div><div class="ttdeci">#define walltime_add(name, dt)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00009">walltime.h:9</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00158">DensityPriv::a3inv</a>, <a class="el" href="timestep_8h_source.html#l00013">ActiveParticles::ActiveParticle</a>, <a class="el" href="density_8c_source.html#l00155">DensityPriv::BlackHoleOn</a>, <a class="el" href="forcetree_8h_source.html#l00106">ForceTree::BoxSize</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="density_8c_source.html#l00316">density_copy()</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="density_8c_source.html#l00501">density_haswork()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, <a class="el" href="density_8c_source.html#l00512">density_postprocess()</a>, <a class="el" href="density_8c_source.html#l00339">density_reduce()</a>, <a class="el" href="density_8h_source.html#l00018">density_params::DensityKernelType</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8c_source.html#l00147">DensityPriv::DhsmlDensityFactor</a>, <a class="el" href="lightcone_8c_source.html#l00021">dloga</a>, <a class="el" href="timebinmgr_8c_source.html#l00256">dloga_from_dti()</a>, <a class="el" href="density_8c_source.html#l00149">DensityPriv::DoEgyDensity</a>, <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="treewalk_8h_source.html#l00091">TreeWalk::ev_label</a>, <a class="el" href="density_8c_source.html#l00161">DensityPriv::FgravkickB</a>, <a class="el" href="treewalk_8h_source.html#l00101">TreeWalk::fill</a>, <a class="el" href="gravshort-tree_8c_source.html#l00036">FORCE_SOFTENING()</a>, <a class="el" href="timefac_8c_source.html#l00070">get_exact_gravkick_factor()</a>, <a class="el" href="timefac_8c_source.html#l00075">get_exact_hydrokick_factor()</a>, <a class="el" href="density_8c_source.html#l00055">GetNumNgb()</a>, <a class="el" href="density_8c_source.html#l00136">DensityPriv::GradRho</a>, <a class="el" href="density_8c_source.html#l00162">DensityPriv::gravkicks</a>, <a class="el" href="treewalk_8h_source.html#l00100">TreeWalk::haswork</a>, <a class="el" href="density_8c_source.html#l00163">DensityPriv::hydrokicks</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="density_8c_source.html#l00140">DensityPriv::Left</a>, <a class="el" href="test__timefac_8c_source.html#l00051">loga_from_ti()</a>, <a class="el" href="density_8c_source.html#l00159">DensityPriv::MinEgySpec</a>, <a class="el" href="density_8h_source.html#l00022">density_params::MinGasHsmlFractional</a>, <a class="el" href="timestep_8h_source.html#l00020">DriftKickTimes::mintimebin</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="treewalk_8h_source.html#l00103">TreeWalk::ngbiter</a>, <a class="el" href="treewalk_8h_source.html#l00097">TreeWalk::ngbiter_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00156">TreeWalk::NoNgblist</a>, <a class="el" href="timestep_8h_source.html#l00012">ActiveParticles::NumActiveParticle</a>, <a class="el" href="density_8c_source.html#l00138">DensityPriv::NumNgb</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="timestep_8h_source.html#l00031">DriftKickTimes::PM_kick</a>, <a class="el" href="treewalk_8h_source.html#l00104">TreeWalk::postprocess</a>, <a class="el" href="treewalk_8h_source.html#l00085">TreeWalk::priv</a>, <a class="el" href="treewalk_8h_source.html#l00095">TreeWalk::query_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00102">TreeWalk::reduce</a>, <a class="el" href="treewalk_8h_source.html#l00096">TreeWalk::result_type_elsize</a>, <a class="el" href="density_8c_source.html#l00140">DensityPriv::Right</a>, <a class="el" href="density_8c_source.html#l00141">DensityPriv::Rot</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="density_8c_source.html#l00071">SPH_EntVarPred()</a>, <a class="el" href="density_8c_source.html#l00133">DensityPriv::SPH_predicted</a>, <a class="el" href="density_8c_source.html#l00089">SPH_VelPred()</a>, <a class="el" href="timestep_8h_source.html#l00027">DriftKickTimes::Ti_Current</a>, <a class="el" href="timestep_8h_source.html#l00023">DriftKickTimes::Ti_kick</a>, <a class="el" href="timebinmgr_8h_source.html#l00013">TIMEBINS</a>, <a class="el" href="treewalk_8h_source.html#l00126">TreeWalk::timecommsumm1</a>, <a class="el" href="treewalk_8h_source.html#l00127">TreeWalk::timecommsumm2</a>, <a class="el" href="treewalk_8h_source.html#l00123">TreeWalk::timecomp1</a>, <a class="el" href="treewalk_8h_source.html#l00124">TreeWalk::timecomp2</a>, <a class="el" href="treewalk_8h_source.html#l00125">TreeWalk::timecomp3</a>, <a class="el" href="density_8c_source.html#l00160">DensityPriv::times</a>, <a class="el" href="treewalk_8h_source.html#l00121">TreeWalk::timewait1</a>, <a class="el" href="treewalk_8h_source.html#l00122">TreeWalk::timewait2</a>, <a class="el" href="treewalk_8h_source.html#l00088">TreeWalk::tree</a>, <a class="el" href="treewalk_8c_source.html#l01254">treewalk_do_hsml_loop()</a>, <a class="el" href="treewalk_8c_source.html#l01143">treewalk_visit_nolist_ngbiter()</a>, <a class="el" href="density_8c_source.html#l00148">DensityPriv::update_hsml</a>, <a class="el" href="density_8h_source.html#l00034">sph_pred_data::VelPred</a>, <a class="el" href="treewalk_8h_source.html#l00099">TreeWalk::visit</a>, <a class="el" href="walltime_8h_source.html#l00009">walltime_add</a>, <a class="el" href="walltime_8h_source.html#l00006">WALLTIME_IGNORE</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00512">density_postprocess()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="cooling__rates_8c_source.html#l01034">get_compton_cooling()</a>, <a class="el" href="cooling__rates_8c_source.html#l00683">get_equilib_ne()</a>, <a class="el" href="cooling__rates_8c_source.html#l01104">get_heatingcooling_rate()</a>, <a class="el" href="cooling__rates_8c_source.html#l01202">get_helium_ion_phys_cgs()</a>, <a class="el" href="cooling__rates_8c_source.html#l01046">get_individual_cooling()</a>, <a class="el" href="cooling__rates_8c_source.html#l00696">get_ne_by_nh()</a>, <a class="el" href="cooling__rates_8c_source.html#l01186">get_neutral_fraction_phys_cgs()</a>, <a class="el" href="cooling__rates_8c_source.html#l01172">get_temp()</a>, <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, <a class="el" href="init_8c_source.html#l00384">setup_density_indep_entropy()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ac49d34dfc3f4e37cac0953d5bc1417a4_cgraph.svg" width="1438" height="1803"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ac49d34dfc3f4e37cac0953d5bc1417a4_icgraph.svg" width="2378" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abb05cdc00cf397be5c4dd467308cc4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb05cdc00cf397be5c4dd467308cc4bd">&#9670;&nbsp;</a></span>density_check_neighbours()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void density_check_neighbours </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00554">554</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">/* now check whether we had enough neighbours */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">int</span> tid = omp_get_thread_num();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">double</span> desnumngb = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DesNumNgb;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;BlackHoleOn &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        desnumngb = desnumngb * <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a8c482b6ae9dafc8a5f7f54cc2c36140d">BlackHoleNgbFactor</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * Left = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Left;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * Right = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Right;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * NumNgb = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span>(NumNgb[i] &lt; (desnumngb - <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">MaxNumNgbDeviation</a>) ||</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            (NumNgb[i] &gt; (desnumngb + <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">MaxNumNgbDeviation</a>)))</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">/* This condition is here to prevent the density code looping forever if it encounters</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         * multiple particles at the same position. If this happens you likely have worse</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">         * problems anyway, so warn also. */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span>((Right[i] - Left[i]) &lt; 1.0e-3 * Left[i])</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment">/* If this happens probably the exchange is screwed up and all your particles have moved to (0,0,0)*/</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;Very tight Hsml bounds for i=%d ID=%lu Hsml=%g Left=%g Right=%g Ngbs=%g Right-Left=%g pos=(%g|%g|%g)\n&quot;</span>,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;             i, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].ID, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml, Left[i], Right[i], NumNgb[i], Right[i] - Left[i], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[0], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[1], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[2]);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = Right[i];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">/* If we need more neighbours, move the lower bound up. If we need fewer, move the upper bound down.*/</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span>(NumNgb[i] &lt; desnumngb) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                Left[i] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                Right[i] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">/* Next step is geometric mean of previous. */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span>((Right[i] &lt; tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a> &amp;&amp; Left[i] &gt; 0) || (<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml * 1.26 &gt; 0.99 * tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a>))</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = pow(0.5 * (pow(Left[i], 3) + pow(Right[i], 3)), 1.0 / 3);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">if</span>(!(Right[i] &lt; tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a>) &amp;&amp; Left[i] == 0)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(8188, <span class="stringliteral">&quot;Cannot occur. Check for memory corruption: i=%d L = %g R = %g N=%g. Type %d, Pos %g %g %g hsml %g Box %g\n&quot;</span>, i, Left[i], Right[i], NumNgb[i], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[0], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[1], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[2], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml, tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> DensFac = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DhsmlDensityFactor[i];</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordtype">double</span> fac = 1.26;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">if</span>(NumNgb[i] &gt; 0)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                fac = 1 - (NumNgb[i] - desnumngb) / (<a class="code" href="densitykernel_8h.html#a2e32e163509d0638d5c54046429c00b3">NUMDIMS</a> * NumNgb[i]) * DensFac;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">/* Find the initial bracket using the kernel gradients*/</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">if</span>(Right[i] &gt; 0.99 * tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a> &amp;&amp; Left[i] &gt; 0)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="keywordflow">if</span>(DensFac &lt;= 0 || fabs(NumNgb[i] - desnumngb) &gt;= 0.5 * desnumngb || fac &gt; 1.26)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    fac = 1.26;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">if</span>(Right[i] &lt; 0.99*tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a>-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a> &amp;&amp; Left[i] == 0)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">if</span>(DensFac &lt;=0 || fac &lt; 1./3)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    fac = 1./3;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml *= fac;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;BlackHoleOn &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span>(Left[i] &gt; <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a>)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">if</span>(Right[i] &lt; <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">/* More work needed: add this particle to the redo queue*/</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        tw-&gt;<a class="code" href="structTreeWalk.html#a73d26f9b05f007c46bddb25f39f6bbf5">NPRedo</a>[tid][tw-&gt;<a class="code" href="structTreeWalk.html#ad9b63d13efa217c89748031b224f2346">NPLeft</a>[tid]] = i;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        tw-&gt;<a class="code" href="structTreeWalk.html#ad9b63d13efa217c89748031b224f2346">NPLeft</a>[tid] ++;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span>(tw-&gt;<a class="code" href="structTreeWalk.html#ad9b63d13efa217c89748031b224f2346">NPLeft</a>[tid] &gt; tw-&gt;<a class="code" href="structTreeWalk.html#ab9a90e37930bc4fbf059cf2029b50c4d">Redo_thread_alloc</a>)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(5, <span class="stringliteral">&quot;Particle %d on thread %d exceeded allocated size of redo queue %ld\n&quot;</span>, tw-&gt;<a class="code" href="structTreeWalk.html#ad9b63d13efa217c89748031b224f2346">NPLeft</a>[tid], tid, tw-&gt;<a class="code" href="structTreeWalk.html#ab9a90e37930bc4fbf059cf2029b50c4d">Redo_thread_alloc</a>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">/* We might have got here by serendipity, without bounding.*/</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;BlackHoleOn &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &gt; <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a>)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &lt; <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span>(tw-&gt;<a class="code" href="structTreeWalk.html#a6fa5eb5767f35c98b86b396ae112482a">maxnumngb</a>[tid] &lt; NumNgb[i])</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        tw-&gt;<a class="code" href="structTreeWalk.html#a6fa5eb5767f35c98b86b396ae112482a">maxnumngb</a>[tid] = NumNgb[i];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span>(tw-&gt;<a class="code" href="structTreeWalk.html#a1e7b97376d0c5242e5195e7173ab8ed8">minnumngb</a>[tid] &gt; NumNgb[i])</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        tw-&gt;<a class="code" href="structTreeWalk.html#a1e7b97376d0c5242e5195e7173ab8ed8">minnumngb</a>[tid] = NumNgb[i];</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span>(tw-&gt;<a class="code" href="structTreeWalk.html#a1d722afccb3091cb1697eaa973936f27">Niteration</a> &gt;= <a class="code" href="cooling_8c.html#a9e60f3e57fde2b9b1c7fe2eab7334add">MAXITER</a> - 10)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;i=%d ID=%lu Hsml=%g Left=%g Right=%g Ngbs=%g Right-Left=%g\n   pos=(%g|%g|%g)\n&quot;</span>,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;             i, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].ID, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml, Left[i], Right[i],</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;             NumNgb[i], Right[i] - Left[i], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[0], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[1], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos[2]);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;}</div>
<div class="ttc" id="acooling_8c_html_a9e60f3e57fde2b9b1c7fe2eab7334add"><div class="ttname"><a href="cooling_8c.html#a9e60f3e57fde2b9b1c7fe2eab7334add">MAXITER</a></div><div class="ttdeci">#define MAXITER</div><div class="ttdef"><b>Definition:</b> <a href="cooling_8c_source.html#l00046">cooling.c:46</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_a2e32e163509d0638d5c54046429c00b3"><div class="ttname"><a href="densitykernel_8h.html#a2e32e163509d0638d5c54046429c00b3">NUMDIMS</a></div><div class="ttdeci">#define NUMDIMS</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00005">densitykernel.h:5</a></div></div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a1d722afccb3091cb1697eaa973936f27"><div class="ttname"><a href="structTreeWalk.html#a1d722afccb3091cb1697eaa973936f27">TreeWalk::Niteration</a></div><div class="ttdeci">int64_t Niteration</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00142">treewalk.h:142</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a1e7b97376d0c5242e5195e7173ab8ed8"><div class="ttname"><a href="structTreeWalk.html#a1e7b97376d0c5242e5195e7173ab8ed8">TreeWalk::minnumngb</a></div><div class="ttdeci">double * minnumngb</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00172">treewalk.h:172</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a6fa5eb5767f35c98b86b396ae112482a"><div class="ttname"><a href="structTreeWalk.html#a6fa5eb5767f35c98b86b396ae112482a">TreeWalk::maxnumngb</a></div><div class="ttdeci">double * maxnumngb</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00171">treewalk.h:171</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a73d26f9b05f007c46bddb25f39f6bbf5"><div class="ttname"><a href="structTreeWalk.html#a73d26f9b05f007c46bddb25f39f6bbf5">TreeWalk::NPRedo</a></div><div class="ttdeci">int ** NPRedo</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00168">treewalk.h:168</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ab9a90e37930bc4fbf059cf2029b50c4d"><div class="ttname"><a href="structTreeWalk.html#ab9a90e37930bc4fbf059cf2029b50c4d">TreeWalk::Redo_thread_alloc</a></div><div class="ttdeci">size_t Redo_thread_alloc</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00169">treewalk.h:169</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ad9b63d13efa217c89748031b224f2346"><div class="ttname"><a href="structTreeWalk.html#ad9b63d13efa217c89748031b224f2346">TreeWalk::NPLeft</a></div><div class="ttdeci">size_t * NPLeft</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00167">treewalk.h:167</a></div></div>
<div class="ttc" id="astructdensity__params_html_a5d935ae1dd13ab25a2f12c5516732943"><div class="ttname"><a href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">density_params::MaxNumNgbDeviation</a></div><div class="ttdeci">double MaxNumNgbDeviation</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00012">density.h:12</a></div></div>
<div class="ttc" id="astructdensity__params_html_a8c482b6ae9dafc8a5f7f54cc2c36140d"><div class="ttname"><a href="structdensity__params.html#a8c482b6ae9dafc8a5f7f54cc2c36140d">density_params::BlackHoleNgbFactor</a></div><div class="ttdeci">double BlackHoleNgbFactor</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00015">density.h:15</a></div></div>
<div class="ttc" id="astructdensity__params_html_ac0eaafd93f45b5e11e484263fa311dbf"><div class="ttname"><a href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">density_params::BlackHoleMaxAccretionRadius</a></div><div class="ttdeci">double BlackHoleMaxAccretionRadius</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00016">density.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8h_source.html#l00016">density_params::BlackHoleMaxAccretionRadius</a>, <a class="el" href="density_8h_source.html#l00015">density_params::BlackHoleNgbFactor</a>, <a class="el" href="forcetree_8h_source.html#l00106">ForceTree::BoxSize</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="cooling_8c_source.html#l00046">MAXITER</a>, <a class="el" href="treewalk_8h_source.html#l00171">TreeWalk::maxnumngb</a>, <a class="el" href="density_8h_source.html#l00012">density_params::MaxNumNgbDeviation</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="treewalk_8h_source.html#l00172">TreeWalk::minnumngb</a>, <a class="el" href="treewalk_8h_source.html#l00142">TreeWalk::Niteration</a>, <a class="el" href="treewalk_8h_source.html#l00167">TreeWalk::NPLeft</a>, <a class="el" href="treewalk_8h_source.html#l00168">TreeWalk::NPRedo</a>, <a class="el" href="densitykernel_8h_source.html#l00005">NUMDIMS</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="treewalk_8h_source.html#l00169">TreeWalk::Redo_thread_alloc</a>, and <a class="el" href="treewalk_8h_source.html#l00088">TreeWalk::tree</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00512">density_postprocess()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_abb05cdc00cf397be5c4dd467308cc4bd_cgraph.svg" width="624" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_abb05cdc00cf397be5c4dd467308cc4bd_icgraph.svg" width="2823" height="814"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a338ab2cf6c2f52522edb746f04061af9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a338ab2cf6c2f52522edb746f04061af9">&#9670;&nbsp;</a></span>density_copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void density_copy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>place</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a> *&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00316">316</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#a5e7d9a47f77326e38b0bea42b6f09928">Hsml</a> = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Hsml;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#afe24922bc857136543f70cc477f8224c">Type</a> = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Type;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Type != 0)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[0] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Vel[0];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[1] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Vel[1];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[2] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Vel[2];</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * velpred = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;SPH_predicted-&gt;VelPred;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[0] = velpred[3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].PI];</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[1] = velpred[3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].PI + 1];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[2] = velpred[3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].PI + 2];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="ttc" id="astructTreeWalkQueryDensity_html_a5e7d9a47f77326e38b0bea42b6f09928"><div class="ttname"><a href="structTreeWalkQueryDensity.html#a5e7d9a47f77326e38b0bea42b6f09928">TreeWalkQueryDensity::Hsml</a></div><div class="ttdeci">MyFloat Hsml</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00110">density.c:110</a></div></div>
<div class="ttc" id="astructTreeWalkQueryDensity_html_abb17902dcf16a18db3fa072878c3eb6a"><div class="ttname"><a href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">TreeWalkQueryDensity::Vel</a></div><div class="ttdeci">double Vel[3]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00109">density.c:109</a></div></div>
<div class="ttc" id="astructTreeWalkQueryDensity_html_afe24922bc857136543f70cc477f8224c"><div class="ttname"><a href="structTreeWalkQueryDensity.html#afe24922bc857136543f70cc477f8224c">TreeWalkQueryDensity::Type</a></div><div class="ttdeci">int Type</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00111">density.c:111</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="density_8c_source.html#l00110">TreeWalkQueryDensity::Hsml</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="density_8c_source.html#l00111">TreeWalkQueryDensity::Type</a>, and <a class="el" href="density_8c_source.html#l00109">TreeWalkQueryDensity::Vel</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a338ab2cf6c2f52522edb746f04061af9_icgraph.svg" width="2534" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af9776b9b60703f24e380d743918248c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9776b9b60703f24e380d743918248c3">&#9670;&nbsp;</a></span>density_haswork()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int density_haswork </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00501">501</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">/* Don&#39;t want a density for swallowed black hole particles*/</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[n].Swallowed)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[n].Type == 0 || <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[n].Type == 5)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00088">P</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_af9776b9b60703f24e380d743918248c3_icgraph.svg" width="2558" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a146d61fe2d2f53ea9b7fabf2ea5e90b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a146d61fe2d2f53ea9b7fabf2ea5e90b7">&#9670;&nbsp;</a></span>density_ngbiter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void density_ngbiter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a> *&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a> *&#160;</td>
          <td class="paramname"><em>O</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a> *&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLocalTreeWalk.html">LocalTreeWalk</a> *&#160;</td>
          <td class="paramname"><em>lv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00388">388</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span>(iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">other</a> == -1) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> h = I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#a5e7d9a47f77326e38b0bea42b6f09928">Hsml</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <a class="code" href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a>(&amp;iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>, h, <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa6a75921f0d6ef7f1fe9c17ce73b26d4">kernel_volume</a> = <a class="code" href="densitykernel_8c.html#ac4e5abd2c5d6459b39437185da18ee48">density_kernel_volume</a>(&amp;iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#a633d0a0d40776a7dcef5c6915bda2c56">Hsml</a> = h;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#a887aa48798bdfb5a8cca30be18c9a849">mask</a> = 1; <span class="comment">/* gas only */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#aebe92fe57ee45b4ada2f95717b7cf12b">symmetric</a> = <a class="code" href="treewalk_8h.html#ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5">NGB_TREEFIND_ASYMMETRIC</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> other = iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">other</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> r = iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#a5b1a01a9a059a9429cf0e5cf92a4f53b">r</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> r2 = iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#a70a2cc004aede46d1407c89d0cbb4616">r2</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> * dist = iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">base</a>.<a class="code" href="structTreeWalkNgbIterBase.html#aba52009bbabdd9e0cc5ea5b257b978f3">dist</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Mass == 0) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;Density found zero mass particle %d type %d id %ld pos %g %g %g\n&quot;</span>,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;               other, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Type, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].ID, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Pos[0], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Pos[1], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Pos[2]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span>(r2 &lt; iter-&gt;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>.HH)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">/* For the BH we wish to exclude wind particles from the density,</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">         * because they are excluded from the accretion treewalk.*/</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span>(I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#afe24922bc857136543f70cc477f8224c">Type</a> == 5 &amp;&amp; <a class="code" href="winds_8c.html#a70bfb30aee1a43686ccfd216080d84ff">winds_is_particle_decoupled</a>(other))</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> u = r * iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>.<a class="code" href="structDensityKernel.html#a96f937c0efd2485f2615419e3f28bab1">Hinv</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a> = <a class="code" href="densitykernel_8c.html#afb1d08bb021ac0edae2020eca1a48ea5">density_kernel_wk</a>(&amp;iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>, u);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        O-&gt;<a class="code" href="structTreeWalkResultDensity.html#abecba9797a212dae03830157319bdbfb">Ngb</a> += <a class="code" href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a> * iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa6a75921f0d6ef7f1fe9c17ce73b26d4">kernel_volume</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="densitykernel_8c.html#a927cebd0801702feb46f3e56d1d0d651">dwk</a> = <a class="code" href="densitykernel_8c.html#a0186d7befa22874293c78f61468ed76a">density_kernel_dwk</a>(&amp;iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>, u);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mass_j = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Mass;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        O-&gt;<a class="code" href="structTreeWalkResultDensity.html#a8fa6b972b6f1057016337c372c881353">Rho</a> += (mass_j * <a class="code" href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">/* Hinv is here because O-&gt;DhsmlDensity is drho / dH.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">         * nothing to worry here */</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordtype">double</span> density_dW = <a class="code" href="densitykernel_8h.html#aec0c9b61e7d0eea4c1322bac43953c52">density_kernel_dW</a>(&amp;iter-&gt;<a class="code" href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">kernel</a>, u, <a class="code" href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a>, <a class="code" href="densitykernel_8c.html#a927cebd0801702feb46f3e56d1d0d651">dwk</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        O-&gt;<a class="code" href="structTreeWalkResultDensity.html#a51ab8c8650af2bd6d3b5cc27b9eaf48e">DhsmlDensity</a> += mass_j * density_dW;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/* For the BH and stars only density and dhsmldensity is used.*/</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span>(I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#afe24922bc857136543f70cc477f8224c">Type</a> != 0)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> * SphP_scratch = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;SPH_predicted;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> <a class="code" href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">VelPred</a>[3];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">        #pragma omp atomic read</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a> = SphP_scratch-&gt;<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a>[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].PI];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">/* Lazily compute the predicted quantities. We can do this</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">         * with minimal locking since nothing happens should we compute them twice.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">         * Zero can be the special value since there should never be zero entropy.*/</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a> == 0) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keyword">struct </span><a class="code" href="structDensityPriv.html">DensityPriv</a> * priv = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordtype">int</span> bin = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].TimeBin;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a> = <a class="code" href="timebinmgr_8c.html#a7166c93d068baea59abf2ef8cee3c7aa">dloga_from_dti</a>(priv-&gt;<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>-&gt;<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a> - priv-&gt;<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>-&gt;<a class="code" href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">Ti_kick</a>[bin], priv-&gt;<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>-&gt;<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            EntVarPred = <a class="code" href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].PI, priv-&gt;<a class="code" href="structDensityPriv.html#aab71415faa924332b63c73a53dab3032">MinEgySpec</a>, priv-&gt;<a class="code" href="structDensityPriv.html#a5f4cdc012a89786d5997099bbbe875e0">a3inv</a>, <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <a class="code" href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a>(other, VelPred, priv-&gt;<a class="code" href="structDensityPriv.html#ad8971035c374bbcaf81e6b7119ca31cd">FgravkickB</a>, priv-&gt;<a class="code" href="structDensityPriv.html#a639d69ece7fd5df5b1bd8a59fafc0665">gravkicks</a>[bin], priv-&gt;<a class="code" href="structDensityPriv.html#a9ab18cae21644c84a2fa40ec70b07ac3">hydrokicks</a>[bin]);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="comment">/* Note this goes first to avoid threading issues: EntVarPred will only be set after this is done.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">             * The worst that can happen is that some data points get copied twice.*/</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">                #pragma omp atomic write</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                SphP_scratch-&gt;<a class="code" href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">VelPred</a>[3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].PI + i] = VelPred[i];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">            #pragma omp atomic write</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            SphP_scratch-&gt;<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a>[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].PI] = EntVarPred;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">                #pragma omp atomic read</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                VelPred[i] = SphP_scratch-&gt;<a class="code" href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">VelPred</a>[3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].PI + i];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;DoEgyDensity) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            O-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad9a2cd6dcae268a37537982aa2d661b2">EgyRho</a> += mass_j * EntVarPred * <a class="code" href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            O-&gt;<a class="code" href="structTreeWalkResultDensity.html#a5ad01958cbb907783da12e41b19919bc">DhsmlEgyDensity</a> += mass_j * EntVarPred * density_dW;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span>(r &gt; 0)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordtype">double</span> fac = mass_j * <a class="code" href="densitykernel_8c.html#a927cebd0801702feb46f3e56d1d0d651">dwk</a> / r;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordtype">double</span> dv[3];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordtype">double</span> rot[3];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                dv[d] = I-&gt;<a class="code" href="structTreeWalkQueryDensity.html#abb17902dcf16a18db3fa072878c3eb6a">Vel</a>[d] - VelPred[d];</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            O-&gt;<a class="code" href="structTreeWalkResultDensity.html#ac06fbce4c1e25bc632898207ac95893b">Div</a> += -fac * <a class="code" href="densitykernel_8h.html#ac7d8960c64a9787f4203a93450bb2f80">dotproduct</a>(dist, dv);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="densitykernel_8h.html#ac88b4e6375ddb37a4fa6a77515f167ea">crossproduct</a>(dv, dist, rot);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                O-&gt;<a class="code" href="structTreeWalkResultDensity.html#a2a47bbdd508de982da52430e6c9e1b76">Rot</a>[d] += fac * rot[d];</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;GradRho) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="keywordflow">for</span> (d = 0; d &lt; 3; d ++)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    O-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad1d56d3c2ebb0136903e828925222bde">GradRho</a>[d] += fac * dist[d];</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="ttc" id="adensitykernel_8c_html_a0186d7befa22874293c78f61468ed76a"><div class="ttname"><a href="densitykernel_8c.html#a0186d7befa22874293c78f61468ed76a">density_kernel_dwk</a></div><div class="ttdeci">double density_kernel_dwk(DensityKernel *kernel, double u)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00108">densitykernel.c:108</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_a7c842435db8db5e6fe2c652b849af87f"><div class="ttname"><a href="densitykernel_8c.html#a7c842435db8db5e6fe2c652b849af87f">wk</a></div><div class="ttdeci">double(* wk)(DensityKernel *kernel, double q)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00094">densitykernel.c:94</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_a927cebd0801702feb46f3e56d1d0d651"><div class="ttname"><a href="densitykernel_8c.html#a927cebd0801702feb46f3e56d1d0d651">dwk</a></div><div class="ttdeci">double(* dwk)(DensityKernel *kernel, double q)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00095">densitykernel.c:95</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_ac4e5abd2c5d6459b39437185da18ee48"><div class="ttname"><a href="densitykernel_8c.html#ac4e5abd2c5d6459b39437185da18ee48">density_kernel_volume</a></div><div class="ttdeci">double density_kernel_volume(DensityKernel *kernel)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00134">densitykernel.c:134</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_ac964db66f17e32a55c5137c884f4b76b"><div class="ttname"><a href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a></div><div class="ttdeci">void density_kernel_init(DensityKernel *kernel, double H, enum DensityKernelType type)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00157">densitykernel.c:157</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_afb1d08bb021ac0edae2020eca1a48ea5"><div class="ttname"><a href="densitykernel_8c.html#afb1d08bb021ac0edae2020eca1a48ea5">density_kernel_wk</a></div><div class="ttdeci">double density_kernel_wk(DensityKernel *kernel, double u)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00116">densitykernel.c:116</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_ac7d8960c64a9787f4203a93450bb2f80"><div class="ttname"><a href="densitykernel_8h.html#ac7d8960c64a9787f4203a93450bb2f80">dotproduct</a></div><div class="ttdeci">static double dotproduct(const double v1[3], const double v2[3])</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00053">densitykernel.h:53</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_ac88b4e6375ddb37a4fa6a77515f167ea"><div class="ttname"><a href="densitykernel_8h.html#ac88b4e6375ddb37a4fa6a77515f167ea">crossproduct</a></div><div class="ttdeci">static void crossproduct(const double v1[3], const double v2[3], double out[3])</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00063">densitykernel.h:63</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_aec0c9b61e7d0eea4c1322bac43953c52"><div class="ttname"><a href="densitykernel_8h.html#aec0c9b61e7d0eea4c1322bac43953c52">density_kernel_dW</a></div><div class="ttdeci">static double density_kernel_dW(DensityKernel *kernel, double u, double wk, double dwk)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00047">densitykernel.h:47</a></div></div>
<div class="ttc" id="alightcone_8c_html_a53356309f04e9e22e9631e0be5a97b36"><div class="ttname"><a href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a></div><div class="ttdeci">static double kernel(double loga, void *params)</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00059">lightcone.c:59</a></div></div>
<div class="ttc" id="astructDensityKernel_html_a96f937c0efd2485f2615419e3f28bab1"><div class="ttname"><a href="structDensityKernel.html#a96f937c0efd2485f2615419e3f28bab1">DensityKernel::Hinv</a></div><div class="ttdeci">double Hinv</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00026">densitykernel.h:26</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a5f4cdc012a89786d5997099bbbe875e0"><div class="ttname"><a href="structDensityPriv.html#a5f4cdc012a89786d5997099bbbe875e0">DensityPriv::a3inv</a></div><div class="ttdeci">double a3inv</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00158">density.c:158</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a639d69ece7fd5df5b1bd8a59fafc0665"><div class="ttname"><a href="structDensityPriv.html#a639d69ece7fd5df5b1bd8a59fafc0665">DensityPriv::gravkicks</a></div><div class="ttdeci">double gravkicks[TIMEBINS+1]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00162">density.c:162</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a9ab18cae21644c84a2fa40ec70b07ac3"><div class="ttname"><a href="structDensityPriv.html#a9ab18cae21644c84a2fa40ec70b07ac3">DensityPriv::hydrokicks</a></div><div class="ttdeci">double hydrokicks[TIMEBINS+1]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00163">density.c:163</a></div></div>
<div class="ttc" id="astructDensityPriv_html_ad8971035c374bbcaf81e6b7119ca31cd"><div class="ttname"><a href="structDensityPriv.html#ad8971035c374bbcaf81e6b7119ca31cd">DensityPriv::FgravkickB</a></div><div class="ttdeci">double FgravkickB</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00161">density.c:161</a></div></div>
<div class="ttc" id="astructLocalTreeWalk_html_ae7a5a56205348bfd1bcd544e13c4b702"><div class="ttname"><a href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">LocalTreeWalk::tw</a></div><div class="ttdeci">TreeWalk * tw</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00047">treewalk.h:47</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a5b1a01a9a059a9429cf0e5cf92a4f53b"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a5b1a01a9a059a9429cf0e5cf92a4f53b">TreeWalkNgbIterBase::r</a></div><div class="ttdeci">double r</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00042">treewalk.h:42</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a633d0a0d40776a7dcef5c6915bda2c56"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a633d0a0d40776a7dcef5c6915bda2c56">TreeWalkNgbIterBase::Hsml</a></div><div class="ttdeci">double Hsml</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00039">treewalk.h:39</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a70a2cc004aede46d1407c89d0cbb4616"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a70a2cc004aede46d1407c89d0cbb4616">TreeWalkNgbIterBase::r2</a></div><div class="ttdeci">double r2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00041">treewalk.h:41</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a887aa48798bdfb5a8cca30be18c9a849"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a887aa48798bdfb5a8cca30be18c9a849">TreeWalkNgbIterBase::mask</a></div><div class="ttdeci">int mask</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00038">treewalk.h:38</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_aba52009bbabdd9e0cc5ea5b257b978f3"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#aba52009bbabdd9e0cc5ea5b257b978f3">TreeWalkNgbIterBase::dist</a></div><div class="ttdeci">double dist[3]</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00040">treewalk.h:40</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_ac75baa8cbd1cd6a47dbf9fb136c901d3"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">TreeWalkNgbIterBase::other</a></div><div class="ttdeci">int other</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00043">treewalk.h:43</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_aebe92fe57ee45b4ada2f95717b7cf12b"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#aebe92fe57ee45b4ada2f95717b7cf12b">TreeWalkNgbIterBase::symmetric</a></div><div class="ttdeci">enum NgbTreeFindSymmetric symmetric</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00027">treewalk.h:37</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterDensity_html_aa32f315bcf7a47528bde2a505c0ce724"><div class="ttname"><a href="structTreeWalkNgbIterDensity.html#aa32f315bcf7a47528bde2a505c0ce724">TreeWalkNgbIterDensity::kernel</a></div><div class="ttdeci">DensityKernel kernel</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00102">density.c:102</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterDensity_html_aa6a75921f0d6ef7f1fe9c17ce73b26d4"><div class="ttname"><a href="structTreeWalkNgbIterDensity.html#aa6a75921f0d6ef7f1fe9c17ce73b26d4">TreeWalkNgbIterDensity::kernel_volume</a></div><div class="ttdeci">double kernel_volume</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00103">density.c:103</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterDensity_html_ab25a817560922fdb89016e80d61e4b5e"><div class="ttname"><a href="structTreeWalkNgbIterDensity.html#ab25a817560922fdb89016e80d61e4b5e">TreeWalkNgbIterDensity::base</a></div><div class="ttdeci">TreeWalkNgbIterBase base</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00101">density.c:101</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_a2a47bbdd508de982da52430e6c9e1b76"><div class="ttname"><a href="structTreeWalkResultDensity.html#a2a47bbdd508de982da52430e6c9e1b76">TreeWalkResultDensity::Rot</a></div><div class="ttdeci">MyFloat Rot[3]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00126">density.c:126</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_a51ab8c8650af2bd6d3b5cc27b9eaf48e"><div class="ttname"><a href="structTreeWalkResultDensity.html#a51ab8c8650af2bd6d3b5cc27b9eaf48e">TreeWalkResultDensity::DhsmlDensity</a></div><div class="ttdeci">MyFloat DhsmlDensity</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00123">density.c:123</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_a5ad01958cbb907783da12e41b19919bc"><div class="ttname"><a href="structTreeWalkResultDensity.html#a5ad01958cbb907783da12e41b19919bc">TreeWalkResultDensity::DhsmlEgyDensity</a></div><div class="ttdeci">MyFloat DhsmlEgyDensity</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00120">density.c:120</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_a8fa6b972b6f1057016337c372c881353"><div class="ttname"><a href="structTreeWalkResultDensity.html#a8fa6b972b6f1057016337c372c881353">TreeWalkResultDensity::Rho</a></div><div class="ttdeci">MyFloat Rho</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00122">density.c:122</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_abecba9797a212dae03830157319bdbfb"><div class="ttname"><a href="structTreeWalkResultDensity.html#abecba9797a212dae03830157319bdbfb">TreeWalkResultDensity::Ngb</a></div><div class="ttdeci">MyFloat Ngb</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00124">density.c:124</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_ac06fbce4c1e25bc632898207ac95893b"><div class="ttname"><a href="structTreeWalkResultDensity.html#ac06fbce4c1e25bc632898207ac95893b">TreeWalkResultDensity::Div</a></div><div class="ttdeci">MyFloat Div</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00125">density.c:125</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_ad1d56d3c2ebb0136903e828925222bde"><div class="ttname"><a href="structTreeWalkResultDensity.html#ad1d56d3c2ebb0136903e828925222bde">TreeWalkResultDensity::GradRho</a></div><div class="ttdeci">MyFloat GradRho[3]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00128">density.c:128</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html_ad9a2cd6dcae268a37537982aa2d661b2"><div class="ttname"><a href="structTreeWalkResultDensity.html#ad9a2cd6dcae268a37537982aa2d661b2">TreeWalkResultDensity::EgyRho</a></div><div class="ttdeci">MyFloat EgyRho</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00119">density.c:119</a></div></div>
<div class="ttc" id="astructsph__pred__data_html"><div class="ttname"><a href="structsph__pred__data.html">sph_pred_data</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00025">density.h:26</a></div></div>
<div class="ttc" id="astructsph__pred__data_html_a4a420ff93189407b7caf7aa75779267b"><div class="ttname"><a href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">sph_pred_data::EntVarPred</a></div><div class="ttdeci">MyFloat * EntVarPred</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00028">density.h:28</a></div></div>
<div class="ttc" id="astructsph__pred__data_html_a548bc537da0575b96689f32a198c9e5b"><div class="ttname"><a href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">sph_pred_data::VelPred</a></div><div class="ttdeci">MyFloat * VelPred</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00034">density.h:34</a></div></div>
<div class="ttc" id="atreewalk_8h_html_ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5"><div class="ttname"><a href="treewalk_8h.html#ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5">NGB_TREEFIND_ASYMMETRIC</a></div><div class="ttdeci">@ NGB_TREEFIND_ASYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00012">treewalk.h:12</a></div></div>
<div class="ttc" id="awinds_8c_html_a70bfb30aee1a43686ccfd216080d84ff"><div class="ttname"><a href="winds_8c.html#a70bfb30aee1a43686ccfd216080d84ff">winds_is_particle_decoupled</a></div><div class="ttdeci">int winds_is_particle_decoupled(int i)</div><div class="ttdef"><b>Definition:</b> <a href="winds_8c_source.html#l00124">winds.c:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00158">DensityPriv::a3inv</a>, <a class="el" href="density_8c_source.html#l00101">TreeWalkNgbIterDensity::base</a>, <a class="el" href="densitykernel_8h_source.html#l00063">crossproduct()</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="densitykernel_8h_source.html#l00047">density_kernel_dW()</a>, <a class="el" href="densitykernel_8c_source.html#l00108">density_kernel_dwk()</a>, <a class="el" href="densitykernel_8c_source.html#l00157">density_kernel_init()</a>, <a class="el" href="densitykernel_8c_source.html#l00134">density_kernel_volume()</a>, <a class="el" href="densitykernel_8c_source.html#l00116">density_kernel_wk()</a>, <a class="el" href="density_8h_source.html#l00018">density_params::DensityKernelType</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8c_source.html#l00123">TreeWalkResultDensity::DhsmlDensity</a>, <a class="el" href="density_8c_source.html#l00120">TreeWalkResultDensity::DhsmlEgyDensity</a>, <a class="el" href="treewalk_8h_source.html#l00040">TreeWalkNgbIterBase::dist</a>, <a class="el" href="density_8c_source.html#l00125">TreeWalkResultDensity::Div</a>, <a class="el" href="lightcone_8c_source.html#l00021">dloga</a>, <a class="el" href="timebinmgr_8c_source.html#l00256">dloga_from_dti()</a>, <a class="el" href="densitykernel_8h_source.html#l00053">dotproduct()</a>, <a class="el" href="densitykernel_8c_source.html#l00095">dwk</a>, <a class="el" href="density_8c_source.html#l00119">TreeWalkResultDensity::EgyRho</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="density_8c_source.html#l00161">DensityPriv::FgravkickB</a>, <a class="el" href="density_8c_source.html#l00128">TreeWalkResultDensity::GradRho</a>, <a class="el" href="density_8c_source.html#l00162">DensityPriv::gravkicks</a>, <a class="el" href="densitykernel_8h_source.html#l00026">DensityKernel::Hinv</a>, <a class="el" href="density_8c_source.html#l00110">TreeWalkQueryDensity::Hsml</a>, <a class="el" href="treewalk_8h_source.html#l00039">TreeWalkNgbIterBase::Hsml</a>, <a class="el" href="density_8c_source.html#l00163">DensityPriv::hydrokicks</a>, <a class="el" href="density_8c_source.html#l00102">TreeWalkNgbIterDensity::kernel</a>, <a class="el" href="lightcone_8c_source.html#l00059">kernel()</a>, <a class="el" href="density_8c_source.html#l00103">TreeWalkNgbIterDensity::kernel_volume</a>, <a class="el" href="treewalk_8h_source.html#l00038">TreeWalkNgbIterBase::mask</a>, <a class="el" href="density_8c_source.html#l00159">DensityPriv::MinEgySpec</a>, <a class="el" href="density_8c_source.html#l00124">TreeWalkResultDensity::Ngb</a>, <a class="el" href="treewalk_8h_source.html#l00012">NGB_TREEFIND_ASYMMETRIC</a>, <a class="el" href="treewalk_8h_source.html#l00043">TreeWalkNgbIterBase::other</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="treewalk_8h_source.html#l00042">TreeWalkNgbIterBase::r</a>, <a class="el" href="treewalk_8h_source.html#l00041">TreeWalkNgbIterBase::r2</a>, <a class="el" href="density_8c_source.html#l00122">TreeWalkResultDensity::Rho</a>, <a class="el" href="density_8c_source.html#l00126">TreeWalkResultDensity::Rot</a>, <a class="el" href="density_8c_source.html#l00071">SPH_EntVarPred()</a>, <a class="el" href="density_8c_source.html#l00089">SPH_VelPred()</a>, <a class="el" href="treewalk_8h_source.html#l00037">TreeWalkNgbIterBase::symmetric</a>, <a class="el" href="timestep_8h_source.html#l00027">DriftKickTimes::Ti_Current</a>, <a class="el" href="timestep_8h_source.html#l00023">DriftKickTimes::Ti_kick</a>, <a class="el" href="density_8c_source.html#l00160">DensityPriv::times</a>, <a class="el" href="treewalk_8h_source.html#l00047">LocalTreeWalk::tw</a>, <a class="el" href="density_8c_source.html#l00111">TreeWalkQueryDensity::Type</a>, <a class="el" href="density_8c_source.html#l00109">TreeWalkQueryDensity::Vel</a>, <a class="el" href="density_8h_source.html#l00034">sph_pred_data::VelPred</a>, <a class="el" href="winds_8c_source.html#l00124">winds_is_particle_decoupled()</a>, and <a class="el" href="densitykernel_8c_source.html#l00094">wk</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a146d61fe2d2f53ea9b7fabf2ea5e90b7_cgraph.svg" width="1631" height="651"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a146d61fe2d2f53ea9b7fabf2ea5e90b7_icgraph.svg" width="2548" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae39f5a18f937d210e258c8e8cb710044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39f5a18f937d210e258c8e8cb710044">&#9670;&nbsp;</a></span>density_postprocess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void density_postprocess </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00512">512</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * DhsmlDens = &amp;(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DhsmlDensityFactor[i]);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> = -1;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 0)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> = <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Density;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> = <a class="code" href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a>(i).Density;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> &lt;= 0 &amp;&amp; <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb[i] &gt; 0) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;Particle %d type %d has bad density: %g\n&quot;</span>, i, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type, <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    *DhsmlDens *= <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml / (<a class="code" href="densitykernel_8h.html#a2e32e163509d0638d5c54046429c00b3">NUMDIMS</a> * <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    *DhsmlDens = 1 / (1 + *DhsmlDens);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">/* Uses DhsmlDensityFactor and changes Hsml, hence the location.*/</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;update_hsml)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="density_8c.html#abb05cdc00cf397be5c4dd467308cc4bd">density_check_neighbours</a>(i, tw);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 0)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordtype">int</span> PI = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].PI;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">/*Compute the EgyWeight factors, which are only useful for density independent SPH */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DoEgyDensity) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> * SphP_scratch = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;SPH_predicted;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> EntPred = SphP_scratch-&gt;<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a>[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].PI];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span>(EntPred &lt;= 0 || <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).EgyWtDensity &lt;=0)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;Particle %d has bad predicted entropy: %g or EgyWtDensity: %g\n&quot;</span>, i, EntPred, <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).EgyWtDensity);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DhsmlEgyDensityFactor *= <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml/ (<a class="code" href="densitykernel_8h.html#a2e32e163509d0638d5c54046429c00b3">NUMDIMS</a> * <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).EgyWtDensity);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DhsmlEgyDensityFactor *= - (*DhsmlDens);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).EgyWtDensity /= EntPred;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DhsmlEgyDensityFactor = *DhsmlDens;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * Rot = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot[PI];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).CurlVel = sqrt(Rot[0] * Rot[0] + Rot[1] * Rot[1] + Rot[2] * Rot[2]) / <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Density;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DivVel /= <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Density;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].DtHsml = (1.0 / <a class="code" href="densitykernel_8h.html#a2e32e163509d0638d5c54046429c00b3">NUMDIMS</a>) * <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DivVel * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_abb05cdc00cf397be5c4dd467308cc4bd"><div class="ttname"><a href="density_8c.html#abb05cdc00cf397be5c4dd467308cc4bd">density_check_neighbours</a></div><div class="ttdeci">static void density_check_neighbours(int i, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00554">density.c:554</a></div></div>
<div class="ttc" id="adensity_8c_html_ac49d34dfc3f4e37cac0953d5bc1417a4"><div class="ttname"><a href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a></div><div class="ttdeci">void density(const ActiveParticles *act, int update_hsml, int DoEgyDensity, int BlackHoleOn, double MinEgySpec, const DriftKickTimes times, Cosmology *CP, struct sph_pred_data *SPH_predicted, MyFloat *GradRho, const ForceTree *const tree)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00203">density.c:203</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a57267616e3ede141780cbe94358d827f"><div class="ttname"><a href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a></div><div class="ttdeci">#define BHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00125">slotsmanager.h:125</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a681d502f5cbf25161ff026312cd1498c"><div class="ttname"><a href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a></div><div class="ttdeci">#define SPHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00124">slotsmanager.h:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="slotsmanager_8h_source.html#l00125">BHP</a>, <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00554">density_check_neighbours()</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="densitykernel_8h_source.html#l00005">NUMDIMS</a>, <a class="el" href="density_8c_source.html#l00138">DensityPriv::NumNgb</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, and <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ae39f5a18f937d210e258c8e8cb710044_cgraph.svg" width="1755" height="1702"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ae39f5a18f937d210e258c8e8cb710044_icgraph.svg" width="2580" height="814"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad169b636ff2e25d362af36cdedb8a3f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad169b636ff2e25d362af36cdedb8a3f2">&#9670;&nbsp;</a></span>density_reduce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void density_reduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>place</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a> *&#160;</td>
          <td class="paramname"><em>remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="treewalk_8h.html#a504d8280eaa376504899398c68577cef">TreeWalkReduceMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00339">339</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb[place], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#abecba9797a212dae03830157319bdbfb">Ngb</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DhsmlDensityFactor[place], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a51ab8c8650af2bd6d3b5cc27b9eaf48e">DhsmlDensity</a>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Type == 0)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(place).Density, remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a8fa6b972b6f1057016337c372c881353">Rho</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(place).DivVel, remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#ac06fbce4c1e25bc632898207ac95893b">Div</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordtype">int</span> pi = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].PI;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot[pi][0], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a2a47bbdd508de982da52430e6c9e1b76">Rot</a>[0]);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot[pi][1], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a2a47bbdd508de982da52430e6c9e1b76">Rot</a>[1]);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot[pi][2], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a2a47bbdd508de982da52430e6c9e1b76">Rot</a>[2]);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * gradrho = <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;GradRho;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span>(gradrho) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(gradrho[3*pi], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad1d56d3c2ebb0136903e828925222bde">GradRho</a>[0]);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(gradrho[3*pi+1], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad1d56d3c2ebb0136903e828925222bde">GradRho</a>[1]);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(gradrho[3*pi+2], remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad1d56d3c2ebb0136903e828925222bde">GradRho</a>[2]);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">/*Only used for density independent SPH*/</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DoEgyDensity) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(place).EgyWtDensity, remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#ad9a2cd6dcae268a37537982aa2d661b2">EgyRho</a>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(place).DhsmlEgyDensityFactor, remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a5ad01958cbb907783da12e41b19919bc">DhsmlEgyDensity</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[place].Type == 5)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a>(<a class="code" href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a>(place).Density, remote-&gt;<a class="code" href="structTreeWalkResultDensity.html#a8fa6b972b6f1057016337c372c881353">Rho</a>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="ttc" id="atreewalk_8h_html_adec418ab95919d7f9c11dbea86c32a0f"><div class="ttname"><a href="treewalk_8h.html#adec418ab95919d7f9c11dbea86c32a0f">TREEWALK_REDUCE</a></div><div class="ttdeci">#define TREEWALK_REDUCE(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00189">treewalk.h:189</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="slotsmanager_8h_source.html#l00125">BHP</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="density_8c_source.html#l00123">TreeWalkResultDensity::DhsmlDensity</a>, <a class="el" href="density_8c_source.html#l00147">DensityPriv::DhsmlDensityFactor</a>, <a class="el" href="density_8c_source.html#l00120">TreeWalkResultDensity::DhsmlEgyDensity</a>, <a class="el" href="density_8c_source.html#l00125">TreeWalkResultDensity::Div</a>, <a class="el" href="density_8c_source.html#l00149">DensityPriv::DoEgyDensity</a>, <a class="el" href="density_8c_source.html#l00119">TreeWalkResultDensity::EgyRho</a>, <a class="el" href="density_8c_source.html#l00128">TreeWalkResultDensity::GradRho</a>, <a class="el" href="density_8c_source.html#l00124">TreeWalkResultDensity::Ngb</a>, <a class="el" href="density_8c_source.html#l00138">DensityPriv::NumNgb</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="density_8c_source.html#l00122">TreeWalkResultDensity::Rho</a>, <a class="el" href="density_8c_source.html#l00141">DensityPriv::Rot</a>, <a class="el" href="density_8c_source.html#l00126">TreeWalkResultDensity::Rot</a>, <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>, and <a class="el" href="treewalk_8h_source.html#l00189">TREEWALK_REDUCE</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ad169b636ff2e25d362af36cdedb8a3f2_icgraph.svg" width="2547" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac40e53af730ce9956d564e3dc18d6f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac40e53af730ce9956d564e3dc18d6f0e">&#9670;&nbsp;</a></span>GetDensityKernelType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a> GetDensityKernelType </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00055">55</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="densitykernel_8c_source.html#l00124">density_kernel_desnumngb()</a>, <a class="el" href="densitykernel_8c_source.html#l00157">density_kernel_init()</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8h_source.html#l00011">density_params::DensityResolutionEta</a>, and <a class="el" href="lightcone_8c_source.html#l00059">kernel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blackhole_8c_source.html#l01063">blackhole_accretion_ngbiter()</a>, <a class="el" href="blackhole_8c_source.html#l00866">blackhole_dynfric_ngbiter()</a>, <a class="el" href="blackhole_8c_source.html#l01278">blackhole_feedback_ngbiter()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>, <a class="el" href="metal__return_8c_source.html#l00633">metal_return_ngbiter()</a>, <a class="el" href="petaio_8c_source.html#l00361">petaio_write_header()</a>, <a class="el" href="density_8c_source.html#l00032">set_density_params()</a>, <a class="el" href="test__density_8c_source.html#l00034">set_init_hsml()</a>, <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>, <a class="el" href="metal__return_8c_source.html#l00923">stellar_density()</a>, and <a class="el" href="metal__return_8c_source.html#l00872">stellar_density_ngbiter()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ac40e53af730ce9956d564e3dc18d6f0e_cgraph.svg" width="1639" height="282"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ac40e53af730ce9956d564e3dc18d6f0e_icgraph.svg" width="2015" height="1014"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a23e510a287a10de773a4a0f14db2ff52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e510a287a10de773a4a0f14db2ff52">&#9670;&nbsp;</a></span>GetNumNgb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GetNumNgb </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>&#160;</td>
          <td class="paramname"><em>KernelType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00055">55</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="structDensityKernel.html">DensityKernel</a> <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, 1.0, KernelType);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="densitykernel_8c.html#adc7ade6568b4d241b0f46cde1d5243e2">density_kernel_desnumngb</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="ttc" id="adensitykernel_8c_html_adc7ade6568b4d241b0f46cde1d5243e2"><div class="ttname"><a href="densitykernel_8c.html#adc7ade6568b4d241b0f46cde1d5243e2">density_kernel_desnumngb</a></div><div class="ttdeci">double density_kernel_desnumngb(DensityKernel *kernel, double eta)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00124">densitykernel.c:124</a></div></div>
<div class="ttc" id="astructDensityKernel_html"><div class="ttname"><a href="structDensityKernel.html">DensityKernel</a></div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00023">densitykernel.h:23</a></div></div>
<div class="ttc" id="astructdensity__params_html_a6d8db378d6610350597a71142971d670"><div class="ttname"><a href="structdensity__params.html#a6d8db378d6610350597a71142971d670">density_params::DensityResolutionEta</a></div><div class="ttdeci">double DensityResolutionEta</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00011">density.h:11</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="density_8c_source.html#l00032">set_density_params()</a>, <a class="el" href="test__density_8c_source.html#l00034">set_init_hsml()</a>, <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>, and <a class="el" href="metal__return_8c_source.html#l00923">stellar_density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a23e510a287a10de773a4a0f14db2ff52_icgraph.svg" width="1850" height="920"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6cfed12ec8143f2406ebd7b8d140bf2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfed12ec8143f2406ebd7b8d140bf2c">&#9670;&nbsp;</a></span>set_density_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_density_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParameterSet.html">ParameterSet</a> *&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00032">32</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a> = (<span class="keyword">enum</span> <a class="code" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>) <a class="code" href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a>(ps, <span class="stringliteral">&quot;DensityKernelType&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">MaxNumNgbDeviation</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MaxNumNgbDeviation&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;DensityResolutionEta&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">MinGasHsmlFractional</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MinGasHsmlFractional&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="structDensityKernel.html">DensityKernel</a> <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, 1.0, <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;The Density Kernel type is %s\n&quot;</span>, <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>.name);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;The Density resolution is %g * mean separation, or %g neighbours\n&quot;</span>,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a>, <a class="code" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a>(<a class="code" href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a>()));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">/*These two look like black hole parameters but they are really neighbour finding parameters*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a8c482b6ae9dafc8a5f7f54cc2c36140d">BlackHoleNgbFactor</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;BlackHoleNgbFactor&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;BlackHoleMaxAccretionRadius&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MPI_Bcast(&amp;<a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdensity__params.html">density_params</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_ac40e53af730ce9956d564e3dc18d6f0e"><div class="ttname"><a href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a></div><div class="ttdeci">enum DensityKernelType GetDensityKernelType(void)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:63</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_a1a7e46c6d567f741e1cb3953d9feeeea"><div class="ttname"><a href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a></div><div class="ttdeci">DensityKernelType</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00017">densitykernel.h:17</a></div></div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="aparamset_8c_html_abcc62489086c3bb14a61b90765e8d706"><div class="ttname"><a href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a></div><div class="ttdeci">int param_get_enum(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00378">paramset.c:378</a></div></div>
<div class="ttc" id="astructdensity__params_html"><div class="ttname"><a href="structdensity__params.html">density_params</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00009">density.h:10</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8h_source.html#l00016">density_params::BlackHoleMaxAccretionRadius</a>, <a class="el" href="density_8h_source.html#l00015">density_params::BlackHoleNgbFactor</a>, <a class="el" href="densitykernel_8c_source.html#l00157">density_kernel_init()</a>, <a class="el" href="density_8h_source.html#l00018">density_params::DensityKernelType</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8h_source.html#l00011">density_params::DensityResolutionEta</a>, <a class="el" href="density_8c_source.html#l00063">GetDensityKernelType()</a>, <a class="el" href="density_8c_source.html#l00055">GetNumNgb()</a>, <a class="el" href="lightcone_8c_source.html#l00059">kernel()</a>, <a class="el" href="density_8h_source.html#l00012">density_params::MaxNumNgbDeviation</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="density_8h_source.html#l00022">density_params::MinGasHsmlFractional</a>, <a class="el" href="paramset_8c_source.html#l00336">param_get_double()</a>, <a class="el" href="paramset_8c_source.html#l00378">param_get_enum()</a>, and <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="gadget_2params_8c_source.html#l00359">read_parameter_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a6cfed12ec8143f2406ebd7b8d140bf2c_cgraph.svg" width="1840" height="420"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a6cfed12ec8143f2406ebd7b8d140bf2c_icgraph.svg" width="468" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a539fe4bcf5b8522bc5d345799f1503e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a539fe4bcf5b8522bc5d345799f1503e1">&#9670;&nbsp;</a></span>set_densitypar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_densitypar </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdensity__params.html">density_params</a>&#160;</td>
          <td class="paramname"><em>dp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00025">25</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a> = dp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00021">DensityParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, and <a class="el" href="test__density_8c_source.html#l00314">setup_density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a539fe4bcf5b8522bc5d345799f1503e1_icgraph.svg" width="700" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6af534268ae11ed2bad17f5300af23bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af534268ae11ed2bad17f5300af23bc">&#9670;&nbsp;</a></span>slots_allocate_sph_pred_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> slots_allocate_sph_pred_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00554">554</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> sph_scratch;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/*Data is allocated high so that we can free the tree around it*/</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    sph_scratch.<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a> = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;EntVarPred&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * nsph);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    memset(sph_scratch.EntVarPred, 0, <span class="keyword">sizeof</span>(sph_scratch.EntVarPred[0]) * nsph);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    sph_scratch.VelPred = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;VelPred&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * 3 * nsph);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> sph_scratch;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div>
<div class="ttc" id="amymalloc_8h_html_ac576b6f19b635b512399d6afb8c20d99"><div class="ttname"><a href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a></div><div class="ttdeci">#define mymalloc2(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00016">mymalloc.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, <a class="el" href="test__density_8c_source.html#l00314">setup_density()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a6af534268ae11ed2bad17f5300af23bc_icgraph.svg" width="602" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab4c7ec2e7345138dfdd37b64f3f4554a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4c7ec2e7345138dfdd37b64f3f4554a">&#9670;&nbsp;</a></span>slots_free_sph_pred_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void slots_free_sph_pred_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *&#160;</td>
          <td class="paramname"><em>sph_scratch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00665">665</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(sph_scratch-&gt;<a class="code" href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">VelPred</a>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    sph_scratch-&gt;<a class="code" href="structsph__pred__data.html#a548bc537da0575b96689f32a198c9e5b">VelPred</a> = NULL;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(sph_scratch-&gt;<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    sph_scratch-&gt;<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a> = NULL;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, and <a class="el" href="density_8h_source.html#l00034">sph_pred_data::VelPred</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_ab4c7ec2e7345138dfdd37b64f3f4554a_icgraph.svg" width="647" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a300eea2fe5e00af45e3c65215ff5bfe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300eea2fe5e00af45e3c65215ff5bfe7">&#9670;&nbsp;</a></span>SPH_EntVarPred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> SPH_EntVarPred </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>PI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a3inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dloga</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00071">71</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">double</span> EntVarPred = <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy + <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].DtEntropy * <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">/*Entropy limiter for the predicted entropy: makes sure entropy stays positive. */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a> &gt; 0 &amp;&amp; EntVarPred &lt; 0.5*<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            EntVarPred = 0.5 * <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> enttou = pow(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Density * a3inv, <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>) / <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span>(EntVarPred &lt; MinEgySpec / enttou)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            EntVarPred = MinEgySpec / enttou;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        EntVarPred = pow(EntVarPred, 1/<a class="code" href="physconst_8h.html#a8659b9de3e544ff142b153b076f30fd5">GAMMA</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span> EntVarPred;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="aphysconst_8h_html_a75216f9bf4030240b1fc0e1855e032d2"><div class="ttname"><a href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a></div><div class="ttdeci">#define GAMMA_MINUS1</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00035">physconst.h:35</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a8659b9de3e544ff142b153b076f30fd5"><div class="ttname"><a href="physconst_8h.html#a8659b9de3e544ff142b153b076f30fd5">GAMMA</a></div><div class="ttdeci">#define GAMMA</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00034">physconst.h:34</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a8b808c4888f0bfc7723ae3ce228a9895"><div class="ttname"><a href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a></div><div class="ttdeci">#define SphP</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00119">slotsmanager.h:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lightcone_8c_source.html#l00021">dloga</a>, <a class="el" href="physconst_8h_source.html#l00034">GAMMA</a>, <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, and <a class="el" href="slotsmanager_8h_source.html#l00119">SphP</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, and <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a300eea2fe5e00af45e3c65215ff5bfe7_icgraph.svg" width="2150" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a10d3cfe0024d97740707f82efde883ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d3cfe0024d97740707f82efde883ea">&#9670;&nbsp;</a></span>SPH_VelPred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPH_VelPred </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *&#160;</td>
          <td class="paramname"><em>VelPred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>FgravkickB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gravkick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hydrokick</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00089">89</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        VelPred[j] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Vel[j] + gravkick * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].GravAccel[j]</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            + <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].GravPM[j] * FgravkickB + hydrokick * <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).HydroAccel[j];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00088">P</a>, and <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, and <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8c_a10d3cfe0024d97740707f82efde883ea_icgraph.svg" width="2127" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9c4ca3648e6ac54cdb5adb45acc2e4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4ca3648e6ac54cdb5adb45acc2e4e3">&#9670;&nbsp;</a></span>DensityParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdensity__params.html">density_params</a> DensityParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00001">1</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00554">density_check_neighbours()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, <a class="el" href="density_8c_source.html#l00063">GetDensityKernelType()</a>, <a class="el" href="density_8c_source.html#l00032">set_density_params()</a>, and <a class="el" href="density_8c_source.html#l00025">set_densitypar()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
