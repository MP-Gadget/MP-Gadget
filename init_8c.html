<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>code for initialisation of a simulation from initial conditions  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;gsl/gsl_sf_gamma.h&gt;</code><br />
<code>#include &quot;<a class="el" href="init_8h_source.html">init.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cooling_8h_source.html">cooling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="forcetree_8h_source.html">forcetree.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="density_8h_source.html">density.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timefac_8h_source.html">timefac.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="petaio_8h_source.html">petaio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="domain_8h_source.html">domain.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="walltime_8h_source.html">walltime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slotsmanager_8h_source.html">slotsmanager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hydra_8h_source.html">hydra.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sfr__eff_8h_source.html">sfr_eff.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="exchange_8h_source.html">exchange.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fof_8h_source.html">fof.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timestep_8h_source.html">timestep.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timebinmgr_8h_source.html">timebinmgr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cosmology_8h_source.html">cosmology.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gravity_8h_source.html">gravity.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="physconst_8h_source.html">physconst.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for init.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c__incl.svg" width="2650" height="784"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="init_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinit__params.html">init_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a584819ffe166915fdfcf130fa437dccf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a584819ffe166915fdfcf130fa437dccf">set_init_params</a> (<a class="el" href="structParameterSet.html">ParameterSet</a> *ps)</td></tr>
<tr class="separator:a584819ffe166915fdfcf130fa437dccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa558832e90f57e2c3785480ebbea3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#aefa558832e90f57e2c3785480ebbea3e">init_timeline</a> (int RestartSnapNum, double TimeMax, const struct <a class="el" href="structheader__data.html">header_data</a> *header, const int SnapshotWithFOF)</td></tr>
<tr class="separator:aefa558832e90f57e2c3785480ebbea3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad88bf3c38bb8fc5e7347b4395ce28f89"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#ad88bf3c38bb8fc5e7347b4395ce28f89">get_mean_separation</a> (double *MeanSeparation, const double BoxSize, const int64_t *NTotalInit)</td></tr>
<tr class="separator:ad88bf3c38bb8fc5e7347b4395ce28f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7061bcc4ad1561e16bf521d3930bc7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a3f7061bcc4ad1561e16bf521d3930bc7">check_omega</a> (struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *<a class="el" href="test__slotsmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, int generations, double <a class="el" href="test__gravity_8c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a>, double *MassTable)</td></tr>
<tr class="separator:a3f7061bcc4ad1561e16bf521d3930bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab364d00a825a0626c372d4e4d920dc82"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#ab364d00a825a0626c372d4e4d920dc82">check_positions</a> (struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *<a class="el" href="test__slotsmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>)</td></tr>
<tr class="separator:ab364d00a825a0626c372d4e4d920dc82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2aa7234a2bfacc56111a144f0af111"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a7c2aa7234a2bfacc56111a144f0af111">check_smoothing_length</a> (struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *<a class="el" href="test__slotsmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, double *MeanSpacing)</td></tr>
<tr class="separator:a7c2aa7234a2bfacc56111a144f0af111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd80f353bfe842a89d201ba9b81f7f1a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#abd80f353bfe842a89d201ba9b81f7f1a">init_alloc_particle_slot_memory</a> (struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *<a class="el" href="test__slotsmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, struct <a class="el" href="structslots__manager__type.html">slots_manager_type</a> *<a class="el" href="test__forcetree_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, const double PartAllocFactor, struct <a class="el" href="structheader__data.html">header_data</a> *header, MPI_Comm Comm)</td></tr>
<tr class="separator:abd80f353bfe842a89d201ba9b81f7f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e8594acf366f237632083d743efb0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#ac2e8594acf366f237632083d743efb0a">init</a> (int RestartSnapNum, const char *OutputDir, struct <a class="el" href="structheader__data.html">header_data</a> *header, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>)</td></tr>
<tr class="separator:ac2e8594acf366f237632083d743efb0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5490a5c3a899d73926b3c5290b805c6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a5490a5c3a899d73926b3c5290b805c6a">check_density_entropy</a> (<a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, const double MinEgySpec, const double atime)</td></tr>
<tr class="separator:a5490a5c3a899d73926b3c5290b805c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af35b2ff44ee11141241741fa051ad2ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#af35b2ff44ee11141241741fa051ad2ac">setup_density_indep_entropy</a> (const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *act, <a class="el" href="structForceTree.html">ForceTree</a> *Tree, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *sph_pred, double u_init, double a3, int BlackHoleOn, const <a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Current)</td></tr>
<tr class="separator:af35b2ff44ee11141241741fa051ad2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a713a74e1e0ca55699bc6581763bae177"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a713a74e1e0ca55699bc6581763bae177">setup_smoothinglengths</a> (int RestartSnapNum, <a class="el" href="structDomainDecomp.html">DomainDecomp</a> *ddecomp, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, int BlackHoleOn, double MinEgySpec, double uu_in_cgs, const <a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Current, const double atime, const int64_t NTotGasInit)</td></tr>
<tr class="separator:a713a74e1e0ca55699bc6581763bae177"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structinit__params.html">init_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a></td></tr>
<tr class="separator:a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>code for initialisation of a simulation from initial conditions </p>

<p class="definition">Definition in file <a class="el" href="init_8c_source.html">init.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5490a5c3a899d73926b3c5290b805c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5490a5c3a899d73926b3c5290b805c6a">&#9670;&nbsp;</a></span>check_density_entropy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_density_entropy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>atime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00344">344</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> a3 = pow(atime, 3);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> bad = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">double</span> meanbar = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> * 3 * <a class="code" href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a> * <a class="code" href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>/ (8 * M_PI * <a class="code" href="physconst_8h.html#a6801baa546c6112d19eb095111d24720">GRAVITY</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+: bad)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>; i++) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">/* This allows us to continue gracefully if</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">            * there was some kind of bug in the run that output the snapshot.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">            * density() below will fix this up.*/</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density &lt;= 0 || !isfinite(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density)) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density = meanbar;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            bad++;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity &lt;= 0 || !isfinite(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity)) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity = <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">double</span> minent = <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a> * MinEgySpec / pow(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density / a3 , <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Entropy &lt; minent)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Entropy = minent;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    MPI_Allreduce(MPI_IN_PLACE, &amp;bad, 1, MPI_INT, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span>(bad &gt; 0)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Detected bad densities in %d particles on disc\n&quot;</span>,bad);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a5de72d8762faf787d06d4dd47daeddeb"><div class="ttname"><a href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a></div><div class="ttdeci">#define HUBBLE</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00025">physconst.h:25</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a6801baa546c6112d19eb095111d24720"><div class="ttname"><a href="physconst_8h.html#a6801baa546c6112d19eb095111d24720">GRAVITY</a></div><div class="ttdeci">#define GRAVITY</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00005">physconst.h:5</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a75216f9bf4030240b1fc0e1855e032d2"><div class="ttname"><a href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a></div><div class="ttdeci">#define GAMMA_MINUS1</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00035">physconst.h:35</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a8b808c4888f0bfc7723ae3ce228a9895"><div class="ttname"><a href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a></div><div class="ttdeci">#define SphP</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00119">slotsmanager.h:119</a></div></div>
<div class="ttc" id="astructCosmology_html_a4b79dcaa1e1c38d07258c3f539e2cb20"><div class="ttname"><a href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">Cosmology::HubbleParam</a></div><div class="ttdeci">double HubbleParam</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00020">cosmology.h:20</a></div></div>
<div class="ttc" id="astructCosmology_html_ac818659114fd72f09039b088e43e8624"><div class="ttname"><a href="structCosmology.html#ac818659114fd72f09039b088e43e8624">Cosmology::OmegaBaryon</a></div><div class="ttdeci">double OmegaBaryon</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00019">cosmology.h:19</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, <a class="el" href="physconst_8h_source.html#l00005">GRAVITY</a>, <a class="el" href="physconst_8h_source.html#l00025">HUBBLE</a>, <a class="el" href="cosmology_8h_source.html#l00020">Cosmology::HubbleParam</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="cosmology_8h_source.html#l00019">Cosmology::OmegaBaryon</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, and <a class="el" href="slotsmanager_8h_source.html#l00119">SphP</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00194">begrun()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a5490a5c3a899d73926b3c5290b805c6a_cgraph.svg" width="580" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a5490a5c3a899d73926b3c5290b805c6a_icgraph.svg" width="400" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3f7061bcc4ad1561e16bf521d3930bc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f7061bcc4ad1561e16bf521d3930bc7">&#9670;&nbsp;</a></span>check_omega()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void check_omega </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *&#160;</td>
          <td class="paramname"><em>PartManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>MassTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine computes the mass content of the box and compares it to the specified value of Omega-matter. If discrepant, the run is terminated. </p>

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00184">184</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">double</span> mass = 0, masstot, omega;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">int</span> i, badmass = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    int64_t totbad;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+: mass) reduction(+: badmass)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">/* In case zeros have been written to the saved mass array,</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">         * recover the true masses*/</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass == 0) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass = MassTable[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type] * ( 1. - (double)<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Generation/generations);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            badmass++;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        mass += <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    MPI_Allreduce(&amp;mass, &amp;masstot, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a>(1, &amp;badmass, &amp;totbad);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(totbad)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Warning: recovering from %ld Mass entries corrupted on disc\n&quot;</span>,totbad);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    omega =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        masstot / (<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>) / (3 * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> / (8 * M_PI * <a class="code" href="test__gravity_8c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">/*Add the density for analytically follows massive neutrinos*/</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a>)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        omega += <a class="code" href="omega__nu__single_8c.html#afcee6621dd25537fe0fef1428ed87cb0">get_omega_nu_nopart</a>(&amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#af03043a56ad2b2b697762d127b8b906b">ONu</a>, 1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span>(fabs(omega - <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a>) &gt; 1.0e-3)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;The mass content accounts only for Omega=%g,\nbut you specified Omega=%g in the parameterfile.\n&quot;</span>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                omega, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
<div class="ttc" id="aomega__nu__single_8c_html_afcee6621dd25537fe0fef1428ed87cb0"><div class="ttname"><a href="omega__nu__single_8c.html#afcee6621dd25537fe0fef1428ed87cb0">get_omega_nu_nopart</a></div><div class="ttdeci">double get_omega_nu_nopart(const _omega_nu *const omnu, const double a)</div><div class="ttdef"><b>Definition:</b> <a href="omega__nu__single_8c_source.html#l00071">omega_nu_single.c:71</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="astructCosmology_html_a43e0dba956c6dc4fad8b1aaf0fa84248"><div class="ttname"><a href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Cosmology::Omega0</a></div><div class="ttdeci">double Omega0</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00010">cosmology.h:10</a></div></div>
<div class="ttc" id="astructCosmology_html_ad088df185d7995a9c95eb5e87e006ea5"><div class="ttname"><a href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">Cosmology::MassiveNuLinRespOn</a></div><div class="ttdeci">int MassiveNuLinRespOn</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00026">cosmology.h:26</a></div></div>
<div class="ttc" id="astructCosmology_html_af03043a56ad2b2b697762d127b8b906b"><div class="ttname"><a href="structCosmology.html#af03043a56ad2b2b697762d127b8b906b">Cosmology::ONu</a></div><div class="ttdeci">_omega_nu ONu</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00024">cosmology.h:24</a></div></div>
<div class="ttc" id="astructCosmology_html_af1c6029696c00e5405054f00e849e972"><div class="ttname"><a href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Cosmology::Hubble</a></div><div class="ttdeci">double Hubble</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00021">cosmology.h:21</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_afd51316d545eaf7f3f083aea9616858d"><div class="ttname"><a href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">part_manager_type::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00084">partmanager.h:84</a></div></div>
<div class="ttc" id="asystem_8c_html_a866c4b0425665030c89933c11752b1fe"><div class="ttname"><a href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a></div><div class="ttdeci">void sumup_large_ints(int n, int *src, int64_t *res)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00192">system.c:192</a></div></div>
<div class="ttc" id="atest__gravity_8c_html_ab97e4616d23ed4c2961295010c1afc3c"><div class="ttname"><a href="test__gravity_8c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a></div><div class="ttdeci">static const double G</div><div class="ttdef"><b>Definition:</b> <a href="test__gravity_8c_source.html#l00035">test_gravity.c:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="test__gravity_8c_source.html#l00035">G</a>, <a class="el" href="omega__nu__single_8c_source.html#l00071">get_omega_nu_nopart()</a>, <a class="el" href="cosmology_8h_source.html#l00021">Cosmology::Hubble</a>, <a class="el" href="cosmology_8h_source.html#l00026">Cosmology::MassiveNuLinRespOn</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="cosmology_8h_source.html#l00010">Cosmology::Omega0</a>, <a class="el" href="cosmology_8h_source.html#l00024">Cosmology::ONu</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, and <a class="el" href="system_8c_source.html#l00192">sumup_large_ints()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a3f7061bcc4ad1561e16bf521d3930bc7_cgraph.svg" width="1040" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a3f7061bcc4ad1561e16bf521d3930bc7_icgraph.svg" width="431" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab364d00a825a0626c372d4e4d920dc82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab364d00a825a0626c372d4e4d920dc82">&#9670;&nbsp;</a></span>check_positions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void check_positions </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *&#160;</td>
          <td class="paramname"><em>PartManager</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine checks that the initial positions of the particles are within the box. If not, there is likely a bug in the IC generator and we abort. It also checks for multiple zeros in the positions, guarding against a common fs bug. </p>

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00294">294</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">int</span> numzero = 0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">int</span> lastzero = -1;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+: numzero) reduction(max:lastzero)</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++){</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordtype">double</span> * Pos = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>[i].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; j++) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">if</span>(Pos[j] &lt; 0 || Pos[j] &gt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> || !isfinite(Pos[j]))</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0,<span class="stringliteral">&quot;Particle %d is outside the box (L=%g) at (%g %g %g)\n&quot;</span>,i, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, Pos[0], Pos[1], Pos[2]);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">if</span>((Pos[0] &lt; 1e-35) &amp;&amp; (Pos[1] &lt; 1e-35) &amp;&amp; (Pos[2] &lt; 1e-35)) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            numzero++;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            lastzero = i;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span>(numzero &gt; 1)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(5, <span class="stringliteral">&quot;Particle positions contain %d zeros at particle %d. Pos %g %g %g. Likely write corruption!\n&quot;</span>,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                numzero, lastzero, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>[lastzero].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>[0], <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>[lastzero].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>[1], <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>[lastzero].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>[2]);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="ttc" id="astructpart__manager__type_html_a4dcf875204ca1e4c7cbcfe313ca6dea9"><div class="ttname"><a href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">part_manager_type::Base</a></div><div class="ttdeci">struct particle_data * Base</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00074">partmanager.h:74</a></div></div>
<div class="ttc" id="astructparticle__data_html_a8a2930279027f0fff6ef709c41e718ec"><div class="ttname"><a href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">particle_data::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00012">partmanager.h:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00074">part_manager_type::Base</a>, <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, and <a class="el" href="partmanager_8h_source.html#l00012">particle_data::Pos</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_ab364d00a825a0626c372d4e4d920dc82_cgraph.svg" width="542" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_ab364d00a825a0626c372d4e4d920dc82_icgraph.svg" width="446" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7c2aa7234a2bfacc56111a144f0af111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2aa7234a2bfacc56111a144f0af111">&#9670;&nbsp;</a></span>check_smoothing_length()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void check_smoothing_length </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *&#160;</td>
          <td class="paramname"><em>PartManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>MeanSpacing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine checks that the initial smoothing lengths of the particles are sensible and resets them to mean interparticle spacing if not. Guards against a problem writing the snapshot. Matters because a very large initial smoothing length will cause <a class="el" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density()</a> to go crazy. </p>

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00323">323</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">int</span> numprob = 0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">int</span> lastprob = -1;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+: numprob) reduction(max:lastprob)</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++){</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type != 5 &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type != 0)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &gt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> || <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &lt;= 0) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = MeanSpacing[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            numprob++;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            lastprob = i;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span>(numprob &gt; 0)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(5, <span class="stringliteral">&quot;Bad smoothing lengths %d last bad %d hsml %g id %ld\n&quot;</span>, numprob, lastprob, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[lastprob].Hsml, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[lastprob].ID);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, and <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a7c2aa7234a2bfacc56111a144f0af111_cgraph.svg" width="592" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a7c2aa7234a2bfacc56111a144f0af111_icgraph.svg" width="503" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad88bf3c38bb8fc5e7347b4395ce28f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad88bf3c38bb8fc5e7347b4395ce28f89">&#9670;&nbsp;</a></span>get_mean_separation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void get_mean_separation </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>MeanSeparation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>BoxSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t *&#160;</td>
          <td class="paramname"><em>NTotalInit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00371">371</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 6; i++) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span>(NTotalInit[i] &gt; 0)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            MeanSeparation[i] = BoxSize / pow(NTotalInit[i], 1.0 / 3);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_ad88bf3c38bb8fc5e7347b4395ce28f89_icgraph.svg" width="482" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac2e8594acf366f237632083d743efb0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e8594acf366f237632083d743efb0a">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>RestartSnapNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>OutputDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structheader__data.html">header_data</a> *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads the initial conditions, allocates storage for the particle data, validates and initialises the particle data. </p>

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00086">86</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="init_8c.html#abd80f353bfe842a89d201ba9b81f7f1a">init_alloc_particle_slot_memory</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, <a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a5fe84408a7e569955057e00c7dab8eb1">PartAllocFactor</a>, header, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">/*Read the snapshot*/</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="petaio_8c.html#a18ce9fa2faeaab142a978b2293493b5d">petaio_read_snapshot</a>(RestartSnapNum, OutputDir, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, header, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="exchange_8c.html#a285784bd5ff2c9b8328789a8a093e445">domain_test_id_uniqueness</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="init_8c.html#a3f7061bcc4ad1561e16bf521d3930bc7">check_omega</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="sfr__eff_8c.html#a50b5665399825c31849545fe351e51ab">get_generations</a>(), <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>, header-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="init_8c.html#ab364d00a825a0626c372d4e4d920dc82">check_positions</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">double</span> MeanSeparation[6] = {0};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="init_8c.html#ad88bf3c38bb8fc5e7347b4395ce28f89">get_mean_separation</a>(MeanSeparation, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, header-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span>(RestartSnapNum == -1)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="init_8c.html#a7c2aa7234a2bfacc56111a144f0af111">check_smoothing_length</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, MeanSeparation);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">/* As the above will mostly take place</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">     * on Task 0, there will be a lot of imbalance*/</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(MPI_COMM_WORLD);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="gravity_8h.html#a156a352a97a16dfce5190e1370d4e588">gravshort_set_softenings</a>(MeanSeparation[1]);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="fof_8c.html#a96820d22f0ab2a61425e423da2121fd6">fof_init</a>(MeanSeparation[1]);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Current = <a class="code" href="timestep_8c.html#a573e730c561dfb971b96703c6711d09e">init_timebins</a>(header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++)   <span class="comment">/* initialize sph_properties */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Ti_drift = Ti_Current;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span>(RestartSnapNum == -1 &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5 )</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">/* Note: Gadget-3 sets this to the seed black hole mass.*/</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <a class="code" href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a>(i).Mass = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 4 )</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">/* Touch up zero star smoothing lengths, not saved in the snapshots.*/</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml == 0)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = 0.1 * MeanSeparation[0];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 5)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a>(i).DFAccel[j] = 0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a>(i).DragAccel[j] = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Key = <a class="code" href="peano_8h.html#a48e081711b7df745b6222e6e62e081ed">PEANO</a>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Pos, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type != 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).HydroAccel[j] = 0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span>(!isfinite(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DelayTime ))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(6, <span class="stringliteral">&quot;Bad DelayTime %g for part %d id %ld\n&quot;</span>, <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DelayTime, i, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].ID);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DtEntropy = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span>(RestartSnapNum == -1)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Density = -1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).EgyWtDensity = -1;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DhsmlEgyDensityFactor = -1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Entropy = -1;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Ne = 1.0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DivVel = 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).CurlVel = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).DelayTime = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Metallicity = 0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            memset(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Metals, 0, <a class="code" href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">/* Initialise to primordial abundances for H and He*/</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Metals[0] = <a class="code" href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Metals[1] = 1- <a class="code" href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).Sfr = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).MaxSignalVel = 0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Init&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> Ti_Current;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="ttc" id="aexchange_8c_html_a285784bd5ff2c9b8328789a8a093e445"><div class="ttname"><a href="exchange_8c.html#a285784bd5ff2c9b8328789a8a093e445">domain_test_id_uniqueness</a></div><div class="ttdeci">void domain_test_id_uniqueness(struct part_manager_type *pman)</div><div class="ttdef"><b>Definition:</b> <a href="exchange_8c_source.html#l00570">exchange.c:570</a></div></div>
<div class="ttc" id="afof_8c_html_a96820d22f0ab2a61425e423da2121fd6"><div class="ttname"><a href="fof_8c.html#a96820d22f0ab2a61425e423da2121fd6">fof_init</a></div><div class="ttdeci">void fof_init(double DMMeanSeparation)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00066">fof.c:66</a></div></div>
<div class="ttc" id="agravity_8h_html_a156a352a97a16dfce5190e1370d4e588"><div class="ttname"><a href="gravity_8h.html#a156a352a97a16dfce5190e1370d4e588">gravshort_set_softenings</a></div><div class="ttdeci">void gravshort_set_softenings(double MeanDMSeparation)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00047">gravshort-tree.c:47</a></div></div>
<div class="ttc" id="ainit_8c_html_a3f7061bcc4ad1561e16bf521d3930bc7"><div class="ttname"><a href="init_8c.html#a3f7061bcc4ad1561e16bf521d3930bc7">check_omega</a></div><div class="ttdeci">static void check_omega(struct part_manager_type *PartManager, Cosmology *CP, int generations, double G, double *MassTable)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00184">init.c:184</a></div></div>
<div class="ttc" id="ainit_8c_html_a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb"><div class="ttname"><a href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a></div><div class="ttdeci">static struct init_params InitParams</div></div>
<div class="ttc" id="ainit_8c_html_a7c2aa7234a2bfacc56111a144f0af111"><div class="ttname"><a href="init_8c.html#a7c2aa7234a2bfacc56111a144f0af111">check_smoothing_length</a></div><div class="ttdeci">static void check_smoothing_length(struct part_manager_type *PartManager, double *MeanSpacing)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00323">init.c:323</a></div></div>
<div class="ttc" id="ainit_8c_html_ab364d00a825a0626c372d4e4d920dc82"><div class="ttname"><a href="init_8c.html#ab364d00a825a0626c372d4e4d920dc82">check_positions</a></div><div class="ttdeci">static void check_positions(struct part_manager_type *PartManager)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00294">init.c:294</a></div></div>
<div class="ttc" id="ainit_8c_html_abd80f353bfe842a89d201ba9b81f7f1a"><div class="ttname"><a href="init_8c.html#abd80f353bfe842a89d201ba9b81f7f1a">init_alloc_particle_slot_memory</a></div><div class="ttdeci">static void init_alloc_particle_slot_memory(struct part_manager_type *PartManager, struct slots_manager_type *SlotsManager, const double PartAllocFactor, struct header_data *header, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00222">init.c:222</a></div></div>
<div class="ttc" id="ainit_8c_html_ad88bf3c38bb8fc5e7347b4395ce28f89"><div class="ttname"><a href="init_8c.html#ad88bf3c38bb8fc5e7347b4395ce28f89">get_mean_separation</a></div><div class="ttdeci">static void get_mean_separation(double *MeanSeparation, const double BoxSize, const int64_t *NTotalInit)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00371">init.c:371</a></div></div>
<div class="ttc" id="apeano_8h_html_a48e081711b7df745b6222e6e62e081ed"><div class="ttname"><a href="peano_8h.html#a48e081711b7df745b6222e6e62e081ed">PEANO</a></div><div class="ttdeci">static peano_t PEANO(double *Pos, double BoxSize)</div><div class="ttdef"><b>Definition:</b> <a href="peano_8h_source.html#l00014">peano.h:14</a></div></div>
<div class="ttc" id="apetaio_8c_html_a18ce9fa2faeaab142a978b2293493b5d"><div class="ttname"><a href="petaio_8c.html#a18ce9fa2faeaab142a978b2293493b5d">petaio_read_snapshot</a></div><div class="ttdeci">void petaio_read_snapshot(int num, const char *OutputDir, Cosmology *CP, struct header_data *header, struct part_manager_type *PartManager, struct slots_manager_type *SlotsManager, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00255">petaio.c:255</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a67abaa49a5aa2892eba705d380652279"><div class="ttname"><a href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a></div><div class="ttdeci">#define HYDROGEN_MASSFRAC</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00037">physconst.h:37</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_a50b5665399825c31849545fe351e51ab"><div class="ttname"><a href="sfr__eff_8c.html#a50b5665399825c31849545fe351e51ab">get_generations</a></div><div class="ttdeci">int get_generations(void)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00087">sfr_eff.c:87</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a57267616e3ede141780cbe94358d827f"><div class="ttname"><a href="slotsmanager_8h.html#a57267616e3ede141780cbe94358d827f">BHP</a></div><div class="ttdeci">#define BHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00125">slotsmanager.h:125</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a681d502f5cbf25161ff026312cd1498c"><div class="ttname"><a href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a></div><div class="ttdeci">#define SPHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00124">slotsmanager.h:124</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_ad07d3b873121463218a991d53512e49b"><div class="ttname"><a href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a></div><div class="ttdeci">#define NMETALS</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00060">slotsmanager.h:60</a></div></div>
<div class="ttc" id="astructCosmology_html_a0970aac048f04a9ccd8778aaf07a0bbc"><div class="ttname"><a href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">Cosmology::GravInternal</a></div><div class="ttdeci">double GravInternal</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00032">cosmology.h:32</a></div></div>
<div class="ttc" id="astructheader__data_html_a3018a9d27eb35ace7191750070e5b738"><div class="ttname"><a href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">header_data::NTotalInit</a></div><div class="ttdeci">int64_t NTotalInit[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00020">petaio.h:20</a></div></div>
<div class="ttc" id="astructheader__data_html_a3f2592f3de9589278f2729aefc8fe470"><div class="ttname"><a href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">header_data::TimeSnapshot</a></div><div class="ttdeci">double TimeSnapshot</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00026">petaio.h:26</a></div></div>
<div class="ttc" id="astructheader__data_html_aaa78a996d4b10f0509c26ca61eb4d644"><div class="ttname"><a href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">header_data::MassTable</a></div><div class="ttdeci">double MassTable[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00022">petaio.h:22</a></div></div>
<div class="ttc" id="astructinit__params_html_a5fe84408a7e569955057e00c7dab8eb1"><div class="ttname"><a href="structinit__params.html#a5fe84408a7e569955057e00c7dab8eb1">init_params::PartAllocFactor</a></div><div class="ttdeci">double PartAllocFactor</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00040">init.c:40</a></div></div>
<div class="ttc" id="asystem_8h_html_a2ca58d338cd52c808ec1a86073940c49"><div class="ttname"><a href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a></div><div class="ttdeci">#define MPIU_Barrier(comm)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00103">system.h:103</a></div></div>
<div class="ttc" id="atimestep_8c_html_a573e730c561dfb971b96703c6711d09e"><div class="ttname"><a href="timestep_8c.html#a573e730c561dfb971b96703c6711d09e">init_timebins</a></div><div class="ttdeci">inttime_t init_timebins(double TimeInit)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00123">timestep.c:123</a></div></div>
<div class="ttc" id="atypes_8h_html_ab7f8779710efa655135cf9cbee3137a7"><div class="ttname"><a href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a></div><div class="ttdeci">int32_t inttime_t</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00008">types.h:8</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="slotsmanager_8h_source.html#l00125">BHP</a>, <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="init_8c_source.html#l00184">check_omega()</a>, <a class="el" href="init_8c_source.html#l00294">check_positions()</a>, <a class="el" href="init_8c_source.html#l00323">check_smoothing_length()</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="exchange_8c_source.html#l00570">domain_test_id_uniqueness()</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="fof_8c_source.html#l00066">fof_init()</a>, <a class="el" href="sfr__eff_8c_source.html#l00087">get_generations()</a>, <a class="el" href="init_8c_source.html#l00371">get_mean_separation()</a>, <a class="el" href="cosmology_8h_source.html#l00032">Cosmology::GravInternal</a>, <a class="el" href="gravshort-tree_8c_source.html#l00047">gravshort_set_softenings()</a>, <a class="el" href="physconst_8h_source.html#l00037">HYDROGEN_MASSFRAC</a>, <a class="el" href="init_8c_source.html#l00222">init_alloc_particle_slot_memory()</a>, <a class="el" href="timestep_8c_source.html#l00123">init_timebins()</a>, <a class="el" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>, <a class="el" href="petaio_8h_source.html#l00022">header_data::MassTable</a>, <a class="el" href="system_8h_source.html#l00103">MPIU_Barrier</a>, <a class="el" href="slotsmanager_8h_source.html#l00060">NMETALS</a>, <a class="el" href="petaio_8h_source.html#l00020">header_data::NTotalInit</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="init_8c_source.html#l00040">init_params::PartAllocFactor</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="peano_8h_source.html#l00014">PEANO()</a>, <a class="el" href="petaio_8c_source.html#l00255">petaio_read_snapshot()</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>, <a class="el" href="petaio_8h_source.html#l00026">header_data::TimeSnapshot</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00194">begrun()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_ac2e8594acf366f237632083d743efb0a_cgraph.svg" width="1390" height="1544"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_ac2e8594acf366f237632083d743efb0a_icgraph.svg" width="271" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abd80f353bfe842a89d201ba9b81f7f1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd80f353bfe842a89d201ba9b81f7f1a">&#9670;&nbsp;</a></span>init_alloc_particle_slot_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_alloc_particle_slot_memory </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpart__manager__type.html">part_manager_type</a> *&#160;</td>
          <td class="paramname"><em>PartManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structslots__manager__type.html">slots_manager_type</a> *&#160;</td>
          <td class="paramname"><em>SlotsManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>PartAllocFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structheader__data.html">header_data</a> *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00222">222</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>, <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    MPI_Comm_size(Comm, &amp;<a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    MPI_Comm_rank(Comm, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    int64_t <a class="code" href="test__exchange_8c.html#a73eab74927dfbb4060edd1ee7f3af699">TotNumPart</a> = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    int64_t TotNumPartInit= 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> ++) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="test__exchange_8c.html#a73eab74927dfbb4060edd1ee7f3af699">TotNumPart</a> += header-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        TotNumPartInit += header-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Total number of particles: %018ld\n&quot;</span>, <a class="code" href="test__exchange_8c.html#a73eab74927dfbb4060edd1ee7f3af699">TotNumPart</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * PARTICLE_TYPE_NAMES [] = {<span class="stringliteral">&quot;Gas&quot;</span>, <span class="stringliteral">&quot;DarkMatter&quot;</span>, <span class="stringliteral">&quot;Neutrino&quot;</span>, <span class="stringliteral">&quot;Unknown&quot;</span>, <span class="stringliteral">&quot;Star&quot;</span>, <span class="stringliteral">&quot;BlackHole&quot;</span>};</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> ++) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordtype">double</span> MeanSeparation = header-&gt;<a class="code" href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">BoxSize</a> / pow(header-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], 1.0 / 3);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;% 11s: Total: %018ld Init: %018ld Mean-Sep %g \n&quot;</span>,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                PARTICLE_TYPE_NAMES[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], header-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], header-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], MeanSeparation);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">/* sets the maximum number of particles that may reside on a processor */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">int</span> MaxPart = (int) (PartAllocFactor * TotNumPartInit / <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">/*Allocate the particle memory*/</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="partmanager_8c.html#ade1ba4251e496fe0a93ba0e4259cd550">particle_alloc_memory</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, header-&gt;<a class="code" href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">BoxSize</a>, MaxPart);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> ++) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        int64_t start = <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> * header-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] / <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        int64_t end = (<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> + 1) * header-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] / <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        header-&gt;<a class="code" href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">NLocal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] = end - start;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> += header-&gt;<a class="code" href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">NLocal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>];</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* Allocate enough memory for stars and black holes.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">     * This will be dynamically increased as needed.*/</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> &gt;= <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">MaxPart</a>) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;Overwhelmed by part: %ld &gt; %ld\n&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">MaxPart</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">/* Now allocate memory for the secondary particle data arrays.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">     * This may be dynamically resized later!*/</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">/*Ensure all processors have initially the same number of particle slots*/</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    int64_t newSlots[6] = {0};</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">/* Can&#39;t use MPI_IN_PLACE, which is broken for arrays and MPI_MAX at least on intel mpi 19.0.5*/</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    MPI_Allreduce(header-&gt;<a class="code" href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">NLocal</a>, newSlots, 6, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_MAX, Comm);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> ++) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            newSlots[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] *= PartAllocFactor;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">/* Boost initial amount of stars allocated, as it is often uneven.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">     * The total number of stars is usually small so this doesn&#39;t</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">     * waste that much memory*/</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    newSlots[4] *= 2;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="slotsmanager_8c.html#a0effa6d52d74a3ca0b91c1cae3b72b5e">slots_reserve</a>(0, newSlots, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">/* so we can set up the memory topology of secondary slots */</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="slotsmanager_8c.html#a7125c2adba645e0ea2358d4c3500f78a">slots_setup_topology</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, header-&gt;<a class="code" href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">NLocal</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="apartmanager_8c_html_ade1ba4251e496fe0a93ba0e4259cd550"><div class="ttname"><a href="partmanager_8c.html#ade1ba4251e496fe0a93ba0e4259cd550">particle_alloc_memory</a></div><div class="ttdeci">void particle_alloc_memory(struct part_manager_type *PartManager, double BoxSize, int64_t MaxPart)</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00014">partmanager.c:14</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a0effa6d52d74a3ca0b91c1cae3b72b5e"><div class="ttname"><a href="slotsmanager_8c.html#a0effa6d52d74a3ca0b91c1cae3b72b5e">slots_reserve</a></div><div class="ttdeci">size_t slots_reserve(int where, int64_t atleast[6], struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00475">slotsmanager.c:475</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a7125c2adba645e0ea2358d4c3500f78a"><div class="ttname"><a href="slotsmanager_8c.html#a7125c2adba645e0ea2358d4c3500f78a">slots_setup_topology</a></div><div class="ttdeci">void slots_setup_topology(struct part_manager_type *pman, int64_t *NLocal, struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00624">slotsmanager.c:624</a></div></div>
<div class="ttc" id="astructheader__data_html_a9c711b22317be63826f76b8f60d0eeef"><div class="ttname"><a href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">header_data::NLocal</a></div><div class="ttdeci">int64_t NLocal[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00016">petaio.h:16</a></div></div>
<div class="ttc" id="astructheader__data_html_ae28db91028a22d277523890fd51d72c4"><div class="ttname"><a href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">header_data::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00028">petaio.h:28</a></div></div>
<div class="ttc" id="astructheader__data_html_afd7952ed03fc314454e077e755851558"><div class="ttname"><a href="structheader__data.html#afd7952ed03fc314454e077e755851558">header_data::NTotal</a></div><div class="ttdeci">int64_t NTotal[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00018">petaio.h:18</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a5e24abb34f2c8998d8b35c217477d580"><div class="ttname"><a href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">part_manager_type::MaxPart</a></div><div class="ttdeci">int64_t MaxPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00078">partmanager.h:78</a></div></div>
<div class="ttc" id="asystem_8h_html_abb95c0be39c73f8e6b0978a9a374d92b"><div class="ttname"><a href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a></div><div class="ttdeci">#define MPI_INT64</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00012">system.h:12</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a675acdcd149f5993271a1fdc11673b65"><div class="ttname"><a href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a></div><div class="ttdeci">int NTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a73eab74927dfbb4060edd1ee7f3af699"><div class="ttname"><a href="test__exchange_8c.html#a73eab74927dfbb4060edd1ee7f3af699">TotNumPart</a></div><div class="ttdeci">int TotNumPart</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00024">test_exchange.c:24</a></div></div>
<div class="ttc" id="azeldovich_8c_html_a953067f6751c09a3d2e7554c74fcbf6d"><div class="ttname"><a href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a></div><div class="ttdeci">static enum TransferType ptype</div><div class="ttdef"><b>Definition:</b> <a href="zeldovich_8c_source.html#l00113">zeldovich.c:146</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="petaio_8h_source.html#l00028">header_data::BoxSize</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="partmanager_8h_source.html#l00078">part_manager_type::MaxPart</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="system_8h_source.html#l00012">MPI_INT64</a>, <a class="el" href="petaio_8h_source.html#l00016">header_data::NLocal</a>, <a class="el" href="test__exchange_8c_source.html#l00023">NTask</a>, <a class="el" href="petaio_8h_source.html#l00018">header_data::NTotal</a>, <a class="el" href="petaio_8h_source.html#l00020">header_data::NTotalInit</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8c_source.html#l00014">particle_alloc_memory()</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="zeldovich_8c_source.html#l00146">ptype</a>, <a class="el" href="slotsmanager_8c_source.html#l00475">slots_reserve()</a>, <a class="el" href="slotsmanager_8c_source.html#l00624">slots_setup_topology()</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>, and <a class="el" href="test__exchange_8c_source.html#l00024">TotNumPart</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_abd80f353bfe842a89d201ba9b81f7f1a_cgraph.svg" width="786" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_abd80f353bfe842a89d201ba9b81f7f1a_icgraph.svg" width="456" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aefa558832e90f57e2c3785480ebbea3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa558832e90f57e2c3785480ebbea3e">&#9670;&nbsp;</a></span>init_timeline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_timeline </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>RestartSnapNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TimeMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structheader__data.html">header_data</a> *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>SnapshotWithFOF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00056">56</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/*Add TimeInit and TimeMax to the output list*/</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (RestartSnapNum &lt; 0) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">/* allow a first snapshot at IC time; */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="timebinmgr_8c.html#ac7b147294398226944c4cc699fa6f34b">setup_sync_points</a>(header-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, TimeMax, 0.0, SnapshotWithFOF);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* skip dumping the exactly same snapshot */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="timebinmgr_8c.html#ac7b147294398226944c4cc699fa6f34b">setup_sync_points</a>(header-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, TimeMax, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, SnapshotWithFOF);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">/* If TimeInit is not in a sensible place on the integer timeline</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">         * (can happen if the outputs changed since it was written)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">         * start the integer timeline anew from TimeInit */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> ti_init = <a class="code" href="timebinmgr_8c.html#a2e2b7b549c7ebcd90457efb5330c1955">ti_from_loga</a>(log(header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>)) % <a class="code" href="timebinmgr_8h.html#ad44dabdb7a0bef8536e2d34a01177d48">TIMEBASE</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="timebinmgr_8c.html#a670638d37437095012fe1effdc9c1098">round_down_power_of_two</a>(ti_init) != ti_init) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0,<span class="stringliteral">&quot;Resetting integer timeline (as %x != %x) to current snapshot\n&quot;</span>,ti_init, <a class="code" href="timebinmgr_8c.html#a670638d37437095012fe1effdc9c1098">round_down_power_of_two</a>(ti_init));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="timebinmgr_8c.html#ac7b147294398226944c4cc699fa6f34b">setup_sync_points</a>(header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, TimeMax, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, SnapshotWithFOF);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="ttc" id="astructheader__data_html_a0c7b9fa17aae847e0943fca860b433b8"><div class="ttname"><a href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">header_data::TimeIC</a></div><div class="ttdeci">double TimeIC</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00024">petaio.h:24</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a2e2b7b549c7ebcd90457efb5330c1955"><div class="ttname"><a href="timebinmgr_8c.html#a2e2b7b549c7ebcd90457efb5330c1955">ti_from_loga</a></div><div class="ttdeci">inttime_t ti_from_loga(double loga)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00236">timebinmgr.c:236</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a670638d37437095012fe1effdc9c1098"><div class="ttname"><a href="timebinmgr_8c.html#a670638d37437095012fe1effdc9c1098">round_down_power_of_two</a></div><div class="ttdeci">inttime_t round_down_power_of_two(inttime_t dti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00286">timebinmgr.c:286</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_ac7b147294398226944c4cc699fa6f34b"><div class="ttname"><a href="timebinmgr_8c.html#ac7b147294398226944c4cc699fa6f34b">setup_sync_points</a></div><div class="ttdeci">void setup_sync_points(double TimeIC, double TimeMax, double no_snapshot_until_time, int SnapshotWithFOF)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00097">timebinmgr.c:97</a></div></div>
<div class="ttc" id="atimebinmgr_8h_html_ad44dabdb7a0bef8536e2d34a01177d48"><div class="ttname"><a href="timebinmgr_8h.html#ad44dabdb7a0bef8536e2d34a01177d48">TIMEBASE</a></div><div class="ttdeci">#define TIMEBASE</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00014">timebinmgr.h:14</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="timebinmgr_8c_source.html#l00286">round_down_power_of_two()</a>, <a class="el" href="timebinmgr_8c_source.html#l00097">setup_sync_points()</a>, <a class="el" href="timebinmgr_8c_source.html#l00236">ti_from_loga()</a>, <a class="el" href="timebinmgr_8h_source.html#l00014">TIMEBASE</a>, <a class="el" href="petaio_8h_source.html#l00024">header_data::TimeIC</a>, and <a class="el" href="petaio_8h_source.html#l00026">header_data::TimeSnapshot</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00194">begrun()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_aefa558832e90f57e2c3785480ebbea3e_cgraph.svg" width="630" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_aefa558832e90f57e2c3785480ebbea3e_icgraph.svg" width="332" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a584819ffe166915fdfcf130fa437dccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584819ffe166915fdfcf130fa437dccf">&#9670;&nbsp;</a></span>set_init_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_init_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParameterSet.html">ParameterSet</a> *&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00045">45</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">InitGasTemp</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;InitGasTemp&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a5fe84408a7e569955057e00c7dab8eb1">PartAllocFactor</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;PartAllocFactor&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    MPI_Bcast(&amp;<a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>, <span class="keyword">sizeof</span>(<a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="astructinit__params_html_a4afac4deb8f9b8cc699294d37f337e6f"><div class="ttname"><a href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">init_params::InitGasTemp</a></div><div class="ttdeci">double InitGasTemp</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00036">init.c:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="init_8c_source.html#l00036">init_params::InitGasTemp</a>, <a class="el" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>, <a class="el" href="paramset_8c_source.html#l00336">param_get_double()</a>, <a class="el" href="init_8c_source.html#l00040">init_params::PartAllocFactor</a>, and <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="gadget_2params_8c_source.html#l00359">read_parameter_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a584819ffe166915fdfcf130fa437dccf_cgraph.svg" width="795" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a584819ffe166915fdfcf130fa437dccf_icgraph.svg" width="442" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af35b2ff44ee11141241741fa051ad2ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af35b2ff44ee11141241741fa051ad2ac">&#9670;&nbsp;</a></span>setup_density_indep_entropy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setup_density_indep_entropy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structForceTree.html">ForceTree</a> *&#160;</td>
          <td class="paramname"><em>Tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *&#160;</td>
          <td class="paramname"><em>sph_pred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u_init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackHoleOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a>&#160;</td>
          <td class="paramname"><em>Ti_Current</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00384">384</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">int</span> stop = 0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Converting u -&gt; entropy, with density split sph\n&quot;</span>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">/* This gives better convergence than initializing EgyWtDensity before Density is known*/</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>; j++)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[j].EgyWtDensity = <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[j].Density;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * olddensity = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *)<a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;olddensity &quot;</span>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; 100; j++)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">/* since ICs give energies, not entropies, need to iterate get this initialized correctly */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>; i++) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Entropy = <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a> * u_init / pow(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity / a3 , <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            olddensity[i] = <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">/* Empty kick factors as we do not move*/</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="structDriftKickTimes.html">DriftKickTimes</a> times = <a class="code" href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a>(Ti_Current);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">/* Update the EgyWtDensity*/</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>(act, 0, <a class="code" href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a>(), BlackHoleOn, 0,  times, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, sph_pred, NULL, Tree);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span>(stop)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordtype">double</span> maxdiff = 0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">        #pragma omp parallel for reduction(max: maxdiff)</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>; i++) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordtype">double</span> value = fabs(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity - olddensity[i]) / <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].EgyWtDensity;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            maxdiff = <a class="code" href="test__interp_8c.html#ac06514a27a2843d8325c1e46ad595b39">DMAX</a>(maxdiff,value);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, &amp;maxdiff, 1, MPI_DOUBLE, MPI_MAX, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;iteration %d, max relative change in EgyWtDensity = %g \n&quot;</span>, j, maxdiff);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">/* If maxdiff is small, do one more iteration and stop*/</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">if</span>(maxdiff &lt; 1e-3)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            stop = 1;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(olddensity);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_ac49d34dfc3f4e37cac0953d5bc1417a4"><div class="ttname"><a href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a></div><div class="ttdeci">void density(const ActiveParticles *act, int update_hsml, int DoEgyDensity, int BlackHoleOn, double MinEgySpec, const DriftKickTimes times, Cosmology *CP, struct sph_pred_data *SPH_predicted, MyFloat *GradRho, const ForceTree *const tree)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00203">density.c:203</a></div></div>
<div class="ttc" id="ahydra_8c_html_ad2e04e2dce31315c1541bbea55f33d2a"><div class="ttname"><a href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a></div><div class="ttdeci">int DensityIndependentSphOn(void)</div><div class="ttdef"><b>Definition:</b> <a href="hydra_8c_source.html#l00049">hydra.c:49</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html"><div class="ttname"><a href="structDriftKickTimes.html">DriftKickTimes</a></div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00017">timestep.h:18</a></div></div>
<div class="ttc" id="atest__interp_8c_html_ac06514a27a2843d8325c1e46ad595b39"><div class="ttname"><a href="test__interp_8c.html#ac06514a27a2843d8325c1e46ad595b39">DMAX</a></div><div class="ttdeci">#define DMAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="test__interp_8c_source.html#l00011">test_interp.c:11</a></div></div>
<div class="ttc" id="atimestep_8c_html_a46b8fcbd4991e9d216fc8825d5bdfb36"><div class="ttname"><a href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a></div><div class="ttdeci">DriftKickTimes init_driftkicktime(inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00133">timestep.c:133</a></div></div>
<div class="ttc" id="atypes_8h_html_af1ada7381a1118c6d51bdbb0b5e72811"><div class="ttname"><a href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a></div><div class="ttdeci">LOW_PRECISION MyFloat</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00019">types.h:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="hydra_8c_source.html#l00049">DensityIndependentSphOn()</a>, <a class="el" href="test__interp_8c_source.html#l00011">DMAX</a>, <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="timestep_8c_source.html#l00133">init_driftkicktime()</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, and <a class="el" href="slotsmanager_8h_source.html#l00119">SphP</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_af35b2ff44ee11141241741fa051ad2ac_cgraph.svg" width="1880" height="1648"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_af35b2ff44ee11141241741fa051ad2ac_icgraph.svg" width="615" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a713a74e1e0ca55699bc6581763bae177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a713a74e1e0ca55699bc6581763bae177">&#9670;&nbsp;</a></span>setup_smoothinglengths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_smoothinglengths </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>RestartSnapNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDomainDecomp.html">DomainDecomp</a> *&#160;</td>
          <td class="paramname"><em>ddecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackHoleOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>uu_in_cgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a>&#160;</td>
          <td class="paramname"><em>Ti_Current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t&#160;</td>
          <td class="paramname"><em>NTotGasInit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to find an initial smoothing length and initial entropy for each SPH particle. Entropies are set using the initial gas temperature. It guarantees that the number of neighbours will be between desired_ngb-MAXDEV and desired_ngb+MAXDEV. For simplicity, a first guess of the smoothing length is provided to the function <a class="el" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density()</a>, which will then iterate if needed to find the right smoothing length. </p>

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00439">439</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> a3 = pow(atime, 3);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span>(RestartSnapNum &gt;= 0)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">InitGasTemp</a> &lt; 0)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">InitGasTemp</a> = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">CMBTemperature</a> / atime;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> MeanGasSeparation = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> / pow(NTotGasInit, 1.0 / 3);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    int64_t tot_sph, tot_bh;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    MPI_Allreduce(&amp;<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>, &amp;tot_sph, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    MPI_Allreduce(&amp;<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[5].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>, &amp;tot_bh, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">/* Do nothing if we are a pure DM run*/</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span>(tot_sph + tot_bh == 0)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="structForceTree.html">ForceTree</a> Tree = {0};</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">/* Need moments because we use them to set Hsml*/</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a>(&amp;Tree, ddecomp, 0, 1, NULL);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">/* quick hack to adjust for the baryon fraction</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">        * only this fraction of mass is of that type.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">        * this won&#39;t work for non-dm non baryon;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">        * ideally each node shall have separate count of</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">        * ptypes of each type.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">        *</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">        * Eventually the iteration will fix this. */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> massfactor = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> / <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DesNumNgb = <a class="code" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a>(<a class="code" href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a>());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">/* These initial smoothing lengths are only used for SPH-like particles.*/</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type != 0 &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type != 5)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordtype">int</span> no = <a class="code" href="forcetree_8c.html#ab8a2310bd448851f4aa42ae6bcec2e01">force_get_father</a>(i, &amp;Tree);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">while</span>(10 * DesNumNgb * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass &gt; massfactor * Tree.<a class="code" href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">Nodes</a>[no].<a class="code" href="structNODE.html#a14f3123f334264157f4b2e74828cc644">mom</a>.<a class="code" href="structNODE.html#a5f599abbea1f0fc03e09d98232c740a8">mass</a>)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordtype">int</span> p = <a class="code" href="forcetree_8c.html#ab8a2310bd448851f4aa42ae6bcec2e01">force_get_father</a>(no, &amp;Tree);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">if</span>(p &lt; 0)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            no = p;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml =</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            pow(3.0 / (4 * M_PI) * DesNumNgb * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass / (massfactor * Tree.<a class="code" href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">Nodes</a>[no].<a class="code" href="structNODE.html#a14f3123f334264157f4b2e74828cc644">mom</a>.<a class="code" href="structNODE.html#a5f599abbea1f0fc03e09d98232c740a8">mass</a>),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    1.0 / 3) * Tree.<a class="code" href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">Nodes</a>[no].<a class="code" href="structNODE.html#ae6d6383dc0bc3e1660bbe700b77a85ab">len</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">/* recover from a poor initial guess */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &gt; 500.0 * MeanGasSeparation)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml = MeanGasSeparation;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml &lt;= 0)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(5, <span class="stringliteral">&quot;Bad hsml guess: i=%d, mass = %g type %d hsml %g no %d len %d treemass %g\n&quot;</span>,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    i, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Mass, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Hsml, no, Tree.<a class="code" href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">Nodes</a>[no].<a class="code" href="structNODE.html#ae6d6383dc0bc3e1660bbe700b77a85ab">len</a>, Tree.<a class="code" href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">Nodes</a>[no].<a class="code" href="structNODE.html#a14f3123f334264157f4b2e74828cc644">mom</a>.<a class="code" href="structNODE.html#a5f599abbea1f0fc03e09d98232c740a8">mass</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">/* for clean IC with U input only, we need to iterate to find entropy */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">double</span> u_init = (1.0 / <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>) * (<a class="code" href="physconst_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a> / <a class="code" href="physconst_8h.html#a7e6cfbe5535ec2470a672abeba3fcd4d">PROTONMASS</a>) * <a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">InitGasTemp</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    u_init /= uu_in_cgs; <span class="comment">/* unit conversion */</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">double</span> molecular_weight;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>.<a class="code" href="structinit__params.html#a4afac4deb8f9b8cc699294d37f337e6f">InitGasTemp</a> &gt; 1.0e4)  <span class="comment">/* assuming FULL ionization */</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        molecular_weight = 4 / (8 - 5 * (1 - <a class="code" href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a>));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">else</span>                <span class="comment">/* assuming NEUTRAL GAS */</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        molecular_weight = 4 / (1 + 3 * <a class="code" href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    u_init /= molecular_weight;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span>(u_init &lt; MinEgySpec)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        u_init = MinEgySpec;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">/* snapshot already has EgyWtDensity; hope it is read in correctly.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">        * (need a test on this!) */</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">/*Allocate the extra SPH data for transient SPH particle properties.*/</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> sph_pred = <a class="code" href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a>(<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">/*At the first time step all particles should be active*/</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="structActiveParticles.html">ActiveParticles</a> act = {0};</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    act.<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> = NULL;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    act.<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">/* Empty kick factors as we do not move*/</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="structDriftKickTimes.html">DriftKickTimes</a> times = <a class="code" href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a>(Ti_Current);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>(&amp;act, 1, 0, BlackHoleOn, 0,  times, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, &amp;sph_pred, NULL, &amp;Tree);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a>()) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="init_8c.html#af35b2ff44ee11141241741fa051ad2ac">setup_density_indep_entropy</a>(&amp;act, &amp;Tree, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, &amp;sph_pred, u_init, a3, Ti_Current, BlackHoleOn);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">/*Initialize to initial energy*/</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>; i++)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Entropy = <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a> * u_init / pow(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[i].Density / a3 , <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a>(&amp;sph_pred);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;Tree);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_a23e510a287a10de773a4a0f14db2ff52"><div class="ttname"><a href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a></div><div class="ttdeci">double GetNumNgb(enum DensityKernelType KernelType)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:55</a></div></div>
<div class="ttc" id="adensity_8c_html_a6af534268ae11ed2bad17f5300af23bc"><div class="ttname"><a href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a></div><div class="ttdeci">struct sph_pred_data slots_allocate_sph_pred_data(int nsph)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00554">density.c:654</a></div></div>
<div class="ttc" id="adensity_8c_html_ab4c7ec2e7345138dfdd37b64f3f4554a"><div class="ttname"><a href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a></div><div class="ttdeci">void slots_free_sph_pred_data(struct sph_pred_data *sph_scratch)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00665">density.c:665</a></div></div>
<div class="ttc" id="adensity_8c_html_ac40e53af730ce9956d564e3dc18d6f0e"><div class="ttname"><a href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a></div><div class="ttdeci">enum DensityKernelType GetDensityKernelType(void)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:63</a></div></div>
<div class="ttc" id="aforcetree_8c_html_a5156dae3aae56140d6e9ae0ab58867cc"><div class="ttname"><a href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a></div><div class="ttdeci">void force_tree_rebuild(ForceTree *tree, DomainDecomp *ddecomp, const int HybridNuGrav, const int DoMoments, const char *EmergencyOutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00140">forcetree.c:140</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aaa26dfea4b696133a8bc35c5e0c56037"><div class="ttname"><a href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a></div><div class="ttdeci">void force_tree_free(ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l01409">forcetree.c:1409</a></div></div>
<div class="ttc" id="aforcetree_8c_html_ab8a2310bd448851f4aa42ae6bcec2e01"><div class="ttname"><a href="forcetree_8c.html#ab8a2310bd448851f4aa42ae6bcec2e01">force_get_father</a></div><div class="ttdeci">int force_get_father(int no, const ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00905">forcetree.c:905</a></div></div>
<div class="ttc" id="ainit_8c_html_af35b2ff44ee11141241741fa051ad2ac"><div class="ttname"><a href="init_8c.html#af35b2ff44ee11141241741fa051ad2ac">setup_density_indep_entropy</a></div><div class="ttdeci">static void setup_density_indep_entropy(const ActiveParticles *act, ForceTree *Tree, Cosmology *CP, struct sph_pred_data *sph_pred, double u_init, double a3, int BlackHoleOn, const inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00384">init.c:384</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a7e6cfbe5535ec2470a672abeba3fcd4d"><div class="ttname"><a href="physconst_8h.html#a7e6cfbe5535ec2470a672abeba3fcd4d">PROTONMASS</a></div><div class="ttdeci">#define PROTONMASS</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00021">physconst.h:21</a></div></div>
<div class="ttc" id="aphysconst_8h_html_aa1487dae81baa2e0a5643e7b571633a0"><div class="ttname"><a href="physconst_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a></div><div class="ttdeci">#define BOLTZMANN</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00011">physconst.h:11</a></div></div>
<div class="ttc" id="astructActiveParticles_html"><div class="ttname"><a href="structActiveParticles.html">ActiveParticles</a></div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00009">timestep.h:10</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a1b0b230f3890d70bae976516719b7d07"><div class="ttname"><a href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticles::ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00013">timestep.h:13</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a847ab898fdabc62a4723c7c3a66038d4"><div class="ttname"><a href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">ActiveParticles::NumActiveParticle</a></div><div class="ttdeci">int64_t NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00012">timestep.h:12</a></div></div>
<div class="ttc" id="astructCosmology_html_a62b59388eea6cbc92a29697e2e969b34"><div class="ttname"><a href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">Cosmology::CMBTemperature</a></div><div class="ttdeci">double CMBTemperature</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00009">cosmology.h:9</a></div></div>
<div class="ttc" id="astructForceTree_html"><div class="ttname"><a href="structForceTree.html">ForceTree</a></div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00076">forcetree.h:76</a></div></div>
<div class="ttc" id="astructForceTree_html_abc4bf1553d516b1b9b9c672b0a371bb1"><div class="ttname"><a href="structForceTree.html#abc4bf1553d516b1b9b9c672b0a371bb1">ForceTree::Nodes</a></div><div class="ttdeci">struct NODE * Nodes</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00097">forcetree.h:97</a></div></div>
<div class="ttc" id="astructNODE_html_a14f3123f334264157f4b2e74828cc644"><div class="ttname"><a href="structNODE.html#a14f3123f334264157f4b2e74828cc644">NODE::mom</a></div><div class="ttdeci">struct NODE::@9 mom</div></div>
<div class="ttc" id="astructNODE_html_a5f599abbea1f0fc03e09d98232c740a8"><div class="ttname"><a href="structNODE.html#a5f599abbea1f0fc03e09d98232c740a8">NODE::mass</a></div><div class="ttdeci">MyFloat mass</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00056">forcetree.h:56</a></div></div>
<div class="ttc" id="astructNODE_html_ae6d6383dc0bc3e1660bbe700b77a85ab"><div class="ttname"><a href="structNODE.html#ae6d6383dc0bc3e1660bbe700b77a85ab">NODE::len</a></div><div class="ttdeci">MyFloat len</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00042">forcetree.h:42</a></div></div>
<div class="ttc" id="astructsph__pred__data_html"><div class="ttname"><a href="structsph__pred__data.html">sph_pred_data</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00025">density.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="timestep_8h_source.html#l00013">ActiveParticles::ActiveParticle</a>, <a class="el" href="physconst_8h_source.html#l00011">BOLTZMANN</a>, <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="cosmology_8h_source.html#l00009">Cosmology::CMBTemperature</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="hydra_8c_source.html#l00049">DensityIndependentSphOn()</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="forcetree_8c_source.html#l00905">force_get_father()</a>, <a class="el" href="forcetree_8c_source.html#l01409">force_tree_free()</a>, <a class="el" href="forcetree_8c_source.html#l00140">force_tree_rebuild()</a>, <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, <a class="el" href="density_8c_source.html#l00063">GetDensityKernelType()</a>, <a class="el" href="density_8c_source.html#l00055">GetNumNgb()</a>, <a class="el" href="physconst_8h_source.html#l00037">HYDROGEN_MASSFRAC</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="timestep_8c_source.html#l00133">init_driftkicktime()</a>, <a class="el" href="init_8c_source.html#l00036">init_params::InitGasTemp</a>, <a class="el" href="init_8c.html#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">InitParams</a>, <a class="el" href="forcetree_8h_source.html#l00042">NODE::len</a>, <a class="el" href="forcetree_8h_source.html#l00056">NODE::mass</a>, <a class="el" href="structNODE.html#a14f3123f334264157f4b2e74828cc644">NODE::mom</a>, <a class="el" href="system_8h_source.html#l00012">MPI_INT64</a>, <a class="el" href="forcetree_8h_source.html#l00097">ForceTree::Nodes</a>, <a class="el" href="timestep_8h_source.html#l00012">ActiveParticles::NumActiveParticle</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="cosmology_8h_source.html#l00010">Cosmology::Omega0</a>, <a class="el" href="cosmology_8h_source.html#l00019">Cosmology::OmegaBaryon</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="physconst_8h_source.html#l00021">PROTONMASS</a>, <a class="el" href="init_8c_source.html#l00384">setup_density_indep_entropy()</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="density_8c_source.html#l00654">slots_allocate_sph_pred_data()</a>, <a class="el" href="density_8c_source.html#l00665">slots_free_sph_pred_data()</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, and <a class="el" href="slotsmanager_8h_source.html#l00119">SphP</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00194">begrun()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a713a74e1e0ca55699bc6581763bae177_cgraph.svg" width="1499" height="1878"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="init_8c_a713a74e1e0ca55699bc6581763bae177_icgraph.svg" width="411" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9fe2a6dc59b1a81c3bed6d5b8fe2bb">&#9670;&nbsp;</a></span>InitParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structinit__params.html">init_params</a> InitParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>, <a class="el" href="init_8c_source.html#l00045">set_init_params()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
