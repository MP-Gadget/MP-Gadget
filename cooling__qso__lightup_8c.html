<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/cooling_qso_lightup.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cooling_qso_lightup.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;gsl/gsl_interp.h&gt;</code><br />
<code>#include &quot;<a class="el" href="physconst_8h_source.html">physconst.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slotsmanager_8h_source.html">slotsmanager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="partmanager_8h_source.html">partmanager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="treewalk_8h_source.html">treewalk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hydra_8h_source.html">hydra.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="drift_8h_source.html">drift.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="walltime_8h_source.html">walltime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fof_8h_source.html">fof.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="endrun_8h_source.html">utils/endrun.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="paramset_8h_source.html">utils/paramset.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mymalloc_8h_source.html">utils/mymalloc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cooling__qso__lightup_8h_source.html">cooling_qso_lightup.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cooling_qso_lightup.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c__incl.svg" width="2474" height="799"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="cooling__qso__lightup_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqso__lightup__params.html">qso_lightup_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQSOPriv.html">QSOPriv</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a174ebbd9d6aadb8b70c78ef9a0d74296"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a174ebbd9d6aadb8b70c78ef9a0d74296">E0_HeII</a>&#160;&#160;&#160;54.4 /* HeII ionization potential in eV*/</td></tr>
<tr class="separator:a174ebbd9d6aadb8b70c78ef9a0d74296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2830a4870d926a0ebdf59ef7d285d158"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a2830a4870d926a0ebdf59ef7d285d158">HEMASS</a>&#160;&#160;&#160;4.002602 /* Helium mass in amu*/</td></tr>
<tr class="separator:a2830a4870d926a0ebdf59ef7d285d158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdee6b67b393552cfa2f0fe2a9e96f3c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a>(tw)&#160;&#160;&#160;((struct <a class="el" href="structQSOPriv.html">QSOPriv</a> *) (tw-&gt;priv))</td></tr>
<tr class="separator:afdee6b67b393552cfa2f0fe2a9e96f3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac1b832bc238a16abd63e0a155ebeb604"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ac1b832bc238a16abd63e0a155ebeb604">set_qso_lightup_par</a> (struct <a class="el" href="structqso__lightup__params.html">qso_lightup_params</a> qso)</td></tr>
<tr class="separator:ac1b832bc238a16abd63e0a155ebeb604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb6b3c2677af8f265b3ed07f7c7ec4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a0fb6b3c2677af8f265b3ed07f7c7ec4d">set_qso_lightup_params</a> (<a class="el" href="structParameterSet.html">ParameterSet</a> *ps)</td></tr>
<tr class="separator:a0fb6b3c2677af8f265b3ed07f7c7ec4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b957ce063007c0d5e15fb9ce55792e6"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a0b957ce063007c0d5e15fb9ce55792e6">Q_inst</a> (double Emax, double alpha_q)</td></tr>
<tr class="separator:a0b957ce063007c0d5e15fb9ce55792e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e889225391707117df9040605db0cc2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a1e889225391707117df9040605db0cc2">load_heii_reion_hist</a> (const char *reion_hist_file)</td></tr>
<tr class="separator:a1e889225391707117df9040605db0cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a582d24ae7261aa1e23bd948329237d92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a582d24ae7261aa1e23bd948329237d92">init_qso_lightup</a> (char *reion_hist_file)</td></tr>
<tr class="separator:a582d24ae7261aa1e23bd948329237d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a065e909000614891faf75c8f51596a2a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a065e909000614891faf75c8f51596a2a">get_long_mean_free_path_heating</a> (double redshift)</td></tr>
<tr class="separator:a065e909000614891faf75c8f51596a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d51ddace470d6cfece4f0a24cfacab7"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a4d51ddace470d6cfece4f0a24cfacab7">gaussian_rng</a> (double mu, double <a class="el" href="densitykernel_8c.html#ae1ef058cb2030082c121b8226a7dab57">sigma</a>, const int64_t seed)</td></tr>
<tr class="separator:a4d51ddace470d6cfece4f0a24cfacab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b930690ef2b4a003a7d55756496b133"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a4b930690ef2b4a003a7d55756496b133">build_qso_candidate_list</a> (int **qso_cand, <a class="el" href="structFOFGroups.html">FOFGroups</a> *fof)</td></tr>
<tr class="separator:a4b930690ef2b4a003a7d55756496b133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9538e49bb1669a104f4f04059bcd6ebd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a9538e49bb1669a104f4f04059bcd6ebd">count_QSO_halos</a> (int ncand, int64_t *ncand_tot, MPI_Comm Comm)</td></tr>
<tr class="separator:a9538e49bb1669a104f4f04059bcd6ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a9803be56bee1d25f41403e8c9585f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a73a9803be56bee1d25f41403e8c9585f">choose_QSO_halo</a> (int64_t ncand, int64_t *ncand_before, int64_t *ncand_tot, int64_t randseed)</td></tr>
<tr class="separator:a73a9803be56bee1d25f41403e8c9585f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5740000b165b1b3960c667df61b0415"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ab5740000b165b1b3960c667df61b0415">gas_ionization_fraction</a> (void)</td></tr>
<tr class="separator:ab5740000b165b1b3960c667df61b0415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f6042301b4e31e8d0f9af01590f23c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a84f6042301b4e31e8d0f9af01590f23c">ionize_single_particle</a> (int other, double a3inv, double uu_in_cgs)</td></tr>
<tr class="separator:a84f6042301b4e31e8d0f9af01590f23c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42114e122d3563daef66be9f181eebb2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a42114e122d3563daef66be9f181eebb2">ionize_ngbiter</a> (<a class="el" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a> *I, <a class="el" href="structTreeWalkResultBase.html">TreeWalkResultBase</a> *O, <a class="el" href="structTreeWalkNgbIterBase.html">TreeWalkNgbIterBase</a> *iter, <a class="el" href="structLocalTreeWalk.html">LocalTreeWalk</a> *lv)</td></tr>
<tr class="separator:a42114e122d3563daef66be9f181eebb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32b760cb7dd4dcf046e5357429b5690"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ae32b760cb7dd4dcf046e5357429b5690">ionize_copy</a> (int place, <a class="el" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a> *I, <a class="el" href="structTreeWalk.html">TreeWalk</a> *tw)</td></tr>
<tr class="separator:ae32b760cb7dd4dcf046e5357429b5690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad472e4014433bed14cf81e46a891cd8b"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ad472e4014433bed14cf81e46a891cd8b">ionize_all_part</a> (int qso_ind, int *qso_cand, struct <a class="el" href="structQSOPriv.html">QSOPriv</a> priv, <a class="el" href="structForceTree.html">ForceTree</a> *tree)</td></tr>
<tr class="separator:ad472e4014433bed14cf81e46a891cd8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047bd5886141415004b83a046b49d5cc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a047bd5886141415004b83a046b49d5cc">turn_on_quasars</a> (double atime, <a class="el" href="structFOFGroups.html">FOFGroups</a> *fof, <a class="el" href="structDomainDecomp.html">DomainDecomp</a> *ddecomp, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, double uu_in_cgs, FILE *FdHelium)</td></tr>
<tr class="separator:a047bd5886141415004b83a046b49d5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42cfb86673e895125f77c946b7db8ced"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a42cfb86673e895125f77c946b7db8ced">do_heiii_reionization</a> (double atime, <a class="el" href="structFOFGroups.html">FOFGroups</a> *fof, <a class="el" href="structDomainDecomp.html">DomainDecomp</a> *ddecomp, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, double uu_in_cgs, FILE *FdHelium)</td></tr>
<tr class="separator:a42cfb86673e895125f77c946b7db8ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cde900ae1d3de8cacd08a43caf30dc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a4cde900ae1d3de8cacd08a43caf30dc8">need_change_helium_ionization_fraction</a> (double atime)</td></tr>
<tr class="separator:a4cde900ae1d3de8cacd08a43caf30dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0169ec1bb01295a97a9468d22420b39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#aa0169ec1bb01295a97a9468d22420b39">during_helium_reionization</a> (double redshift)</td></tr>
<tr class="separator:aa0169ec1bb01295a97a9468d22420b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c64156382a9569697615424e60b2efa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a7c64156382a9569697615424e60b2efa">qso_lightup_on</a> (void)</td></tr>
<tr class="separator:a7c64156382a9569697615424e60b2efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab2be45b3f715d30ed52bd9a269187f1b"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structqso__lightup__params.html">qso_lightup_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a></td></tr>
<tr class="separator:ab2be45b3f715d30ed52bd9a269187f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1dd6eff94a6c0891de7a583c145ebad"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#ab1dd6eff94a6c0891de7a583c145ebad">qso_inst_heating</a></td></tr>
<tr class="separator:ab1dd6eff94a6c0891de7a583c145ebad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3903871e92d0cc76d0cd387cbe01aa24"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a></td></tr>
<tr class="separator:a3903871e92d0cc76d0cd387cbe01aa24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0055059157dbe3a3314d66edbb898473"><td class="memItemLeft" align="right" valign="top">static double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a></td></tr>
<tr class="separator:a0055059157dbe3a3314d66edbb898473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e481a81deff64731633abc9a406fce"><td class="memItemLeft" align="right" valign="top">static double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a></td></tr>
<tr class="separator:a21e481a81deff64731633abc9a406fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e3abd53d13b5a970a6aa7d83400e46"><td class="memItemLeft" align="right" valign="top">static double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a></td></tr>
<tr class="separator:a99e3abd53d13b5a970a6aa7d83400e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba681c92b80d6eb9916cf248f61d3a97"><td class="memItemLeft" align="right" valign="top">static gsl_interp *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a></td></tr>
<tr class="separator:aba681c92b80d6eb9916cf248f61d3a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cc09c5c604658b463a1533c2772343"><td class="memItemLeft" align="right" valign="top">static gsl_interp *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a78cc09c5c604658b463a1533c2772343">LMFP_intp</a></td></tr>
<tr class="separator:a78cc09c5c604658b463a1533c2772343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ae1d4c2b773a357ae246ca83fb34f29"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a7ae1d4c2b773a357ae246ca83fb34f29">last_zz</a></td></tr>
<tr class="separator:a7ae1d4c2b773a357ae246ca83fb34f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ae0487022e45dd434433892c36eb26"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling__qso__lightup_8c.html#a28ae0487022e45dd434433892c36eb26">last_long_mfp_heating</a></td></tr>
<tr class="separator:a28ae0487022e45dd434433892c36eb26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a174ebbd9d6aadb8b70c78ef9a0d74296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174ebbd9d6aadb8b70c78ef9a0d74296">&#9670;&nbsp;</a></span>E0_HeII</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define E0_HeII&#160;&#160;&#160;54.4 /* HeII ionization potential in eV*/</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This file implements the quasar heating model of Upton-Sanderbeck et al 2019 (in prep). A black hole particle with the right mass is chosen at random and an ionizing bubble created around it. Particles within that bubble are marked as ionized and heated according to emissivity. New bubbles are created until the total HeIII fraction matches the value in the external table. There is also a uniform background heating rate for long mean-free-path photons with very high energies. This heating is added only to not-yet-ionized particles, and is done in <a class="el" href="cooling__rates_8c.html">cooling_rates.c</a>. Whatever UVB you use should not include these photons.</p>
<p>The text file contains the reionization history and is generated from various physical processes implemented in a python file. The text file fixes the end of helium reionization (which is reasonably well-known). The code has the start time of reionization as a free parameter: if this start of reionization is late then there will be a strong sudden burst of heating.</p>
<p>(Loosely) based on lightup_QSOs.py from <a href="https://github.com/uptonsanderbeck/helium_reionization">https://github.com/uptonsanderbeck/helium_reionization</a> HeII_heating.py contains the details of the reionization history and how it is generated.</p>
<p>This code should run only during a PM timestep, when all particles are active We lose time resolution but I cannot think of another way to ensure cooling is modelled correctly. </p>

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00047">47</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

</div>
</div>
<a id="a2830a4870d926a0ebdf59ef7d285d158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2830a4870d926a0ebdf59ef7d285d158">&#9670;&nbsp;</a></span>HEMASS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HEMASS&#160;&#160;&#160;4.002602 /* Helium mass in amu*/</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00048">48</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

</div>
</div>
<a id="afdee6b67b393552cfa2f0fe2a9e96f3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdee6b67b393552cfa2f0fe2a9e96f3c">&#9670;&nbsp;</a></span>QSO_GET_PRIV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QSO_GET_PRIV</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tw</td><td>)</td>
          <td>&#160;&#160;&#160;((struct <a class="el" href="structQSOPriv.html">QSOPriv</a> *) (tw-&gt;priv))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00413">413</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4b930690ef2b4a003a7d55756496b133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b930690ef2b4a003a7d55756496b133">&#9670;&nbsp;</a></span>build_qso_candidate_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_qso_candidate_list </td>
          <td>(</td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>qso_cand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00282">282</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">/*Loop over all halos, building the candidate list.*/</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">int</span> i, ncand=0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    *qso_cand = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;Quasar_candidates&quot;</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * (fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>+1));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>; i++)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">/* Check that it has the right mass*/</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span>(fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#ae5e53fabd8ee14e6d5d241cbeead40fd">Mass</a> &lt; <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a7f3a4d601de7020bb6196afb789730c7">qso_candidate_min_mass</a>)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span>(fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#ae5e53fabd8ee14e6d5d241cbeead40fd">Mass</a> &gt; <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#aa652235159ac664e3db215188433b812">qso_candidate_max_mass</a>)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">/*Add to the candidate list*/</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        (*qso_cand)[ncand] = i;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        ncand++;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">/*Poison value at the end for safety.*/</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    (*qso_cand)[ncand] = -1;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    *qso_cand = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#a81d253773ecedbda7d865554e707489f">myrealloc</a>(*qso_cand, (ncand+1) * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> ncand;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_ab2be45b3f715d30ed52bd9a269187f1b"><div class="ttname"><a href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a></div><div class="ttdeci">static struct qso_lightup_params QSOLightupParams</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00001">cooling_qso_lightup.c:73</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a81d253773ecedbda7d865554e707489f"><div class="ttname"><a href="mymalloc_8h.html#a81d253773ecedbda7d865554e707489f">myrealloc</a></div><div class="ttdeci">#define myrealloc(ptr, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00018">mymalloc.h:18</a></div></div>
<div class="ttc" id="astructFOFGroups_html_a2d0285df13a54af4ca09a6eaf28ea4b1"><div class="ttname"><a href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">FOFGroups::Group</a></div><div class="ttdeci">struct Group * Group</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00063">fof.h:63</a></div></div>
<div class="ttc" id="astructFOFGroups_html_a457c36ab779b7af5964a3534cd238ab6"><div class="ttname"><a href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">FOFGroups::Ngroups</a></div><div class="ttdeci">int Ngroups</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00066">fof.h:66</a></div></div>
<div class="ttc" id="astructGroup_html_ae5e53fabd8ee14e6d5d241cbeead40fd"><div class="ttname"><a href="structGroup.html#ae5e53fabd8ee14e6d5d241cbeead40fd">Group::Mass</a></div><div class="ttdeci">double Mass</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00031">fof.h:31</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_a7f3a4d601de7020bb6196afb789730c7"><div class="ttname"><a href="structqso__lightup__params.html#a7f3a4d601de7020bb6196afb789730c7">qso_lightup_params::qso_candidate_min_mass</a></div><div class="ttdeci">double qso_candidate_min_mass</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00061">cooling_qso_lightup.c:61</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_aa652235159ac664e3db215188433b812"><div class="ttname"><a href="structqso__lightup__params.html#aa652235159ac664e3db215188433b812">qso_lightup_params::qso_candidate_max_mass</a></div><div class="ttdeci">double qso_candidate_max_mass</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00063">cooling_qso_lightup.c:63</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="fof_8h_source.html#l00031">Group::Mass</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="mymalloc_8h_source.html#l00018">myrealloc</a>, <a class="el" href="fof_8h_source.html#l00066">FOFGroups::Ngroups</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00063">qso_lightup_params::qso_candidate_max_mass</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00061">qso_lightup_params::qso_candidate_min_mass</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a4b930690ef2b4a003a7d55756496b133_icgraph.svg" width="770" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a73a9803be56bee1d25f41403e8c9585f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a9803be56bee1d25f41403e8c9585f">&#9670;&nbsp;</a></span>choose_QSO_halo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int choose_QSO_halo </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>ncand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>ncand_before</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>ncand_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>randseed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00340">340</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">double</span> drand = <a class="code" href="system_8c.html#a14a8799b5e9e58e14107bad2fadc7e06">get_random_number</a>(randseed);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    int64_t qso = drand * (*ncand_tot);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    (*ncand_tot)--;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">/* No quasar on this processor*/</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span>(qso &lt; *ncand_before)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        (*ncand_before)--;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span>(qso &lt; *ncand_before || qso &gt;= *ncand_before + ncand)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">/* If the quasar is on this processor, return the</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">     * index of the quasar in the current candidate array.*/</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> qso - *ncand_before;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="ttc" id="asystem_8c_html_a14a8799b5e9e58e14107bad2fadc7e06"><div class="ttname"><a href="system_8c.html#a14a8799b5e9e58e14107bad2fadc7e06">get_random_number</a></div><div class="ttdeci">double get_random_number(uint64_t id)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00060">system.c:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_8c_source.html#l00060">get_random_number()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a73a9803be56bee1d25f41403e8c9585f_cgraph.svg" width="355" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a73a9803be56bee1d25f41403e8c9585f_icgraph.svg" width="726" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9538e49bb1669a104f4f04059bcd6ebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9538e49bb1669a104f4f04059bcd6ebd">&#9670;&nbsp;</a></span>count_QSO_halos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int count_QSO_halos </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>ncand_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00309">309</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    int64_t ncand_total = 0, ncand_before = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>, i, <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    MPI_Comm_size(Comm, &amp;<a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    MPI_Comm_rank(Comm, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">int</span> * candcounts = (<span class="keywordtype">int</span>*) <a class="code" href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a>(<span class="stringliteral">&quot;qso_cand_counts&quot;</span>, <span class="keywordtype">int</span>, <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">/* Get how many candidates are on each processor. TODO: Make a generic MPIU for this.*/</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    MPI_Allgather(&amp;ncand, 1, MPI_INT, candcounts, 1, MPI_INT, Comm);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>; i++)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span>(i &lt; <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            ncand_before += candcounts[i];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        ncand_total += candcounts[i];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a>(candcounts);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    *ncand_tot = ncand_total;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> ncand_before;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="ttc" id="amymalloc_8h_html_a52bc2c6ec78b17bb6d42957cbf642f15"><div class="ttname"><a href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a></div><div class="ttdeci">#define ta_malloc(name, type, nele)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00025">mymalloc.h:25</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a84e2115e90e9c22e11d9663c019fc8bc"><div class="ttname"><a href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a></div><div class="ttdeci">#define ta_free(p)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00028">mymalloc.h:28</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a675acdcd149f5993271a1fdc11673b65"><div class="ttname"><a href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a></div><div class="ttdeci">int NTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="test__exchange_8c_source.html#l00023">NTask</a>, <a class="el" href="mymalloc_8h_source.html#l00028">ta_free</a>, <a class="el" href="mymalloc_8h_source.html#l00025">ta_malloc</a>, and <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a9538e49bb1669a104f4f04059bcd6ebd_icgraph.svg" width="722" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a42cfb86673e895125f77c946b7db8ced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42cfb86673e895125f77c946b7db8ced">&#9670;&nbsp;</a></span>do_heiii_reionization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void do_heiii_reionization </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDomainDecomp.html">DomainDecomp</a> *&#160;</td>
          <td class="paramname"><em>ddecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>uu_in_cgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>FdHelium</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00640">640</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a>)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span>(atime &lt; 1/(1+<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#af1cdcf224afad7f141497024457c767b">heIIIreion_start</a>))</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">/* Do nothing if we are past the end of the table.*/</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span>(atime &gt; <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>-1])</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">//message(0, &quot;HeII: Reionization initiated.\n&quot;);</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a047bd5886141415004b83a046b49d5cc">turn_on_quasars</a>(atime, fof, ddecomp, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, uu_in_cgs, FdHelium);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a0055059157dbe3a3314d66edbb898473"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a></div><div class="ttdeci">static double * He_zz</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00081">cooling_qso_lightup.c:81</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a047bd5886141415004b83a046b49d5cc"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a047bd5886141415004b83a046b49d5cc">turn_on_quasars</a></div><div class="ttdeci">static void turn_on_quasars(double atime, FOFGroups *fof, DomainDecomp *ddecomp, Cosmology *CP, double uu_in_cgs, FILE *FdHelium)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00520">cooling_qso_lightup.c:520</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a3903871e92d0cc76d0cd387cbe01aa24"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a></div><div class="ttdeci">static int Nreionhist</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00080">cooling_qso_lightup.c:80</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_a0106659300d9a6ca5066ea62d41397de"><div class="ttname"><a href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">qso_lightup_params::QSOLightupOn</a></div><div class="ttdeci">int QSOLightupOn</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00059">cooling_qso_lightup.c:59</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_af1cdcf224afad7f141497024457c767b"><div class="ttname"><a href="structqso__lightup__params.html#af1cdcf224afad7f141497024457c767b">qso_lightup_params::heIIIreion_start</a></div><div class="ttdeci">double heIIIreion_start</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00070">cooling_qso_lightup.c:70</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00408">QSOPriv::fof</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00070">qso_lightup_params::heIIIreion_start</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00080">Nreionhist</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00411">QSOPriv::uu_in_cgs</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a42cfb86673e895125f77c946b7db8ced_cgraph.svg" width="1763" height="1760"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a42cfb86673e895125f77c946b7db8ced_icgraph.svg" width="362" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa0169ec1bb01295a97a9468d22420b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0169ec1bb01295a97a9468d22420b39">&#9670;&nbsp;</a></span>during_helium_reionization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int during_helium_reionization </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>redshift</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00667">667</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a>)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span>(redshift &gt; <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#af1cdcf224afad7f141497024457c767b">heIIIreion_start</a>)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">/* Past the end of the table, it has finished.*/</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span>(redshift &lt; 1./<a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>-1] - 1)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00070">qso_lightup_params::heIIIreion_start</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00080">Nreionhist</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_aa0169ec1bb01295a97a9468d22420b39_icgraph.svg" width="403" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab5740000b165b1b3960c667df61b0415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5740000b165b1b3960c667df61b0415">&#9670;&nbsp;</a></span>gas_ionization_fraction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double gas_ionization_fraction </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00359">359</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    int64_t n_ionized_tot = 0, n_gas_tot = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">int</span> i, n_ionized = 0;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+:n_ionized)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++){</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 0 &amp;&amp; <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].HeIIIionized == 1){</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            n_ionized ++;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">/* Get total ionization fraction: note this is only the current gas particles.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     * Particles that become stars are not counted.*/</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a>(1, &amp;n_ionized, &amp;n_ionized_tot);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    MPI_Allreduce(&amp;<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>, &amp;n_gas_tot, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) n_ionized_tot / (double) n_gas_tot;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
<div class="ttc" id="asystem_8c_html_a866c4b0425665030c89933c11752b1fe"><div class="ttname"><a href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a></div><div class="ttdeci">void sumup_large_ints(int n, int *src, int64_t *res)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00192">system.c:192</a></div></div>
<div class="ttc" id="asystem_8h_html_abb95c0be39c73f8e6b0978a9a374d92b"><div class="ttname"><a href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a></div><div class="ttdeci">#define MPI_INT64</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00012">system.h:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="system_8h_source.html#l00012">MPI_INT64</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, and <a class="el" href="system_8c_source.html#l00192">sumup_large_ints()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00657">need_change_helium_ionization_fraction()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_ab5740000b165b1b3960c667df61b0415_cgraph.svg" width="370" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_ab5740000b165b1b3960c667df61b0415_icgraph.svg" width="763" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4d51ddace470d6cfece4f0a24cfacab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d51ddace470d6cfece4f0a24cfacab7">&#9670;&nbsp;</a></span>gaussian_rng()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double gaussian_rng </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00271">271</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">double</span> u1 = <a class="code" href="system_8c.html#a14a8799b5e9e58e14107bad2fadc7e06">get_random_number</a>(seed);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> u2 = <a class="code" href="system_8c.html#a14a8799b5e9e58e14107bad2fadc7e06">get_random_number</a>(seed + 1);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">double</span> z1 = sqrt(-2 * log(u1) ) * cos(2 * M_PI * u2);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> mu + <a class="code" href="densitykernel_8c.html#ae1ef058cb2030082c121b8226a7dab57">sigma</a> * z1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="adensitykernel_8c_html_ae1ef058cb2030082c121b8226a7dab57"><div class="ttname"><a href="densitykernel_8c.html#ae1ef058cb2030082c121b8226a7dab57">sigma</a></div><div class="ttdeci">double sigma[3]</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00097">densitykernel.c:97</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_8c_source.html#l00060">get_random_number()</a>, and <a class="el" href="densitykernel_8c_source.html#l00097">sigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00419">ionize_ngbiter()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a4d51ddace470d6cfece4f0a24cfacab7_cgraph.svg" width="324" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a4d51ddace470d6cfece4f0a24cfacab7_icgraph.svg" width="1023" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a065e909000614891faf75c8f51596a2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a065e909000614891faf75c8f51596a2a">&#9670;&nbsp;</a></span>get_long_mean_free_path_heating()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_long_mean_free_path_heating </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>redshift</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">249</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a>)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span>(redshift &gt; <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#af1cdcf224afad7f141497024457c767b">heIIIreion_start</a>)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span>(redshift == <a class="code" href="cooling__qso__lightup_8c.html#a7ae1d4c2b773a357ae246ca83fb34f29">last_zz</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cooling__qso__lightup_8c.html#a28ae0487022e45dd434433892c36eb26">last_long_mfp_heating</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">double</span> atime = 1/(1+redshift);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">/* Guard against the end of the table*/</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span>(atime &gt; <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>-1])</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">double</span> long_mfp_heating = gsl_interp_eval(<a class="code" href="cooling__qso__lightup_8c.html#a78cc09c5c604658b463a1533c2772343">LMFP_intp</a>, <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, <a class="code" href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a>, atime, NULL);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a7ae1d4c2b773a357ae246ca83fb34f29">last_zz</a> = redshift;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a28ae0487022e45dd434433892c36eb26">last_long_mfp_heating</a> = long_mfp_heating;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> long_mfp_heating;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a28ae0487022e45dd434433892c36eb26"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a28ae0487022e45dd434433892c36eb26">last_long_mfp_heating</a></div><div class="ttdeci">static double last_long_mfp_heating</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00245">cooling_qso_lightup.c:245</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a78cc09c5c604658b463a1533c2772343"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a78cc09c5c604658b463a1533c2772343">LMFP_intp</a></div><div class="ttdeci">static gsl_interp * LMFP_intp</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00085">cooling_qso_lightup.c:85</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a7ae1d4c2b773a357ae246ca83fb34f29"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a7ae1d4c2b773a357ae246ca83fb34f29">last_zz</a></div><div class="ttdeci">static double last_zz</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00244">cooling_qso_lightup.c:244</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a99e3abd53d13b5a970a6aa7d83400e46"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a></div><div class="ttdeci">static double * LMFP</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00083">cooling_qso_lightup.c:83</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00070">qso_lightup_params::heIIIreion_start</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00245">last_long_mfp_heating</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00244">last_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00083">LMFP</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00085">LMFP_intp</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00080">Nreionhist</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling_8c_source.html#l00057">get_lambdanet()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a065e909000614891faf75c8f51596a2a_icgraph.svg" width="1096" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a582d24ae7261aa1e23bd948329237d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a582d24ae7261aa1e23bd948329237d92">&#9670;&nbsp;</a></span>init_qso_lightup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_qso_lightup </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>reion_hist_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00238">238</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#a1e889225391707117df9040605db0cc2">load_heii_reion_hist</a>(reion_hist_file);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a1e889225391707117df9040605db0cc2"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a1e889225391707117df9040605db0cc2">load_heii_reion_hist</a></div><div class="ttdeci">static void load_heii_reion_hist(const char *reion_hist_file)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00137">cooling_qso_lightup.c:137</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling_8c_source.html#l00036">init_cooling()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a582d24ae7261aa1e23bd948329237d92_cgraph.svg" width="755" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a582d24ae7261aa1e23bd948329237d92_icgraph.svg" width="707" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad472e4014433bed14cf81e46a891cd8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad472e4014433bed14cf81e46a891cd8b">&#9670;&nbsp;</a></span>ionize_all_part()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t ionize_all_part </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qso_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qso_cand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structQSOPriv.html">QSOPriv</a>&#160;</td>
          <td class="paramname"><em>priv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structForceTree.html">ForceTree</a> *&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00473">473</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">/* This treewalk finds not yet ionized particles within the radius of the black hole, ionizes them and</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     * adds an instantaneous heating to them. */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="structTreeWalk.html">TreeWalk</a> tw[1] = {{0}};</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">ev_label</a> = <span class="stringliteral">&quot;HELIUM&quot;</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">/* This could select the black holes to be made quasars, but we do it below.*/</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">haswork</a> = NULL;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a> = tree;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">/* We set Hsml to a constant in ngbiter, so this</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">     * searches a constant distance from the halo.*/</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">visit</a> = (<a class="code" href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a>) <a class="code" href="treewalk_8c.html#a145aa9608fd3824bec8049ee97da1c6f">treewalk_visit_ngbiter</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">ngbiter_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkNgbIterBase.html">TreeWalkNgbIterBase</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">ngbiter</a> = (<a class="code" href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a>) <a class="code" href="cooling__qso__lightup_8c.html#a42114e122d3563daef66be9f181eebb2">ionize_ngbiter</a>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">fill</a> = (<a class="code" href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a>) <a class="code" href="cooling__qso__lightup_8c.html#ae32b760cb7dd4dcf046e5357429b5690">ionize_copy</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">reduce</a> = NULL;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">postprocess</a> = NULL;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">query_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">result_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkResultBase.html">TreeWalkResultBase</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    priv.<a class="code" href="structQSOPriv.html#a4e42e9152db40f5f0cfac8aa7053e280">N_ionized</a> = <a class="code" href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a>(<span class="stringliteral">&quot;n_ionized&quot;</span>, int64_t, omp_get_max_threads());</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    memset(priv.<a class="code" href="structQSOPriv.html#a4e42e9152db40f5f0cfac8aa7053e280">N_ionized</a>, 0, <span class="keyword">sizeof</span>(int64_t) * omp_get_max_threads());</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">priv</a> = &amp;priv;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/* This runs only on one BH*/</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span>(qso_ind &gt; 0)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="treewalk_8c.html#a1e336844d7f92d15cd9248c81ecfb453">treewalk_run</a>(tw, &amp;qso_cand[qso_ind], 1);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="treewalk_8c.html#a1e336844d7f92d15cd9248c81ecfb453">treewalk_run</a>(tw, NULL, 0);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    int64_t N_ionized = 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; omp_get_max_threads(); i++)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        N_ionized += priv.<a class="code" href="structQSOPriv.html#a4e42e9152db40f5f0cfac8aa7053e280">N_ionized</a>[i];</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a>(priv.<a class="code" href="structQSOPriv.html#a4e42e9152db40f5f0cfac8aa7053e280">N_ionized</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> N_ionized;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a42114e122d3563daef66be9f181eebb2"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a42114e122d3563daef66be9f181eebb2">ionize_ngbiter</a></div><div class="ttdeci">static void ionize_ngbiter(TreeWalkQueryQSOLightup *I, TreeWalkResultBase *O, TreeWalkNgbIterBase *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00419">cooling_qso_lightup.c:419</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_ae32b760cb7dd4dcf046e5357429b5690"><div class="ttname"><a href="cooling__qso__lightup_8c.html#ae32b760cb7dd4dcf046e5357429b5690">ionize_copy</a></div><div class="ttdeci">static void ionize_copy(int place, TreeWalkQueryQSOLightup *I, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00453">cooling_qso_lightup.c:453</a></div></div>
<div class="ttc" id="astructQSOPriv_html_a4e42e9152db40f5f0cfac8aa7053e280"><div class="ttname"><a href="structQSOPriv.html#a4e42e9152db40f5f0cfac8aa7053e280">QSOPriv::N_ionized</a></div><div class="ttdeci">int64_t * N_ionized</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00409">cooling_qso_lightup.c:409</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html"><div class="ttname"><a href="structTreeWalkNgbIterBase.html">TreeWalkNgbIterBase</a></div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00036">treewalk.h:36</a></div></div>
<div class="ttc" id="astructTreeWalkQueryQSOLightup_html"><div class="ttname"><a href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a></div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00050">cooling_qso_lightup.c:51</a></div></div>
<div class="ttc" id="astructTreeWalkResultBase_html"><div class="ttname"><a href="structTreeWalkResultBase.html">TreeWalkResultBase</a></div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00030">treewalk.h:30</a></div></div>
<div class="ttc" id="astructTreeWalk_html"><div class="ttname"><a href="structTreeWalk.html">TreeWalk</a></div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00084">treewalk.h:84</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2ae51082ebb6332e558024b6a45506b2"><div class="ttname"><a href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">TreeWalk::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00085">treewalk.h:85</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2f6bc842f407a44d99de52e9b5140454"><div class="ttname"><a href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">TreeWalk::haswork</a></div><div class="ttdeci">TreeWalkHasWorkFunction haswork</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00100">treewalk.h:100</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a36bf2eb0e0d65ace233ef30335e04659"><div class="ttname"><a href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">TreeWalk::ngbiter_type_elsize</a></div><div class="ttdeci">size_t ngbiter_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00097">treewalk.h:97</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8525705e365e7c07027f372b66aff149"><div class="ttname"><a href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">TreeWalk::tree</a></div><div class="ttdeci">const ForceTree * tree</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00088">treewalk.h:88</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8c4dcda60d680c3d56423fca8647472f"><div class="ttname"><a href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">TreeWalk::postprocess</a></div><div class="ttdeci">TreeWalkProcessFunction postprocess</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00104">treewalk.h:104</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a96381f9f61cf2c56dac48927cd997ec3"><div class="ttname"><a href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">TreeWalk::ngbiter</a></div><div class="ttdeci">TreeWalkNgbIterFunction ngbiter</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00103">treewalk.h:103</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa08a0586a68d1f4f87e0caa1e59dcc5e"><div class="ttname"><a href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">TreeWalk::reduce</a></div><div class="ttdeci">TreeWalkReduceResultFunction reduce</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00102">treewalk.h:102</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa3ff3d4a5a82422609ac154aa4a461ea"><div class="ttname"><a href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">TreeWalk::ev_label</a></div><div class="ttdeci">const char * ev_label</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00091">treewalk.h:91</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ab4e96e67f2e72ac33dca9dd06cdac6c0"><div class="ttname"><a href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">TreeWalk::visit</a></div><div class="ttdeci">TreeWalkVisitFunction visit</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00099">treewalk.h:99</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ac8c67faaf2c360ed510c4508f11f7c2d"><div class="ttname"><a href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">TreeWalk::result_type_elsize</a></div><div class="ttdeci">size_t result_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00096">treewalk.h:96</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ad0b91dafd46de132917e7993869514c5"><div class="ttname"><a href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">TreeWalk::fill</a></div><div class="ttdeci">TreeWalkFillQueryFunction fill</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00101">treewalk.h:101</a></div></div>
<div class="ttc" id="astructTreeWalk_html_affd5eae4b5a63dcce236ac15b00b4c7c"><div class="ttname"><a href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">TreeWalk::query_type_elsize</a></div><div class="ttdeci">size_t query_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00095">treewalk.h:95</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a145aa9608fd3824bec8049ee97da1c6f"><div class="ttname"><a href="treewalk_8c.html#a145aa9608fd3824bec8049ee97da1c6f">treewalk_visit_ngbiter</a></div><div class="ttdeci">int treewalk_visit_ngbiter(TreeWalkQueryBase *I, TreeWalkResultBase *O, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l00924">treewalk.c:924</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a1e336844d7f92d15cd9248c81ecfb453"><div class="ttname"><a href="treewalk_8c.html#a1e336844d7f92d15cd9248c81ecfb453">treewalk_run</a></div><div class="ttdeci">void treewalk_run(TreeWalk *tw, int *active_set, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l00619">treewalk.c:619</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a01b18ab132aa3a45e2f2bed8aef94633"><div class="ttname"><a href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a></div><div class="ttdeci">int(* TreeWalkVisitFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00068">treewalk.h:68</a></div></div>
<div class="ttc" id="atreewalk_8h_html_aade20e4cc34b64ecf3bd6f5525465371"><div class="ttname"><a href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a></div><div class="ttdeci">void(* TreeWalkNgbIterFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, TreeWalkNgbIterBase *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00070">treewalk.h:70</a></div></div>
<div class="ttc" id="atreewalk_8h_html_ac9a8ade7817c58b83859399364deb1a1"><div class="ttname"><a href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a></div><div class="ttdeci">void(* TreeWalkFillQueryFunction)(const int j, TreeWalkQueryBase *query, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00075">treewalk.h:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="treewalk_8h_source.html#l00091">TreeWalk::ev_label</a>, <a class="el" href="treewalk_8h_source.html#l00101">TreeWalk::fill</a>, <a class="el" href="treewalk_8h_source.html#l00100">TreeWalk::haswork</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00453">ionize_copy()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00419">ionize_ngbiter()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00409">QSOPriv::N_ionized</a>, <a class="el" href="treewalk_8h_source.html#l00103">TreeWalk::ngbiter</a>, <a class="el" href="treewalk_8h_source.html#l00097">TreeWalk::ngbiter_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00104">TreeWalk::postprocess</a>, <a class="el" href="treewalk_8h_source.html#l00085">TreeWalk::priv</a>, <a class="el" href="treewalk_8h_source.html#l00095">TreeWalk::query_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00102">TreeWalk::reduce</a>, <a class="el" href="treewalk_8h_source.html#l00096">TreeWalk::result_type_elsize</a>, <a class="el" href="mymalloc_8h_source.html#l00028">ta_free</a>, <a class="el" href="mymalloc_8h_source.html#l00025">ta_malloc</a>, <a class="el" href="treewalk_8h_source.html#l00088">TreeWalk::tree</a>, <a class="el" href="treewalk_8c_source.html#l00619">treewalk_run()</a>, <a class="el" href="treewalk_8c_source.html#l00924">treewalk_visit_ngbiter()</a>, and <a class="el" href="treewalk_8h_source.html#l00099">TreeWalk::visit</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_ad472e4014433bed14cf81e46a891cd8b_cgraph.svg" width="1464" height="1031"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_ad472e4014433bed14cf81e46a891cd8b_icgraph.svg" width="704" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae32b760cb7dd4dcf046e5357429b5690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae32b760cb7dd4dcf046e5357429b5690">&#9670;&nbsp;</a></span>ionize_copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ionize_copy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>place</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a> *&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalk.html">TreeWalk</a> *&#160;</td>
          <td class="paramname"><em>tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00453">453</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="structFOFGroups.html">FOFGroups</a> * fof = <a class="code" href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a>(tw)-&gt;fof;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">/* Strictly speaking this is inefficient:</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">     * we are also copying the properties of the *particle*</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">     * in place in treewalk.c. However, this does not matter unless</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">     * there are more local groups than particles!*/</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">for</span>(k = 0; k &lt; 3; k++)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        I-&gt;<a class="code" href="structTreeWalkQueryQSOLightup.html#a4065874f80d9266907ef6df9ff95c661">base</a>.<a class="code" href="structTreeWalkQueryBase.html#a49a12e5d0c323fc4bda017bf127ff322">Pos</a>[k] = fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[place].<a class="code" href="structGroup.html#a9d44d013d609ea8e0111d6823acd5030">CM</a>[k];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    I-&gt;<a class="code" href="structTreeWalkQueryQSOLightup.html#a3548526bd02585a3b8c36ae50e9f6f85">ID</a> = fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[place].<a class="code" href="structGroup.html#a26fb6a6827efff79ee2d3ec522bc15f1">base</a>.<a class="code" href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">MinID</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_afdee6b67b393552cfa2f0fe2a9e96f3c"><div class="ttname"><a href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a></div><div class="ttdeci">#define QSO_GET_PRIV(tw)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00413">cooling_qso_lightup.c:413</a></div></div>
<div class="ttc" id="astructBaseGroup_html_a0e67684d09dd036317c12a7a0b0dcbaf"><div class="ttname"><a href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">BaseGroup::MinID</a></div><div class="ttdeci">MyIDType MinID</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00018">fof.h:18</a></div></div>
<div class="ttc" id="astructFOFGroups_html"><div class="ttname"><a href="structFOFGroups.html">FOFGroups</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00061">fof.h:62</a></div></div>
<div class="ttc" id="astructGroup_html_a26fb6a6827efff79ee2d3ec522bc15f1"><div class="ttname"><a href="structGroup.html#a26fb6a6827efff79ee2d3ec522bc15f1">Group::base</a></div><div class="ttdeci">struct BaseGroup base</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00022">fof.h:27</a></div></div>
<div class="ttc" id="astructGroup_html_a9d44d013d609ea8e0111d6823acd5030"><div class="ttname"><a href="structGroup.html#a9d44d013d609ea8e0111d6823acd5030">Group::CM</a></div><div class="ttdeci">double CM[3]</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00034">fof.h:34</a></div></div>
<div class="ttc" id="astructTreeWalkQueryBase_html_a49a12e5d0c323fc4bda017bf127ff322"><div class="ttname"><a href="structTreeWalkQueryBase.html#a49a12e5d0c323fc4bda017bf127ff322">TreeWalkQueryBase::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00023">treewalk.h:23</a></div></div>
<div class="ttc" id="astructTreeWalkQueryQSOLightup_html_a3548526bd02585a3b8c36ae50e9f6f85"><div class="ttname"><a href="structTreeWalkQueryQSOLightup.html#a3548526bd02585a3b8c36ae50e9f6f85">TreeWalkQueryQSOLightup::ID</a></div><div class="ttdeci">MyIDType ID</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00053">cooling_qso_lightup.c:53</a></div></div>
<div class="ttc" id="astructTreeWalkQueryQSOLightup_html_a4065874f80d9266907ef6df9ff95c661"><div class="ttname"><a href="structTreeWalkQueryQSOLightup.html#a4065874f80d9266907ef6df9ff95c661">TreeWalkQueryQSOLightup::base</a></div><div class="ttdeci">TreeWalkQueryBase base</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00052">cooling_qso_lightup.c:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00052">TreeWalkQueryQSOLightup::base</a>, <a class="el" href="fof_8h_source.html#l00027">Group::base</a>, <a class="el" href="fof_8h_source.html#l00034">Group::CM</a>, <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00053">TreeWalkQueryQSOLightup::ID</a>, <a class="el" href="fof_8h_source.html#l00018">BaseGroup::MinID</a>, <a class="el" href="treewalk_8h_source.html#l00023">TreeWalkQueryBase::Pos</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00413">QSO_GET_PRIV</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00473">ionize_all_part()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_ae32b760cb7dd4dcf046e5357429b5690_icgraph.svg" width="851" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a42114e122d3563daef66be9f181eebb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42114e122d3563daef66be9f181eebb2">&#9670;&nbsp;</a></span>ionize_ngbiter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ionize_ngbiter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTreeWalkQueryQSOLightup.html">TreeWalkQueryQSOLightup</a> *&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkResultBase.html">TreeWalkResultBase</a> *&#160;</td>
          <td class="paramname"><em>O</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTreeWalkNgbIterBase.html">TreeWalkNgbIterBase</a> *&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLocalTreeWalk.html">LocalTreeWalk</a> *&#160;</td>
          <td class="paramname"><em>lv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Ionize and heat the particles </p>

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00419">419</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span>(iter-&gt;<a class="code" href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">other</a> == -1) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">/* Gas only ( 1 == 1 &lt;&lt; 0, the bit for type 0)*/</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterBase.html#a887aa48798bdfb5a8cca30be18c9a849">mask</a> = 1;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">/* Bubble size*/</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">double</span> bubble = <a class="code" href="cooling__qso__lightup_8c.html#a4d51ddace470d6cfece4f0a24cfacab7">gaussian_rng</a>(<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a91d3731ff0c295f68f56de7092a1d974">mean_bubble</a>, sqrt(<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a12b783b8320a245557ecf049a288167a">var_bubble</a>), I-&gt;<a class="code" href="structTreeWalkQueryQSOLightup.html#a3548526bd02585a3b8c36ae50e9f6f85">ID</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterBase.html#a633d0a0d40776a7dcef5c6915bda2c56">Hsml</a> = bubble;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">/* Don&#39;t care about gas HSML */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        iter-&gt;<a class="code" href="structTreeWalkNgbIterBase.html#aebe92fe57ee45b4ada2f95717b7cf12b">symmetric</a> = <a class="code" href="treewalk_8h.html#ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5">NGB_TREEFIND_ASYMMETRIC</a>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">int</span> other = iter-&gt;<a class="code" href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">other</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">/* Only ionize gas*/</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].Type != 0)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> ionized = <a class="code" href="cooling__qso__lightup_8c.html#a84f6042301b4e31e8d0f9af01590f23c">ionize_single_particle</a>(other, <a class="code" href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;a3inv, <a class="code" href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;uu_in_cgs);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span>(!ionized)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">int</span> tid = omp_get_thread_num();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">/* Add to the ionization counter for this thread*/</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#afdee6b67b393552cfa2f0fe2a9e96f3c">QSO_GET_PRIV</a>(lv-&gt;<a class="code" href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">tw</a>)-&gt;N_ionized[tid] ++;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a4d51ddace470d6cfece4f0a24cfacab7"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a4d51ddace470d6cfece4f0a24cfacab7">gaussian_rng</a></div><div class="ttdeci">static double gaussian_rng(double mu, double sigma, const int64_t seed)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00271">cooling_qso_lightup.c:271</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a84f6042301b4e31e8d0f9af01590f23c"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a84f6042301b4e31e8d0f9af01590f23c">ionize_single_particle</a></div><div class="ttdeci">static int ionize_single_particle(int other, double a3inv, double uu_in_cgs)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00380">cooling_qso_lightup.c:380</a></div></div>
<div class="ttc" id="astructLocalTreeWalk_html_ae7a5a56205348bfd1bcd544e13c4b702"><div class="ttname"><a href="structLocalTreeWalk.html#ae7a5a56205348bfd1bcd544e13c4b702">LocalTreeWalk::tw</a></div><div class="ttdeci">TreeWalk * tw</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00047">treewalk.h:47</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a633d0a0d40776a7dcef5c6915bda2c56"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a633d0a0d40776a7dcef5c6915bda2c56">TreeWalkNgbIterBase::Hsml</a></div><div class="ttdeci">double Hsml</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00039">treewalk.h:39</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_a887aa48798bdfb5a8cca30be18c9a849"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#a887aa48798bdfb5a8cca30be18c9a849">TreeWalkNgbIterBase::mask</a></div><div class="ttdeci">int mask</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00038">treewalk.h:38</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_ac75baa8cbd1cd6a47dbf9fb136c901d3"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#ac75baa8cbd1cd6a47dbf9fb136c901d3">TreeWalkNgbIterBase::other</a></div><div class="ttdeci">int other</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00043">treewalk.h:43</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterBase_html_aebe92fe57ee45b4ada2f95717b7cf12b"><div class="ttname"><a href="structTreeWalkNgbIterBase.html#aebe92fe57ee45b4ada2f95717b7cf12b">TreeWalkNgbIterBase::symmetric</a></div><div class="ttdeci">enum NgbTreeFindSymmetric symmetric</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00027">treewalk.h:37</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_a12b783b8320a245557ecf049a288167a"><div class="ttname"><a href="structqso__lightup__params.html#a12b783b8320a245557ecf049a288167a">qso_lightup_params::var_bubble</a></div><div class="ttdeci">double var_bubble</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00066">cooling_qso_lightup.c:66</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_a91d3731ff0c295f68f56de7092a1d974"><div class="ttname"><a href="structqso__lightup__params.html#a91d3731ff0c295f68f56de7092a1d974">qso_lightup_params::mean_bubble</a></div><div class="ttdeci">double mean_bubble</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00065">cooling_qso_lightup.c:65</a></div></div>
<div class="ttc" id="atreewalk_8h_html_ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5"><div class="ttname"><a href="treewalk_8h.html#ae8d78c0b33a7736c7e75739976002dbda3b05fa287fdb7661dbb081cd20c00eb5">NGB_TREEFIND_ASYMMETRIC</a></div><div class="ttdeci">@ NGB_TREEFIND_ASYMMETRIC</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00012">treewalk.h:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00271">gaussian_rng()</a>, <a class="el" href="treewalk_8h_source.html#l00039">TreeWalkNgbIterBase::Hsml</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00053">TreeWalkQueryQSOLightup::ID</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00380">ionize_single_particle()</a>, <a class="el" href="treewalk_8h_source.html#l00038">TreeWalkNgbIterBase::mask</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00065">qso_lightup_params::mean_bubble</a>, <a class="el" href="treewalk_8h_source.html#l00012">NGB_TREEFIND_ASYMMETRIC</a>, <a class="el" href="treewalk_8h_source.html#l00043">TreeWalkNgbIterBase::other</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00413">QSO_GET_PRIV</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>, <a class="el" href="treewalk_8h_source.html#l00037">TreeWalkNgbIterBase::symmetric</a>, <a class="el" href="treewalk_8h_source.html#l00047">LocalTreeWalk::tw</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00066">qso_lightup_params::var_bubble</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00473">ionize_all_part()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a42114e122d3563daef66be9f181eebb2_cgraph.svg" width="542" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a42114e122d3563daef66be9f181eebb2_icgraph.svg" width="867" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a84f6042301b4e31e8d0f9af01590f23c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84f6042301b4e31e8d0f9af01590f23c">&#9670;&nbsp;</a></span>ionize_single_particle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ionize_single_particle </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a3inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>uu_in_cgs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00380">380</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">/* Mark it ionized if not done so already.*/</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">int</span> done;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">    #pragma omp atomic capture</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        done = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].HeIIIionized;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[other].HeIIIionized = 1;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span>(done)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">/* Heat the particle*/</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">/* Number of helium atoms per g in the particle*/</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">double</span> nheperg = (1 - <a class="code" href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a>) / (<a class="code" href="physconst_8h.html#a7e6cfbe5535ec2470a672abeba3fcd4d">PROTONMASS</a> * <a class="code" href="cooling__qso__lightup_8c.html#a2830a4870d926a0ebdf59ef7d285d158">HEMASS</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">/* Total heating per unit mass ergs/g for the particle*/</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">double</span> deltau = <a class="code" href="cooling__qso__lightup_8c.html#ab1dd6eff94a6c0891de7a583c145ebad">qso_inst_heating</a> * nheperg;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">/* Conversion factor between internal energy and entropy.*/</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">double</span> entropytou = pow(<a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(other).Density * a3inv, <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>) / <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">/* Convert to entropy in internal units*/</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/* Only one thread may get here*/</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(other).Entropy += deltau / uu_in_cgs / entropytou;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a2830a4870d926a0ebdf59ef7d285d158"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a2830a4870d926a0ebdf59ef7d285d158">HEMASS</a></div><div class="ttdeci">#define HEMASS</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00048">cooling_qso_lightup.c:48</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_ab1dd6eff94a6c0891de7a583c145ebad"><div class="ttname"><a href="cooling__qso__lightup_8c.html#ab1dd6eff94a6c0891de7a583c145ebad">qso_inst_heating</a></div><div class="ttdeci">static double qso_inst_heating</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00079">cooling_qso_lightup.c:79</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a67abaa49a5aa2892eba705d380652279"><div class="ttname"><a href="physconst_8h.html#a67abaa49a5aa2892eba705d380652279">HYDROGEN_MASSFRAC</a></div><div class="ttdeci">#define HYDROGEN_MASSFRAC</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00037">physconst.h:37</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a75216f9bf4030240b1fc0e1855e032d2"><div class="ttname"><a href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a></div><div class="ttdeci">#define GAMMA_MINUS1</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00035">physconst.h:35</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a7e6cfbe5535ec2470a672abeba3fcd4d"><div class="ttname"><a href="physconst_8h.html#a7e6cfbe5535ec2470a672abeba3fcd4d">PROTONMASS</a></div><div class="ttdeci">#define PROTONMASS</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00021">physconst.h:21</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a681d502f5cbf25161ff026312cd1498c"><div class="ttname"><a href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a></div><div class="ttdeci">#define SPHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00124">slotsmanager.h:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00048">HEMASS</a>, <a class="el" href="physconst_8h_source.html#l00037">HYDROGEN_MASSFRAC</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="physconst_8h_source.html#l00021">PROTONMASS</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00079">qso_inst_heating</a>, and <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00419">ionize_ngbiter()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a84f6042301b4e31e8d0f9af01590f23c_icgraph.svg" width="1078" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1e889225391707117df9040605db0cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e889225391707117df9040605db0cc2">&#9670;&nbsp;</a></span>load_heii_reion_hist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void load_heii_reion_hist </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reion_hist_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">137</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    FILE * fd = NULL;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Loading HeII reionization history from file: %s\n&quot;</span>,reion_hist_file);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        fd = fopen(reion_hist_file, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span>(!fd)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(456, <span class="stringliteral">&quot;HeII: Could not open reionization history file at: &#39;%s&#39;\n&quot;</span>, reion_hist_file);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">/*Find size of file*/</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a> = 0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">while</span>(1)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordtype">char</span> buffer[1024];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordtype">char</span> * retval = fgets(buffer, 1024, fd);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">/*Happens on end of file*/</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">if</span>(!retval)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            retval = strtok(buffer, <span class="stringliteral">&quot; \t\n&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="comment">/*Discard comments*/</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">if</span>(!retval || retval[0] == <span class="charliteral">&#39;#&#39;</span>)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>++;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        rewind(fd);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">/* Discard first two lines*/</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a> -=2;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    MPI_Bcast(&amp;<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>, 1, MPI_INT, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>&lt;= 2)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;HeII: Reionization history contains: %d entries, not enough.\n&quot;</span>, <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/*Allocate memory for the reionization history table.*/</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a> = (<span class="keywordtype">double</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;ReionizationTable&quot;</span>, 3 * <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a> = <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a> + <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a> = <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a> + 2 * <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">double</span> qso_spectral_index = 0, photon_threshold_energy = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">int</span> prei = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">while</span>(i &lt; <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordtype">char</span> buffer[1024];</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordtype">char</span> * line = fgets(buffer, 1024, fd);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">/*Happens on end of file*/</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">if</span>(!line)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordtype">char</span> * retval = strtok(line, <span class="stringliteral">&quot; \t\n&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span>(!retval || retval[0] == <span class="charliteral">&#39;#&#39;</span>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span>(prei == 0)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                qso_spectral_index = atof(retval);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                prei++;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(prei == 1)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                photon_threshold_energy = atof(retval);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                prei++;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="comment">/* First column: redshift. Convert to scale factor so it is increasing.*/</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[i] = 1./(1+atof(retval));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">/* Second column: HeIII fraction.*/</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            retval = strtok(NULL, <span class="stringliteral">&quot; \t&quot;</span>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">if</span>(!retval)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;HeII: Line %s of reionization table was incomplete!\n&quot;</span>, line);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <a class="code" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a>[i] = atof(retval);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment">/* Third column: long mean free path photons.*/</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            retval = strtok(NULL, <span class="stringliteral">&quot; \t&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span>(!retval)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;HeII: Line %s of reionization table was incomplete!\n&quot;</span>, line);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a>[i] = atof(retval);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            i++;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        fclose(fd);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab1dd6eff94a6c0891de7a583c145ebad">qso_inst_heating</a> = <a class="code" href="cooling__qso__lightup_8c.html#a0b957ce063007c0d5e15fb9ce55792e6">Q_inst</a>(photon_threshold_energy, qso_spectral_index);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/*Broadcast data to other processors*/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    MPI_Bcast(<a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, 3 * <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>, MPI_DOUBLE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    MPI_Bcast(&amp;<a class="code" href="cooling__qso__lightup_8c.html#ab1dd6eff94a6c0891de7a583c145ebad">qso_inst_heating</a>, 1, MPI_DOUBLE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">/* Initialize the interpolators*/</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a> = gsl_interp_alloc(gsl_interp_linear,<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#a78cc09c5c604658b463a1533c2772343">LMFP_intp</a> = gsl_interp_alloc(gsl_interp_linear,<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    gsl_interp_init(<a class="code" href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a>, <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, <a class="code" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a>, <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    gsl_interp_init(<a class="code" href="cooling__qso__lightup_8c.html#a78cc09c5c604658b463a1533c2772343">LMFP_intp</a>, <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, <a class="code" href="cooling__qso__lightup_8c.html#a99e3abd53d13b5a970a6aa7d83400e46">LMFP</a>, <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#af1cdcf224afad7f141497024457c767b">heIIIreion_start</a> = 1/<a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[0]-1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Read %d lines z_reion = %g - %g from file %s\n&quot;</span>, <a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>, 1/<a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[0] -1, 1/<a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>[<a class="code" href="cooling__qso__lightup_8c.html#a3903871e92d0cc76d0cd387cbe01aa24">Nreionhist</a>-1]-1, reion_hist_file);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a0b957ce063007c0d5e15fb9ce55792e6"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a0b957ce063007c0d5e15fb9ce55792e6">Q_inst</a></div><div class="ttdeci">static double Q_inst(double Emax, double alpha_q)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00113">cooling_qso_lightup.c:113</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a21e481a81deff64731633abc9a406fce"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a></div><div class="ttdeci">static double * XHeIII</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00082">cooling_qso_lightup.c:82</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_aba681c92b80d6eb9916cf248f61d3a97"><div class="ttname"><a href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a></div><div class="ttdeci">static gsl_interp * HeIII_intp</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00084">cooling_qso_lightup.c:84</a></div></div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00084">HeIII_intp</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00070">qso_lightup_params::heIIIreion_start</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00083">LMFP</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00085">LMFP_intp</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00080">Nreionhist</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00113">Q_inst()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00079">qso_inst_heating</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>, <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00082">XHeIII</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00238">init_qso_lightup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a1e889225391707117df9040605db0cc2_cgraph.svg" width="582" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a1e889225391707117df9040605db0cc2_icgraph.svg" width="907" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4cde900ae1d3de8cacd08a43caf30dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cde900ae1d3de8cacd08a43caf30dc8">&#9670;&nbsp;</a></span>need_change_helium_ionization_fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int need_change_helium_ionization_fraction </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00657">657</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">double</span> desired_ion_frac = gsl_interp_eval(<a class="code" href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a>, <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, <a class="code" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a>, atime, NULL);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordtype">double</span> curionfrac = <a class="code" href="cooling__qso__lightup_8c.html#ab5740000b165b1b3960c667df61b0415">gas_ionization_fraction</a>();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span>(curionfrac &lt; desired_ion_frac)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_ab5740000b165b1b3960c667df61b0415"><div class="ttname"><a href="cooling__qso__lightup_8c.html#ab5740000b165b1b3960c667df61b0415">gas_ionization_fraction</a></div><div class="ttdeci">static double gas_ionization_fraction(void)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00359">cooling_qso_lightup.c:359</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00359">gas_ionization_fraction()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00084">HeIII_intp</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00082">XHeIII</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a4cde900ae1d3de8cacd08a43caf30dc8_cgraph.svg" width="578" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a4cde900ae1d3de8cacd08a43caf30dc8_icgraph.svg" width="364" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0b957ce063007c0d5e15fb9ce55792e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b957ce063007c0d5e15fb9ce55792e6">&#9670;&nbsp;</a></span>Q_inst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double Q_inst </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00113">113</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">/* Total ionizing flux for the short mean free path photons*/</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">double</span> intflux = (pow(Emax,-alpha_q+1.)-pow(<a class="code" href="cooling__qso__lightup_8c.html#a174ebbd9d6aadb8b70c78ef9a0d74296">E0_HeII</a>,-alpha_q+1.))/(pow(Emax,-alpha_q)- pow(<a class="code" href="cooling__qso__lightup_8c.html#a174ebbd9d6aadb8b70c78ef9a0d74296">E0_HeII</a>,-alpha_q));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">/* Heating is input per unit mass, so quasars in denser areas will provide more heating.*/</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="cooling__qso__lightup_8c.html#a0b957ce063007c0d5e15fb9ce55792e6">Q_inst</a> = (alpha_q/(alpha_q - 1.0))*intflux -<a class="code" href="cooling__qso__lightup_8c.html#a174ebbd9d6aadb8b70c78ef9a0d74296">E0_HeII</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="physconst_8h.html#a50f31efe5ec7591a1447b3e243dfe0d1">eVinergs</a> * <a class="code" href="cooling__qso__lightup_8c.html#a0b957ce063007c0d5e15fb9ce55792e6">Q_inst</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a174ebbd9d6aadb8b70c78ef9a0d74296"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a174ebbd9d6aadb8b70c78ef9a0d74296">E0_HeII</a></div><div class="ttdeci">#define E0_HeII</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00047">cooling_qso_lightup.c:47</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a50f31efe5ec7591a1447b3e243dfe0d1"><div class="ttname"><a href="physconst_8h.html#a50f31efe5ec7591a1447b3e243dfe0d1">eVinergs</a></div><div class="ttdeci">#define eVinergs</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00015">physconst.h:15</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00047">E0_HeII</a>, and <a class="el" href="physconst_8h_source.html#l00015">eVinergs</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a0b957ce063007c0d5e15fb9ce55792e6_icgraph.svg" width="1018" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7c64156382a9569697615424e60b2efa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c64156382a9569697615424e60b2efa">&#9670;&nbsp;</a></span>qso_lightup_on()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qso_lightup_on </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00682">682</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;{</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="stats_8c_source.html#l00073">open_outputfiles()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a7c64156382a9569697615424e60b2efa_icgraph.svg" width="503" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac1b832bc238a16abd63e0a155ebeb604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b832bc238a16abd63e0a155ebeb604">&#9670;&nbsp;</a></span>set_qso_lightup_par()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_qso_lightup_par </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structqso__lightup__params.html">qso_lightup_params</a>&#160;</td>
          <td class="paramname"><em>qso</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00088">88</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a> = qso;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>.</p>

</div>
</div>
<a id="a0fb6b3c2677af8f265b3ed07f7c7ec4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fb6b3c2677af8f265b3ed07f7c7ec4d">&#9670;&nbsp;</a></span>set_qso_lightup_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_qso_lightup_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParameterSet.html">ParameterSet</a> *&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00094">94</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a0106659300d9a6ca5066ea62d41397de">QSOLightupOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;QSOLightupOn&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#aa652235159ac664e3db215188433b812">qso_candidate_max_mass</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;QSOMaxMass&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a7f3a4d601de7020bb6196afb789730c7">qso_candidate_min_mass</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;QSOMinMass&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a91d3731ff0c295f68f56de7092a1d974">mean_bubble</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;QSOMeanBubble&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a12b783b8320a245557ecf049a288167a">var_bubble</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;QSOVarBubble&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a88fb962a252b8a10425f8a466afff364">heIIIreion_finish_frac</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;QSOHeIIIReionFinishFrac&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    MPI_Bcast(&amp;<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structqso__lightup__params.html">qso_lightup_params</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="aparamset_8c_html_a6228c17649c46aef53e74cd7ccb93fb0"><div class="ttname"><a href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a></div><div class="ttdeci">int param_get_int(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00368">paramset.c:368</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html"><div class="ttname"><a href="structqso__lightup__params.html">qso_lightup_params</a></div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00057">cooling_qso_lightup.c:58</a></div></div>
<div class="ttc" id="astructqso__lightup__params_html_a88fb962a252b8a10425f8a466afff364"><div class="ttname"><a href="structqso__lightup__params.html#a88fb962a252b8a10425f8a466afff364">qso_lightup_params::heIIIreion_finish_frac</a></div><div class="ttdeci">double heIIIreion_finish_frac</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00068">cooling_qso_lightup.c:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00068">qso_lightup_params::heIIIreion_finish_frac</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00065">qso_lightup_params::mean_bubble</a>, <a class="el" href="paramset_8c_source.html#l00336">param_get_double()</a>, <a class="el" href="paramset_8c_source.html#l00368">param_get_int()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00063">qso_lightup_params::qso_candidate_max_mass</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00061">qso_lightup_params::qso_candidate_min_mass</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00059">qso_lightup_params::QSOLightupOn</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>, <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00066">qso_lightup_params::var_bubble</a>.</p>

<p class="reference">Referenced by <a class="el" href="gadget_2params_8c_source.html#l00359">read_parameter_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a0fb6b3c2677af8f265b3ed07f7c7ec4d_cgraph.svg" width="848" height="130"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a0fb6b3c2677af8f265b3ed07f7c7ec4d_icgraph.svg" width="495" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a047bd5886141415004b83a046b49d5cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047bd5886141415004b83a046b49d5cc">&#9670;&nbsp;</a></span>turn_on_quasars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void turn_on_quasars </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDomainDecomp.html">DomainDecomp</a> *&#160;</td>
          <td class="paramname"><em>ddecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>uu_in_cgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>FdHelium</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">520</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">int</span> ncand = 0;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">int</span> * qso_cand = NULL;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    int64_t n_gas_tot=0, tot_n_ionized=0, ncand_tot=0;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    MPI_Allreduce(&amp;<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>, &amp;n_gas_tot, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">double</span> desired_ion_frac = gsl_interp_eval(<a class="code" href="cooling__qso__lightup_8c.html#aba681c92b80d6eb9916cf248f61d3a97">HeIII_intp</a>, <a class="code" href="cooling__qso__lightup_8c.html#a0055059157dbe3a3314d66edbb898473">He_zz</a>, <a class="code" href="cooling__qso__lightup_8c.html#a21e481a81deff64731633abc9a406fce">XHeIII</a>, atime, NULL);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">struct </span><a class="code" href="structQSOPriv.html">QSOPriv</a> priv;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    priv.<a class="code" href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">fof</a> = <a class="code" href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">fof</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    priv.uu_in_cgs = <a class="code" href="structQSOPriv.html#a5b980a15ecf6abd32f8ec3f1364fe621">uu_in_cgs</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    priv.a3inv = 1/pow(atime, 3);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">/* If the desired ionization fraction is above a threshold (by default 0.95)</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">     * ionize all particles*/</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span>(desired_ion_frac &gt; <a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a88fb962a252b8a10425f8a466afff364">heIIIreion_finish_frac</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordtype">int</span> i, nionized=0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        int64_t nion_tot=0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">        #pragma omp parallel for reduction(+: nionized)</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++){</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Type == 0)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                nionized += <a class="code" href="cooling__qso__lightup_8c.html#a84f6042301b4e31e8d0f9af01590f23c">ionize_single_particle</a>(i, priv.a3inv, priv.uu_in_cgs);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a>(1, &amp;nionized, &amp;nion_tot);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Helium ionization finished, flash-ionizing %ld particles (%g of total)\n&quot;</span>, nion_tot, (<span class="keywordtype">double</span>) nion_tot /(<span class="keywordtype">double</span>) n_gas_tot);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">double</span> rhobar = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> * (3 * <a class="code" href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a> * <a class="code" href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>)/ (8 * M_PI * <a class="code" href="physconst_8h.html#a6801baa546c6112d19eb095111d24720">GRAVITY</a>) * priv.a3inv;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">double</span> totbubblegasmass = 4 * M_PI / 3. * pow(<a class="code" href="cooling__qso__lightup_8c.html#ab2be45b3f715d30ed52bd9a269187f1b">QSOLightupParams</a>.<a class="code" href="structqso__lightup__params.html#a91d3731ff0c295f68f56de7092a1d974">mean_bubble</a>, 3) * rhobar;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">/* Total expected ionizations if the bubbles do not overlap at all</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">     * and the bubble is at mean density.*/</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    int64_t non_overlapping_bubble_number = n_gas_tot * totbubblegasmass / <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">double</span> initionfrac = <a class="code" href="cooling__qso__lightup_8c.html#ab5740000b165b1b3960c667df61b0415">gas_ionization_fraction</a>();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">double</span> curionfrac = initionfrac;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Started helium reionization model with ionization fraction %g\n&quot;</span>, initionfrac);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span>(curionfrac &lt; desired_ion_frac) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        ncand = <a class="code" href="cooling__qso__lightup_8c.html#a4b930690ef2b4a003a7d55756496b133">build_qso_candidate_list</a>(&amp;qso_cand, <a class="code" href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">fof</a>);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/HeIII/Find&quot;</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    int64_t ncand_before = <a class="code" href="cooling__qso__lightup_8c.html#a9538e49bb1669a104f4f04059bcd6ebd">count_QSO_halos</a>(ncand, &amp;ncand_tot, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">int</span> iteration;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">/* If there are no quasars this will be tough*/</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span>(ncand_tot == 0) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">if</span>(qso_cand)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(qso_cand);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Built quasar candidate list from %d quasars\n&quot;</span>, ncand_tot);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="structForceTree.html">ForceTree</a> gasTree = {0};</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="forcetree_8c.html#aa01061828cef34bc4c55ef9eaa7c03f5">force_tree_rebuild_mask</a>(&amp;gasTree, ddecomp, <a class="code" href="forcetree_8h.html#ad7d9abc3063766d4c2825954b8354f70">GASMASK</a>, 0, NULL);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">for</span>(iteration = 0; curionfrac &lt; desired_ion_frac; iteration++){</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">/* Get a new quasar*/</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordtype">int</span> new_qso = <a class="code" href="cooling__qso__lightup_8c.html#a73a9803be56bee1d25f41403e8c9585f">choose_QSO_halo</a>(ncand, &amp;ncand_before, &amp;ncand_tot, <a class="code" href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">fof</a>-&gt;<a class="code" href="structFOFGroups.html#ab2ab288906223aa744c9e07ecd12c61f">TotNgroups</a>+iteration);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span>(new_qso &gt;= ncand)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(12, <span class="stringliteral">&quot;HeII: QSO %d &gt; no. candidates %d! Cannot happen\n&quot;</span>, new_qso, ncand);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/* Make sure someone has a quasar*/</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span>(ncand_tot &lt;= 0) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">if</span>(desired_ion_frac - curionfrac &gt; 0.1)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Ionization fraction %g less than desired ionization fraction of %g because not enough quasars\n&quot;</span>, curionfrac, desired_ion_frac);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        int64_t n_ionized = <a class="code" href="cooling__qso__lightup_8c.html#ad472e4014433bed14cf81e46a891cd8b">ionize_all_part</a>(new_qso, qso_cand, priv, &amp;gasTree);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        int64_t tot_qso_ionized = 0;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">/* Check that the ionization fraction changed*/</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        MPI_Allreduce(&amp;n_ionized, &amp;tot_qso_ionized, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        curionfrac += (double) tot_qso_ionized / (<span class="keywordtype">double</span>) n_gas_tot;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        tot_n_ionized += tot_qso_ionized;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">/* Get the quasar position on rank 0*/</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">double</span> qso_pos[3] = {0};</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">if</span>(new_qso &gt; 0) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordtype">int</span> qplace = qso_cand[new_qso];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">for</span>(k = 0; k &lt; 3; k++) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                qso_pos[k] = <a class="code" href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">fof</a>-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[qplace].<a class="code" href="structGroup.html#a9d44d013d609ea8e0111d6823acd5030">CM</a>[k]- <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5462d473b8cd90abf7f7f7a56d822649">CurrentParticleOffset</a>[k];</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <span class="keywordflow">while</span>(qso_pos[k] &gt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>) qso_pos[k] -= <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">while</span>(qso_pos[k] &lt;= 0) qso_pos[k] += <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;HeII: Quasar %d changed the HeIII ionization fraction to %g, ionizing %ld\n&quot;</span>, qplace, curionfrac, tot_qso_ionized);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="comment">/* Format: Time = current scale factor,</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">         * ID of the quasar (the index of the FOF halo)</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">         * FOF halo position, x,y,z,</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">         * Current ionized fraction</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">         * total number of particles ionized by this quasar*/</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, qso_pos, 3, MPI_DOUBLE, MPI_MAX, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span>(FdHelium) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            fprintf(FdHelium, <span class="stringliteral">&quot;%g %g %g %g %g %ld\n&quot;</span>, atime, qso_pos[0], qso_pos[1], qso_pos[2], curionfrac, tot_qso_ionized);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            fflush(FdHelium);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">/* Break the loop if we do not ionize enough particles this round.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">         * Try again next timestep when we will hopefully have new BHs.*/</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">if</span>(tot_qso_ionized &lt; 0.01 * non_overlapping_bubble_number &amp;&amp; iteration &gt; 10) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: Stopping ionization at iteration %d because insufficient ionization happened.\n&quot;</span>, iteration);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">/* Remove this candidate from the list by moving the list down.*/</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">if</span>( new_qso &gt;= 0) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            memmove(qso_cand+new_qso, qso_cand+new_qso+1, ncand - new_qso+1);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            ncand--;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;gasTree);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span>(qso_cand) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(qso_cand);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span>(tot_n_ionized &gt; 0)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: HeIII fraction from %g -&gt; %g, ionizing %ld. Wanted %g.\n&quot;</span>, initionfrac, curionfrac, tot_n_ionized, desired_ion_frac);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;HeII: HeIII fraction unchanged at %g. Wanted %g\n&quot;</span>, curionfrac, desired_ion_frac);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/HeIII/Ionize&quot;</span>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a4b930690ef2b4a003a7d55756496b133"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a4b930690ef2b4a003a7d55756496b133">build_qso_candidate_list</a></div><div class="ttdeci">static int build_qso_candidate_list(int **qso_cand, FOFGroups *fof)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00282">cooling_qso_lightup.c:282</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a73a9803be56bee1d25f41403e8c9585f"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a73a9803be56bee1d25f41403e8c9585f">choose_QSO_halo</a></div><div class="ttdeci">static int choose_QSO_halo(int64_t ncand, int64_t *ncand_before, int64_t *ncand_tot, int64_t randseed)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00340">cooling_qso_lightup.c:340</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a9538e49bb1669a104f4f04059bcd6ebd"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a9538e49bb1669a104f4f04059bcd6ebd">count_QSO_halos</a></div><div class="ttdeci">static int count_QSO_halos(int ncand, int64_t *ncand_tot, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00309">cooling_qso_lightup.c:309</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_ad472e4014433bed14cf81e46a891cd8b"><div class="ttname"><a href="cooling__qso__lightup_8c.html#ad472e4014433bed14cf81e46a891cd8b">ionize_all_part</a></div><div class="ttdeci">static int64_t ionize_all_part(int qso_ind, int *qso_cand, struct QSOPriv priv, ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00473">cooling_qso_lightup.c:473</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aa01061828cef34bc4c55ef9eaa7c03f5"><div class="ttname"><a href="forcetree_8c.html#aa01061828cef34bc4c55ef9eaa7c03f5">force_tree_rebuild_mask</a></div><div class="ttdeci">void force_tree_rebuild_mask(ForceTree *tree, DomainDecomp *ddecomp, int mask, const int HybridNuGrav, const char *EmergencyOutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00161">forcetree.c:161</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aaa26dfea4b696133a8bc35c5e0c56037"><div class="ttname"><a href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a></div><div class="ttdeci">void force_tree_free(ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l01409">forcetree.c:1409</a></div></div>
<div class="ttc" id="aforcetree_8h_html_ad7d9abc3063766d4c2825954b8354f70"><div class="ttname"><a href="forcetree_8h.html#ad7d9abc3063766d4c2825954b8354f70">GASMASK</a></div><div class="ttdeci">#define GASMASK</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00021">forcetree.h:21</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a5de72d8762faf787d06d4dd47daeddeb"><div class="ttname"><a href="physconst_8h.html#a5de72d8762faf787d06d4dd47daeddeb">HUBBLE</a></div><div class="ttdeci">#define HUBBLE</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00025">physconst.h:25</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a6801baa546c6112d19eb095111d24720"><div class="ttname"><a href="physconst_8h.html#a6801baa546c6112d19eb095111d24720">GRAVITY</a></div><div class="ttdeci">#define GRAVITY</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00005">physconst.h:5</a></div></div>
<div class="ttc" id="astructCosmology_html_a4b79dcaa1e1c38d07258c3f539e2cb20"><div class="ttname"><a href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">Cosmology::HubbleParam</a></div><div class="ttdeci">double HubbleParam</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00020">cosmology.h:20</a></div></div>
<div class="ttc" id="astructCosmology_html_ac818659114fd72f09039b088e43e8624"><div class="ttname"><a href="structCosmology.html#ac818659114fd72f09039b088e43e8624">Cosmology::OmegaBaryon</a></div><div class="ttdeci">double OmegaBaryon</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00019">cosmology.h:19</a></div></div>
<div class="ttc" id="astructFOFGroups_html_ab2ab288906223aa744c9e07ecd12c61f"><div class="ttname"><a href="structFOFGroups.html#ab2ab288906223aa744c9e07ecd12c61f">FOFGroups::TotNgroups</a></div><div class="ttdeci">int64_t TotNgroups</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00067">fof.h:67</a></div></div>
<div class="ttc" id="astructForceTree_html"><div class="ttname"><a href="structForceTree.html">ForceTree</a></div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00076">forcetree.h:76</a></div></div>
<div class="ttc" id="astructQSOPriv_html"><div class="ttname"><a href="structQSOPriv.html">QSOPriv</a></div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00407">cooling_qso_lightup.c:407</a></div></div>
<div class="ttc" id="astructQSOPriv_html_a5b980a15ecf6abd32f8ec3f1364fe621"><div class="ttname"><a href="structQSOPriv.html#a5b980a15ecf6abd32f8ec3f1364fe621">QSOPriv::uu_in_cgs</a></div><div class="ttdeci">double uu_in_cgs</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00411">cooling_qso_lightup.c:411</a></div></div>
<div class="ttc" id="astructQSOPriv_html_afc43651423dfcbdb67fa78e82f220b75"><div class="ttname"><a href="structQSOPriv.html#afc43651423dfcbdb67fa78e82f220b75">QSOPriv::fof</a></div><div class="ttdeci">FOFGroups * fof</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00408">cooling_qso_lightup.c:408</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a5462d473b8cd90abf7f7f7a56d822649"><div class="ttname"><a href="structpart__manager__type.html#a5462d473b8cd90abf7f7f7a56d822649">part_manager_type::CurrentParticleOffset</a></div><div class="ttdeci">double CurrentParticleOffset[3]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00082">partmanager.h:82</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_afd51316d545eaf7f3f083aea9616858d"><div class="ttname"><a href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">part_manager_type::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00084">partmanager.h:84</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cooling__qso__lightup_8c_source.html#l00410">QSOPriv::a3inv</a>, <a class="el" href="partmanager_8h_source.html#l00084">part_manager_type::BoxSize</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00282">build_qso_candidate_list()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00340">choose_QSO_halo()</a>, <a class="el" href="fof_8h_source.html#l00034">Group::CM</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00309">count_QSO_halos()</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="partmanager_8h_source.html#l00082">part_manager_type::CurrentParticleOffset</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00408">QSOPriv::fof</a>, <a class="el" href="forcetree_8c_source.html#l01409">force_tree_free()</a>, <a class="el" href="forcetree_8c_source.html#l00161">force_tree_rebuild_mask()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00359">gas_ionization_fraction()</a>, <a class="el" href="forcetree_8h_source.html#l00021">GASMASK</a>, <a class="el" href="physconst_8h_source.html#l00005">GRAVITY</a>, <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">He_zz</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00084">HeIII_intp</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00068">qso_lightup_params::heIIIreion_finish_frac</a>, <a class="el" href="physconst_8h_source.html#l00025">HUBBLE</a>, <a class="el" href="cosmology_8h_source.html#l00020">Cosmology::HubbleParam</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00473">ionize_all_part()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00380">ionize_single_particle()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00065">qso_lightup_params::mean_bubble</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="system_8h_source.html#l00012">MPI_INT64</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="cosmology_8h_source.html#l00019">Cosmology::OmegaBaryon</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00073">QSOLightupParams</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="system_8c_source.html#l00192">sumup_large_ints()</a>, <a class="el" href="fof_8h_source.html#l00067">FOFGroups::TotNgroups</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00411">QSOPriv::uu_in_cgs</a>, <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00082">XHeIII</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00640">do_heiii_reionization()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a047bd5886141415004b83a046b49d5cc_cgraph.svg" width="1558" height="1811"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cooling__qso__lightup_8c_a047bd5886141415004b83a046b49d5cc_icgraph.svg" width="539" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0055059157dbe3a3314d66edbb898473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0055059157dbe3a3314d66edbb898473">&#9670;&nbsp;</a></span>He_zz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* He_zz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00081">81</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00640">do_heiii_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00667">during_helium_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00657">need_change_helium_ionization_fraction()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>

</div>
</div>
<a id="aba681c92b80d6eb9916cf248f61d3a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba681c92b80d6eb9916cf248f61d3a97">&#9670;&nbsp;</a></span>HeIII_intp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gsl_interp* HeIII_intp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00084">84</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00657">need_change_helium_ionization_fraction()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>

</div>
</div>
<a id="a28ae0487022e45dd434433892c36eb26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ae0487022e45dd434433892c36eb26">&#9670;&nbsp;</a></span>last_long_mfp_heating</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double last_long_mfp_heating</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00245">245</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>.</p>

</div>
</div>
<a id="a7ae1d4c2b773a357ae246ca83fb34f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ae1d4c2b773a357ae246ca83fb34f29">&#9670;&nbsp;</a></span>last_zz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double last_zz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00244">244</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>.</p>

</div>
</div>
<a id="a99e3abd53d13b5a970a6aa7d83400e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e3abd53d13b5a970a6aa7d83400e46">&#9670;&nbsp;</a></span>LMFP</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* LMFP</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00083">83</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>.</p>

</div>
</div>
<a id="a78cc09c5c604658b463a1533c2772343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78cc09c5c604658b463a1533c2772343">&#9670;&nbsp;</a></span>LMFP_intp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">gsl_interp* LMFP_intp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00085">85</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>.</p>

</div>
</div>
<a id="a3903871e92d0cc76d0cd387cbe01aa24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3903871e92d0cc76d0cd387cbe01aa24">&#9670;&nbsp;</a></span>Nreionhist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Nreionhist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00080">80</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00640">do_heiii_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00667">during_helium_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>.</p>

</div>
</div>
<a id="ab1dd6eff94a6c0891de7a583c145ebad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1dd6eff94a6c0891de7a583c145ebad">&#9670;&nbsp;</a></span>qso_inst_heating</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double qso_inst_heating</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00079">79</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00380">ionize_single_particle()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>.</p>

</div>
</div>
<a id="ab2be45b3f715d30ed52bd9a269187f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2be45b3f715d30ed52bd9a269187f1b">&#9670;&nbsp;</a></span>QSOLightupParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structqso__lightup__params.html">qso_lightup_params</a> QSOLightupParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00001">1</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00282">build_qso_candidate_list()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00640">do_heiii_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00667">during_helium_reionization()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00249">get_long_mean_free_path_heating()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00238">init_qso_lightup()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00419">ionize_ngbiter()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00682">qso_lightup_on()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00088">set_qso_lightup_par()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00094">set_qso_lightup_params()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>

</div>
</div>
<a id="a21e481a81deff64731633abc9a406fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e481a81deff64731633abc9a406fce">&#9670;&nbsp;</a></span>XHeIII</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* XHeIII</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cooling__qso__lightup_8c_source.html#l00082">82</a> of file <a class="el" href="cooling__qso__lightup_8c_source.html">cooling_qso_lightup.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooling__qso__lightup_8c_source.html#l00137">load_heii_reion_hist()</a>, <a class="el" href="cooling__qso__lightup_8c_source.html#l00657">need_change_helium_ionization_fraction()</a>, and <a class="el" href="cooling__qso__lightup_8c_source.html#l00520">turn_on_quasars()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
