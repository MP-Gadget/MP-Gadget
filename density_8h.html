<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/density.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">density.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="forcetree_8h_source.html">forcetree.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timestep_8h_source.html">timestep.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="densitykernel_8h_source.html">densitykernel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="paramset_8h_source.html">utils/paramset.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for density.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h__incl.svg" width="2080" height="635"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h__dep__incl.svg" width="1782" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="density_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdensity__params.html">density_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsph__pred__data.html">sph_pred_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6cfed12ec8143f2406ebd7b8d140bf2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a6cfed12ec8143f2406ebd7b8d140bf2c">set_density_params</a> (<a class="el" href="structParameterSet.html">ParameterSet</a> *ps)</td></tr>
<tr class="separator:a6cfed12ec8143f2406ebd7b8d140bf2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539fe4bcf5b8522bc5d345799f1503e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a539fe4bcf5b8522bc5d345799f1503e1">set_densitypar</a> (struct <a class="el" href="structdensity__params.html">density_params</a> dp)</td></tr>
<tr class="separator:a539fe4bcf5b8522bc5d345799f1503e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49d34dfc3f4e37cac0953d5bc1417a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a> (const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *act, int update_hsml, int DoEgyDensity, int BlackHoleOn, double MinEgySpec, const <a class="el" href="structDriftKickTimes.html">DriftKickTimes</a> times, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *SPH_predicted, <a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *GradRho, const <a class="el" href="structForceTree.html">ForceTree</a> *const tree)</td></tr>
<tr class="separator:ac49d34dfc3f4e37cac0953d5bc1417a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e510a287a10de773a4a0f14db2ff52"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a> (enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a> KernelType)</td></tr>
<tr class="separator:a23e510a287a10de773a4a0f14db2ff52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40e53af730ce9956d564e3dc18d6f0e"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a> (void)</td></tr>
<tr class="separator:ac40e53af730ce9956d564e3dc18d6f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6af534268ae11ed2bad17f5300af23bc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a> (int nsph)</td></tr>
<tr class="separator:a6af534268ae11ed2bad17f5300af23bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34cc6521a5e47836cc02baacd6986dcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a34cc6521a5e47836cc02baacd6986dcf">slots_free_sph_pred_data</a> (struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *sph_pred)</td></tr>
<tr class="separator:a34cc6521a5e47836cc02baacd6986dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300eea2fe5e00af45e3c65215ff5bfe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a> (int PI, double MinEgySpec, double a3inv, double <a class="el" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>)</td></tr>
<tr class="separator:a300eea2fe5e00af45e3c65215ff5bfe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d3cfe0024d97740707f82efde883ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="density_8h.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a> (int i, <a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *VelPred, const double FgravkickB, double gravkick, double hydrokick)</td></tr>
<tr class="separator:a10d3cfe0024d97740707f82efde883ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac49d34dfc3f4e37cac0953d5bc1417a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49d34dfc3f4e37cac0953d5bc1417a4">&#9670;&nbsp;</a></span>density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void density </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structActiveParticles.html">ActiveParticles</a> *&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>update_hsml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DoEgyDensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackHoleOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structDriftKickTimes.html">DriftKickTimes</a>&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *&#160;</td>
          <td class="paramname"><em>SPH_predicted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *&#160;</td>
          <td class="paramname"><em>GradRho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structForceTree.html">ForceTree</a> *const&#160;</td>
          <td class="paramname"><em>tree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the local density for each active SPH particle, the number of neighbours in the current smoothing radius, and the divergence and rotation of the velocity field. The pressure is updated as well. If a particle with its smoothing region is fully inside the local domain, it is not exported to the other processors. The function also detects particles that have a number of neighbours outside the allowed tolerance range. For these particles, the smoothing length is adjusted accordingly, and the <a class="el" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density()</a> computation is called again. Note that the smoothing length is not allowed to fall below the lower bound set by MinGasHsml (this may mean that one has to deal with substantially more than normal number of neighbours.) </p>

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00203">203</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="structTreeWalk.html">TreeWalk</a> tw[1] = {{0}};</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">struct </span><a class="code" href="structDensityPriv.html">DensityPriv</a> priv[1];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">ev_label</a> = <span class="stringliteral">&quot;DENSITY&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">visit</a> = (<a class="code" href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a>) <a class="code" href="treewalk_8c.html#a1878fddf49185074fd570a46f3eea372">treewalk_visit_nolist_ngbiter</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aafe4f27abb67d3959e711ef6787c9b75">NoNgblist</a> = 1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">ngbiter_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">ngbiter</a> = (<a class="code" href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a>) <a class="code" href="density_8c.html#a146d61fe2d2f53ea9b7fabf2ea5e90b7">density_ngbiter</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">haswork</a> = <a class="code" href="density_8c.html#af9776b9b60703f24e380d743918248c3">density_haswork</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">fill</a> = (<a class="code" href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a>) <a class="code" href="density_8c.html#a338ab2cf6c2f52522edb746f04061af9">density_copy</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">reduce</a> = (<a class="code" href="treewalk_8h.html#a2b5a07b25001ac6e9e628d4eb0493b8c">TreeWalkReduceResultFunction</a>) <a class="code" href="density_8c.html#ad169b636ff2e25d362af36cdedb8a3f2">density_reduce</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">postprocess</a> = (<a class="code" href="treewalk_8h.html#a80f59f147efe7c27b601024d819769db">TreeWalkProcessFunction</a>) <a class="code" href="density_8c.html#ae39f5a18f937d210e258c8e8cb710044">density_postprocess</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">query_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">result_type_elsize</a> = <span class="keyword">sizeof</span>(<a class="code" href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">priv</a> = priv;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    tw-&gt;<a class="code" href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">tree</a> = tree;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">double</span> timeall = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">double</span> timecomp, timecomm, timewait;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> atime = exp(<a class="code" href="test__timefac_8c.html#a5b77523ed91eb413cb28b12d8c2ceb46">loga_from_ti</a>(<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Left = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Left&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Right = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Right&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;NumNgb&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Rot = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> (*) [3]) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENS_PRIV-&gt;Rot&quot;</span>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a> * <span class="keyword">sizeof</span>(priv-&gt;Rot[0]));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/* This one stores the gradient for h finding. The factor stored in SPHP-&gt;DhsmlEgyDensityFactor depends on whether PE SPH is enabled.*/</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DhsmlDensityFactor = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;DENSITY_GET_PRIV(tw)-&gt;DhsmlDensity&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;update_hsml = <a class="code" href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">update_hsml</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DoEgyDensity = <a class="code" href="structDensityPriv.html#a30a0d9c3929eff9d2b5036c99af08aae">DoEgyDensity</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;DesNumNgb = <a class="code" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a>(<a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;MinGasHsml = <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">MinGasHsmlFractional</a> * (<a class="code" href="gravity_8h.html#ad2fea9ffa95e668ed71b563e817d2e1b">FORCE_SOFTENING</a>(1, 1)/2.8);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;BlackHoleOn = <a class="code" href="structDensityPriv.html#aa937dcae41f2029c427ea18b69c23b63">BlackHoleOn</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;SPH_predicted = <a class="code" href="structDensityPriv.html#a3f351782202a9b99b8642dc873e870cd">SPH_predicted</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;GradRho = <a class="code" href="structDensityPriv.html#a90b86b68ad79acb839c327694fadd8be">GradRho</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">/* Init Left and Right: this has to be done before treewalk */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>; i++)  {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordtype">int</span> p_i = act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> ? act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>[i] : i;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">/* We only really need active particles with work</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         * but I don&#39;t want to read the particle table here*/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Right[p_i] = tree-&gt;<a class="code" href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">BoxSize</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;NumNgb[p_i] = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;Left[p_i] = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    priv-&gt;a3inv = pow(atime, -3);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    priv-&gt;MinEgySpec = <a class="code" href="structDensityPriv.html#aab71415faa924332b63c73a53dab3032">MinEgySpec</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* Factor this out since all particles have the same drift time*/</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    priv-&gt;FgravkickB = <a class="code" href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a1c5fe7d114a58455177e26d13db726cf">PM_kick</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    memset(priv-&gt;gravkicks, 0, <span class="keyword">sizeof</span>(priv-&gt;gravkicks[0])*(<a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>+1));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    memset(priv-&gt;hydrokicks, 0, <span class="keyword">sizeof</span>(priv-&gt;hydrokicks[0])*(<a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>+1));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">/* Compute the factors to move a current kick times velocity to the drift time velocity.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">     * We need to do the computation for all timebins up to the maximum because even inactive</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">     * particles may have interactions. */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span>(i = <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">mintimebin</a>; i &lt;= <a class="code" href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a>; i++)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        priv-&gt;gravkicks[i] = <a class="code" href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">Ti_kick</a>[i], <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        priv-&gt;hydrokicks[i] = <a class="code" href="timefac_8c.html#a2bfd65177ba7cde60bbe22eb0a84f96b">get_exact_hydrokick_factor</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">Ti_kick</a>[i], <a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    priv-&gt;times = &amp;<a class="code" href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">times</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>; i++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordtype">int</span> p_i = act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> ? act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>[i] : i;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].Type == 0 &amp;&amp; !<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].IsGarbage) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordtype">int</span> bin = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].TimeBin;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a> = <a class="code" href="timebinmgr_8c.html#a7166c93d068baea59abf2ef8cee3c7aa">dloga_from_dti</a>(priv-&gt;times-&gt;Ti_Current - priv-&gt;times-&gt;Ti_kick[bin], priv-&gt;times-&gt;Ti_Current);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            priv-&gt;SPH_predicted-&gt;EntVarPred[<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI] = <a class="code" href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI, priv-&gt;MinEgySpec, priv-&gt;a3inv, <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a>(p_i, priv-&gt;SPH_predicted-&gt;VelPred + 3 * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[p_i].PI, priv-&gt;FgravkickB, priv-&gt;gravkicks[bin], priv-&gt;hydrokicks[bin]);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">/* allocate buffers to arrange communication */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/SPH/Density/Init&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* Do the treewalk with looping for hsml*/</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="treewalk_8c.html#a72643adf5c7952933b8f5fbb27d45a97">treewalk_do_hsml_loop</a>(tw, act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>, act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>, <a class="code" href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">update_hsml</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#ac506e8ace51a716a2fec6c17e0b5dcc5">DhsmlDensityFactor</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#a9e58815ff452f7207307fff63c8abf2e">Rot</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#aa152970e40c653538d5c43853537a154">NumNgb</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#aac6a03e3c7969e390efeafea0c9c56be">Right</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a>(tw)-&gt;<a class="code" href="structDensityPriv.html#a52ab30c25d6f44a990491893a9be9f2a">Left</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">/* collect some timing information */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    timeall = <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<a class="code" href="walltime_8h.html#a5cedff8706bf3a249bd5e3c365b67964">WALLTIME_IGNORE</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    timecomp = tw-&gt;<a class="code" href="structTreeWalk.html#a714d0465e0498a5a8d0b698d37348ce6">timecomp3</a> + tw-&gt;<a class="code" href="structTreeWalk.html#ada69256fab1ba3b0e5ff0f837f749b2e">timecomp1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#a6518c361d396be49a9d1c676d8769802">timecomp2</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    timewait = tw-&gt;<a class="code" href="structTreeWalk.html#ae62aa594cbe693d40de9334cc0f7c820">timewait1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#aacf67d9ea224563ae4006114d97e473c">timewait2</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    timecomm = tw-&gt;<a class="code" href="structTreeWalk.html#a80f3ba2d463ce192ccb0f42eed264f56">timecommsumm1</a> + tw-&gt;<a class="code" href="structTreeWalk.html#ae663d6653b464f02c95c57ae4a5bdd3a">timecommsumm2</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Compute&quot;</span>, timecomp);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Wait&quot;</span>, timewait);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Comm&quot;</span>, timecomm);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a>(<span class="stringliteral">&quot;/SPH/Density/Misc&quot;</span>, timeall - (timecomp + timewait + timecomm));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_a10d3cfe0024d97740707f82efde883ea"><div class="ttname"><a href="density_8c.html#a10d3cfe0024d97740707f82efde883ea">SPH_VelPred</a></div><div class="ttdeci">void SPH_VelPred(int i, MyFloat *VelPred, const double FgravkickB, double gravkick, double hydrokick)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00089">density.c:89</a></div></div>
<div class="ttc" id="adensity_8c_html_a146d61fe2d2f53ea9b7fabf2ea5e90b7"><div class="ttname"><a href="density_8c.html#a146d61fe2d2f53ea9b7fabf2ea5e90b7">density_ngbiter</a></div><div class="ttdeci">static void density_ngbiter(TreeWalkQueryDensity *I, TreeWalkResultDensity *O, TreeWalkNgbIterDensity *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00388">density.c:388</a></div></div>
<div class="ttc" id="adensity_8c_html_a23e510a287a10de773a4a0f14db2ff52"><div class="ttname"><a href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a></div><div class="ttdeci">double GetNumNgb(enum DensityKernelType KernelType)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:55</a></div></div>
<div class="ttc" id="adensity_8c_html_a300eea2fe5e00af45e3c65215ff5bfe7"><div class="ttname"><a href="density_8c.html#a300eea2fe5e00af45e3c65215ff5bfe7">SPH_EntVarPred</a></div><div class="ttdeci">MyFloat SPH_EntVarPred(int PI, double MinEgySpec, double a3inv, double dloga)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00071">density.c:71</a></div></div>
<div class="ttc" id="adensity_8c_html_a338ab2cf6c2f52522edb746f04061af9"><div class="ttname"><a href="density_8c.html#a338ab2cf6c2f52522edb746f04061af9">density_copy</a></div><div class="ttdeci">static void density_copy(int place, TreeWalkQueryDensity *I, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00316">density.c:316</a></div></div>
<div class="ttc" id="adensity_8c_html_a9c4ca3648e6ac54cdb5adb45acc2e4e3"><div class="ttname"><a href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a></div><div class="ttdeci">static struct density_params DensityParams</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00001">density.c:21</a></div></div>
<div class="ttc" id="adensity_8c_html_ad169b636ff2e25d362af36cdedb8a3f2"><div class="ttname"><a href="density_8c.html#ad169b636ff2e25d362af36cdedb8a3f2">density_reduce</a></div><div class="ttdeci">static void density_reduce(int place, TreeWalkResultDensity *remote, enum TreeWalkReduceMode mode, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00339">density.c:339</a></div></div>
<div class="ttc" id="adensity_8c_html_ae39f5a18f937d210e258c8e8cb710044"><div class="ttname"><a href="density_8c.html#ae39f5a18f937d210e258c8e8cb710044">density_postprocess</a></div><div class="ttdeci">static void density_postprocess(int i, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00512">density.c:512</a></div></div>
<div class="ttc" id="adensity_8c_html_af9776b9b60703f24e380d743918248c3"><div class="ttname"><a href="density_8c.html#af9776b9b60703f24e380d743918248c3">density_haswork</a></div><div class="ttdeci">static int density_haswork(int n, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00501">density.c:501</a></div></div>
<div class="ttc" id="adensity_8c_html_afa3ec824b4fabad29715d26181bd89d7"><div class="ttname"><a href="density_8c.html#afa3ec824b4fabad29715d26181bd89d7">DENSITY_GET_PRIV</a></div><div class="ttdeci">#define DENSITY_GET_PRIV(tw)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00166">density.c:166</a></div></div>
<div class="ttc" id="agravity_8h_html_ad2fea9ffa95e668ed71b563e817d2e1b"><div class="ttname"><a href="gravity_8h.html#ad2fea9ffa95e668ed71b563e817d2e1b">FORCE_SOFTENING</a></div><div class="ttdeci">double FORCE_SOFTENING(int i, int type)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00036">gravshort-tree.c:36</a></div></div>
<div class="ttc" id="alightcone_8c_html_a8f3ab427b30a3327076ffcc7c683562c"><div class="ttname"><a href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a></div><div class="ttdeci">static double dloga</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00021">lightcone.c:21</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a1b0b230f3890d70bae976516719b7d07"><div class="ttname"><a href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticles::ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00013">timestep.h:13</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a847ab898fdabc62a4723c7c3a66038d4"><div class="ttname"><a href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">ActiveParticles::NumActiveParticle</a></div><div class="ttdeci">int64_t NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00012">timestep.h:12</a></div></div>
<div class="ttc" id="astructDensityPriv_html"><div class="ttname"><a href="structDensityPriv.html">DensityPriv</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00131">density.c:131</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a2adaf9b9125b7af932d0777d7dbfc13c"><div class="ttname"><a href="structDensityPriv.html#a2adaf9b9125b7af932d0777d7dbfc13c">DensityPriv::update_hsml</a></div><div class="ttdeci">int update_hsml</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00148">density.c:148</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a30a0d9c3929eff9d2b5036c99af08aae"><div class="ttname"><a href="structDensityPriv.html#a30a0d9c3929eff9d2b5036c99af08aae">DensityPriv::DoEgyDensity</a></div><div class="ttdeci">int DoEgyDensity</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00149">density.c:149</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a3f351782202a9b99b8642dc873e870cd"><div class="ttname"><a href="structDensityPriv.html#a3f351782202a9b99b8642dc873e870cd">DensityPriv::SPH_predicted</a></div><div class="ttdeci">struct sph_pred_data * SPH_predicted</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00133">density.c:133</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a52ab30c25d6f44a990491893a9be9f2a"><div class="ttname"><a href="structDensityPriv.html#a52ab30c25d6f44a990491893a9be9f2a">DensityPriv::Left</a></div><div class="ttdeci">MyFloat * Left</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00140">density.c:140</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a6568d579150578cfe8fbbaca391de06d"><div class="ttname"><a href="structDensityPriv.html#a6568d579150578cfe8fbbaca391de06d">DensityPriv::times</a></div><div class="ttdeci">DriftKickTimes const  * times</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00160">density.c:160</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a90b86b68ad79acb839c327694fadd8be"><div class="ttname"><a href="structDensityPriv.html#a90b86b68ad79acb839c327694fadd8be">DensityPriv::GradRho</a></div><div class="ttdeci">MyFloat * GradRho</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00136">density.c:136</a></div></div>
<div class="ttc" id="astructDensityPriv_html_a9e58815ff452f7207307fff63c8abf2e"><div class="ttname"><a href="structDensityPriv.html#a9e58815ff452f7207307fff63c8abf2e">DensityPriv::Rot</a></div><div class="ttdeci">MyFloat(* Rot)[3]</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00141">density.c:141</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aa152970e40c653538d5c43853537a154"><div class="ttname"><a href="structDensityPriv.html#aa152970e40c653538d5c43853537a154">DensityPriv::NumNgb</a></div><div class="ttdeci">MyFloat * NumNgb</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00138">density.c:138</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aa937dcae41f2029c427ea18b69c23b63"><div class="ttname"><a href="structDensityPriv.html#aa937dcae41f2029c427ea18b69c23b63">DensityPriv::BlackHoleOn</a></div><div class="ttdeci">int BlackHoleOn</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00155">density.c:155</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aab71415faa924332b63c73a53dab3032"><div class="ttname"><a href="structDensityPriv.html#aab71415faa924332b63c73a53dab3032">DensityPriv::MinEgySpec</a></div><div class="ttdeci">double MinEgySpec</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00159">density.c:159</a></div></div>
<div class="ttc" id="astructDensityPriv_html_aac6a03e3c7969e390efeafea0c9c56be"><div class="ttname"><a href="structDensityPriv.html#aac6a03e3c7969e390efeafea0c9c56be">DensityPriv::Right</a></div><div class="ttdeci">MyFloat * Right</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00140">density.c:140</a></div></div>
<div class="ttc" id="astructDensityPriv_html_ac506e8ace51a716a2fec6c17e0b5dcc5"><div class="ttname"><a href="structDensityPriv.html#ac506e8ace51a716a2fec6c17e0b5dcc5">DensityPriv::DhsmlDensityFactor</a></div><div class="ttdeci">MyFloat * DhsmlDensityFactor</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00147">density.c:147</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_a1c5fe7d114a58455177e26d13db726cf"><div class="ttname"><a href="structDriftKickTimes.html#a1c5fe7d114a58455177e26d13db726cf">DriftKickTimes::PM_kick</a></div><div class="ttdeci">inttime_t PM_kick</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00031">timestep.h:31</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_a8cbfa406f883f7f7e6ef53cfa4608f7d"><div class="ttname"><a href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">DriftKickTimes::Ti_Current</a></div><div class="ttdeci">inttime_t Ti_Current</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00027">timestep.h:27</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_ac18ed0905144485b014ce19c6db2a4d5"><div class="ttname"><a href="structDriftKickTimes.html#ac18ed0905144485b014ce19c6db2a4d5">DriftKickTimes::Ti_kick</a></div><div class="ttdeci">inttime_t Ti_kick[TIMEBINS+1]</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00023">timestep.h:23</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_ad3b4fe6ff2b0e0be706882c59323621e"><div class="ttname"><a href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">DriftKickTimes::mintimebin</a></div><div class="ttdeci">int mintimebin</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00020">timestep.h:20</a></div></div>
<div class="ttc" id="astructForceTree_html_a8915a4ff849c9e97448ae30089a05966"><div class="ttname"><a href="structForceTree.html#a8915a4ff849c9e97448ae30089a05966">ForceTree::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00106">forcetree.h:106</a></div></div>
<div class="ttc" id="astructTreeWalkNgbIterDensity_html"><div class="ttname"><a href="structTreeWalkNgbIterDensity.html">TreeWalkNgbIterDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00100">density.c:100</a></div></div>
<div class="ttc" id="astructTreeWalkQueryDensity_html"><div class="ttname"><a href="structTreeWalkQueryDensity.html">TreeWalkQueryDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00106">density.c:107</a></div></div>
<div class="ttc" id="astructTreeWalkResultDensity_html"><div class="ttname"><a href="structTreeWalkResultDensity.html">TreeWalkResultDensity</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00115">density.c:115</a></div></div>
<div class="ttc" id="astructTreeWalk_html"><div class="ttname"><a href="structTreeWalk.html">TreeWalk</a></div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00084">treewalk.h:84</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2ae51082ebb6332e558024b6a45506b2"><div class="ttname"><a href="structTreeWalk.html#a2ae51082ebb6332e558024b6a45506b2">TreeWalk::priv</a></div><div class="ttdeci">void * priv</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00085">treewalk.h:85</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a2f6bc842f407a44d99de52e9b5140454"><div class="ttname"><a href="structTreeWalk.html#a2f6bc842f407a44d99de52e9b5140454">TreeWalk::haswork</a></div><div class="ttdeci">TreeWalkHasWorkFunction haswork</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00100">treewalk.h:100</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a36bf2eb0e0d65ace233ef30335e04659"><div class="ttname"><a href="structTreeWalk.html#a36bf2eb0e0d65ace233ef30335e04659">TreeWalk::ngbiter_type_elsize</a></div><div class="ttdeci">size_t ngbiter_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00097">treewalk.h:97</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a6518c361d396be49a9d1c676d8769802"><div class="ttname"><a href="structTreeWalk.html#a6518c361d396be49a9d1c676d8769802">TreeWalk::timecomp2</a></div><div class="ttdeci">double timecomp2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00124">treewalk.h:124</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a714d0465e0498a5a8d0b698d37348ce6"><div class="ttname"><a href="structTreeWalk.html#a714d0465e0498a5a8d0b698d37348ce6">TreeWalk::timecomp3</a></div><div class="ttdeci">double timecomp3</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00125">treewalk.h:125</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a80f3ba2d463ce192ccb0f42eed264f56"><div class="ttname"><a href="structTreeWalk.html#a80f3ba2d463ce192ccb0f42eed264f56">TreeWalk::timecommsumm1</a></div><div class="ttdeci">double timecommsumm1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00126">treewalk.h:126</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8525705e365e7c07027f372b66aff149"><div class="ttname"><a href="structTreeWalk.html#a8525705e365e7c07027f372b66aff149">TreeWalk::tree</a></div><div class="ttdeci">const ForceTree * tree</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00088">treewalk.h:88</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a8c4dcda60d680c3d56423fca8647472f"><div class="ttname"><a href="structTreeWalk.html#a8c4dcda60d680c3d56423fca8647472f">TreeWalk::postprocess</a></div><div class="ttdeci">TreeWalkProcessFunction postprocess</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00104">treewalk.h:104</a></div></div>
<div class="ttc" id="astructTreeWalk_html_a96381f9f61cf2c56dac48927cd997ec3"><div class="ttname"><a href="structTreeWalk.html#a96381f9f61cf2c56dac48927cd997ec3">TreeWalk::ngbiter</a></div><div class="ttdeci">TreeWalkNgbIterFunction ngbiter</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00103">treewalk.h:103</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa08a0586a68d1f4f87e0caa1e59dcc5e"><div class="ttname"><a href="structTreeWalk.html#aa08a0586a68d1f4f87e0caa1e59dcc5e">TreeWalk::reduce</a></div><div class="ttdeci">TreeWalkReduceResultFunction reduce</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00102">treewalk.h:102</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aa3ff3d4a5a82422609ac154aa4a461ea"><div class="ttname"><a href="structTreeWalk.html#aa3ff3d4a5a82422609ac154aa4a461ea">TreeWalk::ev_label</a></div><div class="ttdeci">const char * ev_label</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00091">treewalk.h:91</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aacf67d9ea224563ae4006114d97e473c"><div class="ttname"><a href="structTreeWalk.html#aacf67d9ea224563ae4006114d97e473c">TreeWalk::timewait2</a></div><div class="ttdeci">double timewait2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00122">treewalk.h:122</a></div></div>
<div class="ttc" id="astructTreeWalk_html_aafe4f27abb67d3959e711ef6787c9b75"><div class="ttname"><a href="structTreeWalk.html#aafe4f27abb67d3959e711ef6787c9b75">TreeWalk::NoNgblist</a></div><div class="ttdeci">int NoNgblist</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00156">treewalk.h:156</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ab4e96e67f2e72ac33dca9dd06cdac6c0"><div class="ttname"><a href="structTreeWalk.html#ab4e96e67f2e72ac33dca9dd06cdac6c0">TreeWalk::visit</a></div><div class="ttdeci">TreeWalkVisitFunction visit</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00099">treewalk.h:99</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ac8c67faaf2c360ed510c4508f11f7c2d"><div class="ttname"><a href="structTreeWalk.html#ac8c67faaf2c360ed510c4508f11f7c2d">TreeWalk::result_type_elsize</a></div><div class="ttdeci">size_t result_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00096">treewalk.h:96</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ad0b91dafd46de132917e7993869514c5"><div class="ttname"><a href="structTreeWalk.html#ad0b91dafd46de132917e7993869514c5">TreeWalk::fill</a></div><div class="ttdeci">TreeWalkFillQueryFunction fill</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00101">treewalk.h:101</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ada69256fab1ba3b0e5ff0f837f749b2e"><div class="ttname"><a href="structTreeWalk.html#ada69256fab1ba3b0e5ff0f837f749b2e">TreeWalk::timecomp1</a></div><div class="ttdeci">double timecomp1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00123">treewalk.h:123</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ae62aa594cbe693d40de9334cc0f7c820"><div class="ttname"><a href="structTreeWalk.html#ae62aa594cbe693d40de9334cc0f7c820">TreeWalk::timewait1</a></div><div class="ttdeci">double timewait1</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00121">treewalk.h:121</a></div></div>
<div class="ttc" id="astructTreeWalk_html_ae663d6653b464f02c95c57ae4a5bdd3a"><div class="ttname"><a href="structTreeWalk.html#ae663d6653b464f02c95c57ae4a5bdd3a">TreeWalk::timecommsumm2</a></div><div class="ttdeci">double timecommsumm2</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00127">treewalk.h:127</a></div></div>
<div class="ttc" id="astructTreeWalk_html_affd5eae4b5a63dcce236ac15b00b4c7c"><div class="ttname"><a href="structTreeWalk.html#affd5eae4b5a63dcce236ac15b00b4c7c">TreeWalk::query_type_elsize</a></div><div class="ttdeci">size_t query_type_elsize</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00095">treewalk.h:95</a></div></div>
<div class="ttc" id="astructdensity__params_html_a6f446e3119fb05626ccb93c492b02f9f"><div class="ttname"><a href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">density_params::MinGasHsmlFractional</a></div><div class="ttdeci">double MinGasHsmlFractional</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00022">density.h:22</a></div></div>
<div class="ttc" id="astructdensity__params_html_a9a6f34afbd604c08a8f2ec57f7cc5e48"><div class="ttname"><a href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">density_params::DensityKernelType</a></div><div class="ttdeci">enum DensityKernelType DensityKernelType</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00016">density.h:18</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
<div class="ttc" id="atest__timefac_8c_html_a5b77523ed91eb413cb28b12d8c2ceb46"><div class="ttname"><a href="test__timefac_8c.html#a5b77523ed91eb413cb28b12d8c2ceb46">loga_from_ti</a></div><div class="ttdeci">double loga_from_ti(int ti)</div><div class="ttdef"><b>Definition:</b> <a href="test__timefac_8c_source.html#l00051">test_timefac.c:51</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a7166c93d068baea59abf2ef8cee3c7aa"><div class="ttname"><a href="timebinmgr_8c.html#a7166c93d068baea59abf2ef8cee3c7aa">dloga_from_dti</a></div><div class="ttdeci">double dloga_from_dti(inttime_t dti, const inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00256">timebinmgr.c:256</a></div></div>
<div class="ttc" id="atimebinmgr_8h_html_a4668a3a5f210b5742a179c8d258a703d"><div class="ttname"><a href="timebinmgr_8h.html#a4668a3a5f210b5742a179c8d258a703d">TIMEBINS</a></div><div class="ttdeci">#define TIMEBINS</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00013">timebinmgr.h:13</a></div></div>
<div class="ttc" id="atimefac_8c_html_a2bfd65177ba7cde60bbe22eb0a84f96b"><div class="ttname"><a href="timefac_8c.html#a2bfd65177ba7cde60bbe22eb0a84f96b">get_exact_hydrokick_factor</a></div><div class="ttdeci">double get_exact_hydrokick_factor(Cosmology *CP, inttime_t ti0, inttime_t ti1)</div><div class="ttdef"><b>Definition:</b> <a href="timefac_8c_source.html#l00075">timefac.c:75</a></div></div>
<div class="ttc" id="atimefac_8c_html_ae45524bb6dcfabd035dd6edfda728079"><div class="ttname"><a href="timefac_8c.html#ae45524bb6dcfabd035dd6edfda728079">get_exact_gravkick_factor</a></div><div class="ttdeci">double get_exact_gravkick_factor(Cosmology *CP, inttime_t ti0, inttime_t ti1)</div><div class="ttdef"><b>Definition:</b> <a href="timefac_8c_source.html#l00070">timefac.c:70</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a1878fddf49185074fd570a46f3eea372"><div class="ttname"><a href="treewalk_8c.html#a1878fddf49185074fd570a46f3eea372">treewalk_visit_nolist_ngbiter</a></div><div class="ttdeci">int treewalk_visit_nolist_ngbiter(TreeWalkQueryBase *I, TreeWalkResultBase *O, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l01143">treewalk.c:1143</a></div></div>
<div class="ttc" id="atreewalk_8c_html_a72643adf5c7952933b8f5fbb27d45a97"><div class="ttname"><a href="treewalk_8c.html#a72643adf5c7952933b8f5fbb27d45a97">treewalk_do_hsml_loop</a></div><div class="ttdeci">void treewalk_do_hsml_loop(TreeWalk *tw, int *queue, int64_t queuesize, int update_hsml)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8c_source.html#l01254">treewalk.c:1254</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a01b18ab132aa3a45e2f2bed8aef94633"><div class="ttname"><a href="treewalk_8h.html#a01b18ab132aa3a45e2f2bed8aef94633">TreeWalkVisitFunction</a></div><div class="ttdeci">int(* TreeWalkVisitFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00068">treewalk.h:68</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a2b5a07b25001ac6e9e628d4eb0493b8c"><div class="ttname"><a href="treewalk_8h.html#a2b5a07b25001ac6e9e628d4eb0493b8c">TreeWalkReduceResultFunction</a></div><div class="ttdeci">void(* TreeWalkReduceResultFunction)(const int j, TreeWalkResultBase *result, const enum TreeWalkReduceMode mode, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00076">treewalk.h:76</a></div></div>
<div class="ttc" id="atreewalk_8h_html_a80f59f147efe7c27b601024d819769db"><div class="ttname"><a href="treewalk_8h.html#a80f59f147efe7c27b601024d819769db">TreeWalkProcessFunction</a></div><div class="ttdeci">void(* TreeWalkProcessFunction)(const int i, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00073">treewalk.h:73</a></div></div>
<div class="ttc" id="atreewalk_8h_html_aade20e4cc34b64ecf3bd6f5525465371"><div class="ttname"><a href="treewalk_8h.html#aade20e4cc34b64ecf3bd6f5525465371">TreeWalkNgbIterFunction</a></div><div class="ttdeci">void(* TreeWalkNgbIterFunction)(TreeWalkQueryBase *input, TreeWalkResultBase *output, TreeWalkNgbIterBase *iter, LocalTreeWalk *lv)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00070">treewalk.h:70</a></div></div>
<div class="ttc" id="atreewalk_8h_html_ac9a8ade7817c58b83859399364deb1a1"><div class="ttname"><a href="treewalk_8h.html#ac9a8ade7817c58b83859399364deb1a1">TreeWalkFillQueryFunction</a></div><div class="ttdeci">void(* TreeWalkFillQueryFunction)(const int j, TreeWalkQueryBase *query, TreeWalk *tw)</div><div class="ttdef"><b>Definition:</b> <a href="treewalk_8h_source.html#l00075">treewalk.h:75</a></div></div>
<div class="ttc" id="atypes_8h_html_af1ada7381a1118c6d51bdbb0b5e72811"><div class="ttname"><a href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a></div><div class="ttdeci">LOW_PRECISION MyFloat</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00019">types.h:19</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
<div class="ttc" id="awalltime_8h_html_a5cedff8706bf3a249bd5e3c365b67964"><div class="ttname"><a href="walltime_8h.html#a5cedff8706bf3a249bd5e3c365b67964">WALLTIME_IGNORE</a></div><div class="ttdeci">#define WALLTIME_IGNORE</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00006">walltime.h:6</a></div></div>
<div class="ttc" id="awalltime_8h_html_a9266fc830d2aac1ad7d6e5322be6f489"><div class="ttname"><a href="walltime_8h.html#a9266fc830d2aac1ad7d6e5322be6f489">walltime_add</a></div><div class="ttdeci">#define walltime_add(name, dt)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00009">walltime.h:9</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00158">DensityPriv::a3inv</a>, <a class="el" href="timestep_8h_source.html#l00013">ActiveParticles::ActiveParticle</a>, <a class="el" href="density_8c_source.html#l00155">DensityPriv::BlackHoleOn</a>, <a class="el" href="forcetree_8h_source.html#l00106">ForceTree::BoxSize</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="density_8c_source.html#l00316">density_copy()</a>, <a class="el" href="density_8c_source.html#l00166">DENSITY_GET_PRIV</a>, <a class="el" href="density_8c_source.html#l00501">density_haswork()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, <a class="el" href="density_8c_source.html#l00512">density_postprocess()</a>, <a class="el" href="density_8c_source.html#l00339">density_reduce()</a>, <a class="el" href="density_8h_source.html#l00018">density_params::DensityKernelType</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8c_source.html#l00147">DensityPriv::DhsmlDensityFactor</a>, <a class="el" href="lightcone_8c_source.html#l00021">dloga</a>, <a class="el" href="timebinmgr_8c_source.html#l00256">dloga_from_dti()</a>, <a class="el" href="density_8c_source.html#l00149">DensityPriv::DoEgyDensity</a>, <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="treewalk_8h_source.html#l00091">TreeWalk::ev_label</a>, <a class="el" href="density_8c_source.html#l00161">DensityPriv::FgravkickB</a>, <a class="el" href="treewalk_8h_source.html#l00101">TreeWalk::fill</a>, <a class="el" href="gravshort-tree_8c_source.html#l00036">FORCE_SOFTENING()</a>, <a class="el" href="timefac_8c_source.html#l00070">get_exact_gravkick_factor()</a>, <a class="el" href="timefac_8c_source.html#l00075">get_exact_hydrokick_factor()</a>, <a class="el" href="density_8c_source.html#l00055">GetNumNgb()</a>, <a class="el" href="density_8c_source.html#l00136">DensityPriv::GradRho</a>, <a class="el" href="density_8c_source.html#l00162">DensityPriv::gravkicks</a>, <a class="el" href="treewalk_8h_source.html#l00100">TreeWalk::haswork</a>, <a class="el" href="density_8c_source.html#l00163">DensityPriv::hydrokicks</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="density_8c_source.html#l00140">DensityPriv::Left</a>, <a class="el" href="test__timefac_8c_source.html#l00051">loga_from_ti()</a>, <a class="el" href="density_8c_source.html#l00159">DensityPriv::MinEgySpec</a>, <a class="el" href="density_8h_source.html#l00022">density_params::MinGasHsmlFractional</a>, <a class="el" href="timestep_8h_source.html#l00020">DriftKickTimes::mintimebin</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="treewalk_8h_source.html#l00103">TreeWalk::ngbiter</a>, <a class="el" href="treewalk_8h_source.html#l00097">TreeWalk::ngbiter_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00156">TreeWalk::NoNgblist</a>, <a class="el" href="timestep_8h_source.html#l00012">ActiveParticles::NumActiveParticle</a>, <a class="el" href="density_8c_source.html#l00138">DensityPriv::NumNgb</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="timestep_8h_source.html#l00031">DriftKickTimes::PM_kick</a>, <a class="el" href="treewalk_8h_source.html#l00104">TreeWalk::postprocess</a>, <a class="el" href="treewalk_8h_source.html#l00085">TreeWalk::priv</a>, <a class="el" href="treewalk_8h_source.html#l00095">TreeWalk::query_type_elsize</a>, <a class="el" href="treewalk_8h_source.html#l00102">TreeWalk::reduce</a>, <a class="el" href="treewalk_8h_source.html#l00096">TreeWalk::result_type_elsize</a>, <a class="el" href="density_8c_source.html#l00140">DensityPriv::Right</a>, <a class="el" href="density_8c_source.html#l00141">DensityPriv::Rot</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="density_8c_source.html#l00071">SPH_EntVarPred()</a>, <a class="el" href="density_8c_source.html#l00133">DensityPriv::SPH_predicted</a>, <a class="el" href="density_8c_source.html#l00089">SPH_VelPred()</a>, <a class="el" href="timestep_8h_source.html#l00027">DriftKickTimes::Ti_Current</a>, <a class="el" href="timestep_8h_source.html#l00023">DriftKickTimes::Ti_kick</a>, <a class="el" href="timebinmgr_8h_source.html#l00013">TIMEBINS</a>, <a class="el" href="treewalk_8h_source.html#l00126">TreeWalk::timecommsumm1</a>, <a class="el" href="treewalk_8h_source.html#l00127">TreeWalk::timecommsumm2</a>, <a class="el" href="treewalk_8h_source.html#l00123">TreeWalk::timecomp1</a>, <a class="el" href="treewalk_8h_source.html#l00124">TreeWalk::timecomp2</a>, <a class="el" href="treewalk_8h_source.html#l00125">TreeWalk::timecomp3</a>, <a class="el" href="density_8c_source.html#l00160">DensityPriv::times</a>, <a class="el" href="treewalk_8h_source.html#l00121">TreeWalk::timewait1</a>, <a class="el" href="treewalk_8h_source.html#l00122">TreeWalk::timewait2</a>, <a class="el" href="treewalk_8h_source.html#l00088">TreeWalk::tree</a>, <a class="el" href="treewalk_8c_source.html#l01254">treewalk_do_hsml_loop()</a>, <a class="el" href="treewalk_8c_source.html#l01143">treewalk_visit_nolist_ngbiter()</a>, <a class="el" href="density_8c_source.html#l00148">DensityPriv::update_hsml</a>, <a class="el" href="density_8h_source.html#l00034">sph_pred_data::VelPred</a>, <a class="el" href="treewalk_8h_source.html#l00099">TreeWalk::visit</a>, <a class="el" href="walltime_8h_source.html#l00009">walltime_add</a>, <a class="el" href="walltime_8h_source.html#l00006">WALLTIME_IGNORE</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00512">density_postprocess()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="cooling__rates_8c_source.html#l01034">get_compton_cooling()</a>, <a class="el" href="cooling__rates_8c_source.html#l00683">get_equilib_ne()</a>, <a class="el" href="cooling__rates_8c_source.html#l01104">get_heatingcooling_rate()</a>, <a class="el" href="cooling__rates_8c_source.html#l01202">get_helium_ion_phys_cgs()</a>, <a class="el" href="cooling__rates_8c_source.html#l01046">get_individual_cooling()</a>, <a class="el" href="cooling__rates_8c_source.html#l00696">get_ne_by_nh()</a>, <a class="el" href="cooling__rates_8c_source.html#l01186">get_neutral_fraction_phys_cgs()</a>, <a class="el" href="cooling__rates_8c_source.html#l01172">get_temp()</a>, <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, <a class="el" href="init_8c_source.html#l00384">setup_density_indep_entropy()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_ac49d34dfc3f4e37cac0953d5bc1417a4_cgraph.svg" width="1759" height="1724"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_ac49d34dfc3f4e37cac0953d5bc1417a4_icgraph.svg" width="2699" height="1215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac40e53af730ce9956d564e3dc18d6f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac40e53af730ce9956d564e3dc18d6f0e">&#9670;&nbsp;</a></span>GetDensityKernelType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a> GetDensityKernelType </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00055">55</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="densitykernel_8c_source.html#l00124">density_kernel_desnumngb()</a>, <a class="el" href="densitykernel_8c_source.html#l00157">density_kernel_init()</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8h_source.html#l00011">density_params::DensityResolutionEta</a>, and <a class="el" href="lightcone_8c_source.html#l00059">kernel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="blackhole_8c_source.html#l01063">blackhole_accretion_ngbiter()</a>, <a class="el" href="blackhole_8c_source.html#l00866">blackhole_dynfric_ngbiter()</a>, <a class="el" href="blackhole_8c_source.html#l01278">blackhole_feedback_ngbiter()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>, <a class="el" href="metal__return_8c_source.html#l00633">metal_return_ngbiter()</a>, <a class="el" href="petaio_8c_source.html#l00361">petaio_write_header()</a>, <a class="el" href="density_8c_source.html#l00032">set_density_params()</a>, <a class="el" href="test__density_8c_source.html#l00034">set_init_hsml()</a>, <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>, <a class="el" href="metal__return_8c_source.html#l00923">stellar_density()</a>, and <a class="el" href="metal__return_8c_source.html#l00872">stellar_density_ngbiter()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_ac40e53af730ce9956d564e3dc18d6f0e_cgraph.svg" width="1639" height="282"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_ac40e53af730ce9956d564e3dc18d6f0e_icgraph.svg" width="2015" height="1014"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a23e510a287a10de773a4a0f14db2ff52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e510a287a10de773a4a0f14db2ff52">&#9670;&nbsp;</a></span>GetNumNgb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GetNumNgb </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>&#160;</td>
          <td class="paramname"><em>KernelType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00055">55</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="structDensityKernel.html">DensityKernel</a> <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, 1.0, KernelType);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="densitykernel_8c.html#adc7ade6568b4d241b0f46cde1d5243e2">density_kernel_desnumngb</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="ttc" id="adensitykernel_8c_html_ac964db66f17e32a55c5137c884f4b76b"><div class="ttname"><a href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a></div><div class="ttdeci">void density_kernel_init(DensityKernel *kernel, double H, enum DensityKernelType type)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00157">densitykernel.c:157</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_adc7ade6568b4d241b0f46cde1d5243e2"><div class="ttname"><a href="densitykernel_8c.html#adc7ade6568b4d241b0f46cde1d5243e2">density_kernel_desnumngb</a></div><div class="ttdeci">double density_kernel_desnumngb(DensityKernel *kernel, double eta)</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00124">densitykernel.c:124</a></div></div>
<div class="ttc" id="alightcone_8c_html_a53356309f04e9e22e9631e0be5a97b36"><div class="ttname"><a href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a></div><div class="ttdeci">static double kernel(double loga, void *params)</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00059">lightcone.c:59</a></div></div>
<div class="ttc" id="astructDensityKernel_html"><div class="ttname"><a href="structDensityKernel.html">DensityKernel</a></div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00023">densitykernel.h:23</a></div></div>
<div class="ttc" id="astructdensity__params_html_a6d8db378d6610350597a71142971d670"><div class="ttname"><a href="structdensity__params.html#a6d8db378d6610350597a71142971d670">density_params::DensityResolutionEta</a></div><div class="ttdeci">double DensityResolutionEta</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00011">density.h:11</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, <a class="el" href="density_8c_source.html#l00032">set_density_params()</a>, <a class="el" href="test__density_8c_source.html#l00034">set_init_hsml()</a>, <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>, and <a class="el" href="metal__return_8c_source.html#l00923">stellar_density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a23e510a287a10de773a4a0f14db2ff52_icgraph.svg" width="1850" height="920"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6cfed12ec8143f2406ebd7b8d140bf2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfed12ec8143f2406ebd7b8d140bf2c">&#9670;&nbsp;</a></span>set_density_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_density_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParameterSet.html">ParameterSet</a> *&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00032">32</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a> = (<span class="keyword">enum</span> <a class="code" href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a>) <a class="code" href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a>(ps, <span class="stringliteral">&quot;DensityKernelType&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">MaxNumNgbDeviation</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MaxNumNgbDeviation&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;DensityResolutionEta&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6f446e3119fb05626ccb93c492b02f9f">MinGasHsmlFractional</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MinGasHsmlFractional&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="structDensityKernel.html">DensityKernel</a> <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="densitykernel_8c.html#ac964db66f17e32a55c5137c884f4b76b">density_kernel_init</a>(&amp;<a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>, 1.0, <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a9a6f34afbd604c08a8f2ec57f7cc5e48">DensityKernelType</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;The Density Kernel type is %s\n&quot;</span>, <a class="code" href="lightcone_8c.html#a53356309f04e9e22e9631e0be5a97b36">kernel</a>.name);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(1, <span class="stringliteral">&quot;The Density resolution is %g * mean separation, or %g neighbours\n&quot;</span>,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a6d8db378d6610350597a71142971d670">DensityResolutionEta</a>, <a class="code" href="density_8c.html#a23e510a287a10de773a4a0f14db2ff52">GetNumNgb</a>(<a class="code" href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a>()));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">/*These two look like black hole parameters but they are really neighbour finding parameters*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#a8c482b6ae9dafc8a5f7f54cc2c36140d">BlackHoleNgbFactor</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;BlackHoleNgbFactor&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>.<a class="code" href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">BlackHoleMaxAccretionRadius</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;BlackHoleMaxAccretionRadius&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MPI_Bcast(&amp;<a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdensity__params.html">density_params</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="ttc" id="adensity_8c_html_ac40e53af730ce9956d564e3dc18d6f0e"><div class="ttname"><a href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a></div><div class="ttdeci">enum DensityKernelType GetDensityKernelType(void)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:63</a></div></div>
<div class="ttc" id="adensitykernel_8h_html_a1a7e46c6d567f741e1cb3953d9feeeea"><div class="ttname"><a href="densitykernel_8h.html#a1a7e46c6d567f741e1cb3953d9feeeea">DensityKernelType</a></div><div class="ttdeci">DensityKernelType</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8h_source.html#l00017">densitykernel.h:17</a></div></div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="aparamset_8c_html_abcc62489086c3bb14a61b90765e8d706"><div class="ttname"><a href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a></div><div class="ttdeci">int param_get_enum(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00378">paramset.c:378</a></div></div>
<div class="ttc" id="astructdensity__params_html"><div class="ttname"><a href="structdensity__params.html">density_params</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00009">density.h:10</a></div></div>
<div class="ttc" id="astructdensity__params_html_a5d935ae1dd13ab25a2f12c5516732943"><div class="ttname"><a href="structdensity__params.html#a5d935ae1dd13ab25a2f12c5516732943">density_params::MaxNumNgbDeviation</a></div><div class="ttdeci">double MaxNumNgbDeviation</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00012">density.h:12</a></div></div>
<div class="ttc" id="astructdensity__params_html_a8c482b6ae9dafc8a5f7f54cc2c36140d"><div class="ttname"><a href="structdensity__params.html#a8c482b6ae9dafc8a5f7f54cc2c36140d">density_params::BlackHoleNgbFactor</a></div><div class="ttdeci">double BlackHoleNgbFactor</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00015">density.h:15</a></div></div>
<div class="ttc" id="astructdensity__params_html_ac0eaafd93f45b5e11e484263fa311dbf"><div class="ttname"><a href="structdensity__params.html#ac0eaafd93f45b5e11e484263fa311dbf">density_params::BlackHoleMaxAccretionRadius</a></div><div class="ttdeci">double BlackHoleMaxAccretionRadius</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00016">density.h:16</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8h_source.html#l00016">density_params::BlackHoleMaxAccretionRadius</a>, <a class="el" href="density_8h_source.html#l00015">density_params::BlackHoleNgbFactor</a>, <a class="el" href="densitykernel_8c_source.html#l00157">density_kernel_init()</a>, <a class="el" href="density_8h_source.html#l00018">density_params::DensityKernelType</a>, <a class="el" href="density_8c_source.html#l00021">DensityParams</a>, <a class="el" href="density_8h_source.html#l00011">density_params::DensityResolutionEta</a>, <a class="el" href="density_8c_source.html#l00063">GetDensityKernelType()</a>, <a class="el" href="density_8c_source.html#l00055">GetNumNgb()</a>, <a class="el" href="lightcone_8c_source.html#l00059">kernel()</a>, <a class="el" href="density_8h_source.html#l00012">density_params::MaxNumNgbDeviation</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="density_8h_source.html#l00022">density_params::MinGasHsmlFractional</a>, <a class="el" href="paramset_8c_source.html#l00336">param_get_double()</a>, <a class="el" href="paramset_8c_source.html#l00378">param_get_enum()</a>, and <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="gadget_2params_8c_source.html#l00359">read_parameter_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a6cfed12ec8143f2406ebd7b8d140bf2c_cgraph.svg" width="1840" height="420"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a6cfed12ec8143f2406ebd7b8d140bf2c_icgraph.svg" width="468" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a539fe4bcf5b8522bc5d345799f1503e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a539fe4bcf5b8522bc5d345799f1503e1">&#9670;&nbsp;</a></span>set_densitypar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_densitypar </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdensity__params.html">density_params</a>&#160;</td>
          <td class="paramname"><em>dp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00025">25</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="density_8c.html#a9c4ca3648e6ac54cdb5adb45acc2e4e3">DensityParams</a> = dp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8c_source.html#l00021">DensityParams</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__density_8c_source.html#l00080">do_density_test()</a>, and <a class="el" href="test__density_8c_source.html#l00314">setup_density()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a539fe4bcf5b8522bc5d345799f1503e1_icgraph.svg" width="700" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6af534268ae11ed2bad17f5300af23bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af534268ae11ed2bad17f5300af23bc">&#9670;&nbsp;</a></span>slots_allocate_sph_pred_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> slots_allocate_sph_pred_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00554">554</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> sph_scratch;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/*Data is allocated high so that we can free the tree around it*/</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    sph_scratch.<a class="code" href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">EntVarPred</a> = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;EntVarPred&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * nsph);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    memset(sph_scratch.EntVarPred, 0, <span class="keyword">sizeof</span>(sph_scratch.EntVarPred[0]) * nsph);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    sph_scratch.VelPred = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;VelPred&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * 3 * nsph);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> sph_scratch;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div>
<div class="ttc" id="amymalloc_8h_html_ac576b6f19b635b512399d6afb8c20d99"><div class="ttname"><a href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a></div><div class="ttdeci">#define mymalloc2(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00016">mymalloc.h:16</a></div></div>
<div class="ttc" id="astructsph__pred__data_html"><div class="ttname"><a href="structsph__pred__data.html">sph_pred_data</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00025">density.h:26</a></div></div>
<div class="ttc" id="astructsph__pred__data_html_a4a420ff93189407b7caf7aa75779267b"><div class="ttname"><a href="structsph__pred__data.html#a4a420ff93189407b7caf7aa75779267b">sph_pred_data::EntVarPred</a></div><div class="ttdeci">MyFloat * EntVarPred</div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00028">density.h:28</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, <a class="el" href="test__density_8c_source.html#l00314">setup_density()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a6af534268ae11ed2bad17f5300af23bc_icgraph.svg" width="602" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a34cc6521a5e47836cc02baacd6986dcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34cc6521a5e47836cc02baacd6986dcf">&#9670;&nbsp;</a></span>slots_free_sph_pred_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void slots_free_sph_pred_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsph__pred__data.html">sph_pred_data</a> *&#160;</td>
          <td class="paramname"><em>sph_pred</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00665">665</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(sph_scratch-&gt;VelPred);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    sph_scratch-&gt;VelPred = NULL;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(sph_scratch-&gt;EntVarPred);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    sph_scratch-&gt;EntVarPred = NULL;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="density_8h_source.html#l00028">sph_pred_data::EntVarPred</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, and <a class="el" href="density_8h_source.html#l00034">sph_pred_data::VelPred</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, and <a class="el" href="init_8c_source.html#l00439">setup_smoothinglengths()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a34cc6521a5e47836cc02baacd6986dcf_icgraph.svg" width="647" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a300eea2fe5e00af45e3c65215ff5bfe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300eea2fe5e00af45e3c65215ff5bfe7">&#9670;&nbsp;</a></span>SPH_EntVarPred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> SPH_EntVarPred </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>PI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinEgySpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a3inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dloga</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00071">71</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">double</span> EntVarPred = <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy + <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].DtEntropy * <a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">/*Entropy limiter for the predicted entropy: makes sure entropy stays positive. */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="lightcone_8c.html#a8f3ab427b30a3327076ffcc7c683562c">dloga</a> &gt; 0 &amp;&amp; EntVarPred &lt; 0.5*<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            EntVarPred = 0.5 * <a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Entropy;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> enttou = pow(<a class="code" href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a>[PI].Density * a3inv, <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>) / <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span>(EntVarPred &lt; MinEgySpec / enttou)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            EntVarPred = MinEgySpec / enttou;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        EntVarPred = pow(EntVarPred, 1/<a class="code" href="physconst_8h.html#a8659b9de3e544ff142b153b076f30fd5">GAMMA</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span> EntVarPred;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="aphysconst_8h_html_a75216f9bf4030240b1fc0e1855e032d2"><div class="ttname"><a href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a></div><div class="ttdeci">#define GAMMA_MINUS1</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00035">physconst.h:35</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a8659b9de3e544ff142b153b076f30fd5"><div class="ttname"><a href="physconst_8h.html#a8659b9de3e544ff142b153b076f30fd5">GAMMA</a></div><div class="ttdeci">#define GAMMA</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00034">physconst.h:34</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_a8b808c4888f0bfc7723ae3ce228a9895"><div class="ttname"><a href="slotsmanager_8h.html#a8b808c4888f0bfc7723ae3ce228a9895">SphP</a></div><div class="ttdeci">#define SphP</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00119">slotsmanager.h:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lightcone_8c_source.html#l00021">dloga</a>, <a class="el" href="physconst_8h_source.html#l00034">GAMMA</a>, <a class="el" href="physconst_8h_source.html#l00035">GAMMA_MINUS1</a>, and <a class="el" href="slotsmanager_8h_source.html#l00119">SphP</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, and <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a300eea2fe5e00af45e3c65215ff5bfe7_icgraph.svg" width="2150" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a10d3cfe0024d97740707f82efde883ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d3cfe0024d97740707f82efde883ea">&#9670;&nbsp;</a></span>SPH_VelPred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPH_VelPred </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *&#160;</td>
          <td class="paramname"><em>VelPred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>FgravkickB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gravkick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hydrokick</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="density_8c_source.html#l00089">89</a> of file <a class="el" href="density_8c_source.html">density.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        VelPred[j] = <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].Vel[j] + gravkick * <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].GravAccel[j]</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            + <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].GravPM[j] * FgravkickB + hydrokick * <a class="code" href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a>(i).HydroAccel[j];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="aslotsmanager_8h_html_a681d502f5cbf25161ff026312cd1498c"><div class="ttname"><a href="slotsmanager_8h.html#a681d502f5cbf25161ff026312cd1498c">SPHP</a></div><div class="ttdeci">#define SPHP(i)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00124">slotsmanager.h:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="partmanager_8h_source.html#l00088">P</a>, and <a class="el" href="slotsmanager_8h_source.html#l00124">SPHP</a>.</p>

<p class="reference">Referenced by <a class="el" href="density_8c_source.html#l00203">density()</a>, <a class="el" href="density_8c_source.html#l00388">density_ngbiter()</a>, and <a class="el" href="hydra_8c_source.html#l00305">hydro_ngbiter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="density_8h_a10d3cfe0024d97740707f82efde883ea_icgraph.svg" width="2127" height="771"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
