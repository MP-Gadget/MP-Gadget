<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/petaio.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">petaio.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="petaio_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">    1</a></span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="string_8h.html">string.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="string_8h.html">string.h</a>&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;bigfile-mpi.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sfr__eff_8h.html">sfr_eff.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cooling_8h.html">cooling.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timestep_8h.html">timestep.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="petaio_8h.html">petaio.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slotsmanager_8h.html">slotsmanager.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hydra_8h.html">hydra.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="density_8h.html">density.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="partmanager_8h.html">partmanager.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">config.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="neutrinos__lra_8h.html">neutrinos_lra.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html">utils.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/************</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * The IO api , intented to replace io.c and read_ic.c</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * currently we have a function to register the blocks and enumerate the blocks</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structpetaio__params.html">   31</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpetaio__params.html">petaio_params</a> {</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">   32</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">BytesPerFile</a>;   <span class="comment">/* Number of bytes per physical file; this decides how many files bigfile creates each block */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">   33</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a>;    <span class="comment">/* Number of concurrent writers per file; this decides number of writers */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">   34</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a>;        <span class="comment">/* Number of concurrent writers, this caps number of writers */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">   35</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">MinNumWriters</a>;        <span class="comment">/* Min Number of concurrent writers, this caps number of writers */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">   36</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">EnableAggregatedIO</a>;  <span class="comment">/* Enable aggregated IO policy for small files.*/</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a0a9f78571a31c14e13676e376f3c40a4">   37</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structpetaio__params.html#a0a9f78571a31c14e13676e376f3c40a4">AggregatedIOThreshold</a>; <span class="comment">/* bytes per writer above which to use non-aggregated IO (avoid OOM)*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">/* Changes the comoving factors of the snapshot outputs. Set in the ICs.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">     * If UsePeculiarVelocity = 1 then snapshots save to the velocity field the physical peculiar velocity, v = a dx/dt (where x is comoving distance).</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">     * If UsePeculiarVelocity = 0 then the velocity field is a * v = a^2 dx/dt in snapshots</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">     * and v / sqrt(a) = sqrt(a) dx/dt in the ICs. Note that snapshots never match Gadget-2, which</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">     * saves physical peculiar velocity / sqrt(a) in both ICs and snapshots. */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">   43</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a4f78ba12322f124eaafa8d2e244eacd6">   44</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a4f78ba12322f124eaafa8d2e244eacd6">OutputPotential</a>;        </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a564b4ef21e716b593ab47d7b75632891">   45</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a564b4ef21e716b593ab47d7b75632891">OutputHeliumFractions</a>;  </div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">   46</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">OutputTimebins</a>;         <span class="comment">/* Flag whether to save the timebins*/</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">   47</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">SnapshotFileBase</a>[100]; <span class="comment">/* Snapshots are written to OutputDir/SnapshotFileBase_$n*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">   48</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">InitCondFile</a>[100]; <span class="comment">/* Path to read ICs from is InitCondFile */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">   50</a></span>&#160;} <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/* Struct to store constant information written to each snapshot header*/</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structheader__data.html">header_data</a> <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/*Set the IO parameters*/</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="petaio_8c.html#abe120edc74b93ec164168b08c4a4710c">   57</a></span>&#160;<a class="code" href="petaio_8c.html#abe120edc74b93ec164168b08c4a4710c">set_petaio_params</a>(<a class="code" href="structParameterSet.html">ParameterSet</a> * ps)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">BytesPerFile</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;BytesPerFile&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a> = 0; <span class="comment">/* Will be set by the Initial Condition File */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;NumWriters&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">MinNumWriters</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;MinNumWriters&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;WritersPerFile&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a0a9f78571a31c14e13676e376f3c40a4">AggregatedIOThreshold</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;AggregatedIOThreshold&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">EnableAggregatedIO</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;EnableAggregatedIO&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a4f78ba12322f124eaafa8d2e244eacd6">OutputPotential</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;OutputPotential&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">OutputTimebins</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;OutputTimebins&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a564b4ef21e716b593ab47d7b75632891">OutputHeliumFractions</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;OutputHeliumFractions&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a>(ps, <span class="stringliteral">&quot;SnapshotFileBase&quot;</span>, <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">SnapshotFileBase</a>, <span class="keyword">sizeof</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">SnapshotFileBase</a>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a>(ps, <span class="stringliteral">&quot;InitCondFile&quot;</span>, <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">InitCondFile</a>, <span class="keyword">sizeof</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">InitCondFile</a>));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    MPI_Bcast(&amp;<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structpetaio__params.html">petaio_params</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="petaio_8c.html#ab6fdd6f262d6108be8c4720ba1e0505b">   79</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="petaio_8c.html#ab6fdd6f262d6108be8c4720ba1e0505b">GetUsePeculiarVelocity</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a73c14ef51e734575530746ea9190a0d6">petaio_write_header</a>(BigFile * bf, <span class="keyword">const</span> <span class="keywordtype">double</span> atime, <span class="keyword">const</span> int64_t * <a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>, <span class="keyword">const</span> <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * data);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a0d895ac57d1a8b60d87677ee164c32ad">petaio_read_header_internal</a>(BigFile * bf, <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * data);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/* these are only used in reading in */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="petaio_8c.html#a89fdd3f9913ac2a32579155754096620">   88</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a89fdd3f9913ac2a32579155754096620">petaio_init</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">/* Smaller files will do aggregated IO.*/</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">EnableAggregatedIO</a>) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Aggregated IO is enabled\n&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        big_file_mpi_set_aggregated_threshold(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a0a9f78571a31c14e13676e376f3c40a4">AggregatedIOThreshold</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Aggregated IO is disabled.\n&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        big_file_mpi_set_aggregated_threshold(0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a> == 0)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        MPI_Comm_size(MPI_COMM_WORLD, &amp;<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/* Build a list of the first particle of each type on the current processor.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * This assumes that all particles are sorted!*/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">  113</a></span>&#160;<a class="code" href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">petaio_build_selection</a>(<span class="keywordtype">int</span> * selection,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> * ptype_offset,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> * ptype_count,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a> * Parts,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> NumPart,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">int</span> (*select_func)(<span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a> * Parts)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    )</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    ptype_offset[0] = 0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ptype_count[0] = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; NumPart; i ++) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].IsGarbage)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span>((select_func == NULL) || (select_func(i, Parts) != 0)) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = Parts[i].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            ptype_count[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] ++;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span>(i = 1; i &lt; 6; i ++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        ptype_offset[i] = ptype_offset[i-1] + ptype_count[i-1];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        ptype_count[i-1] = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    ptype_count[5] = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; NumPart; i ++) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = Parts[i].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].IsGarbage)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">if</span>((select_func == NULL) || (select_func(i, Parts) != 0)) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            selection[ptype_offset[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] + ptype_count[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>]] = i;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            ptype_count[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>]++;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="petaio_8c.html#a99bd84bc28e4a49d4cefb8dd98a5decb">  151</a></span>&#160;<a class="code" href="petaio_8c.html#a99bd84bc28e4a49d4cefb8dd98a5decb">petaio_save_snapshot</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * fname, <span class="keyword">struct</span> <a class="code" href="structIOTable.html">IOTable</a> * <a class="code" href="structIOTable.html">IOTable</a>, <span class="keywordtype">int</span> verbose, <span class="keyword">const</span> <span class="keywordtype">double</span> atime, <span class="keyword">const</span> <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;saving snapshot into %s\n&quot;</span>, fname);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    BigFile bf = {0};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_create(&amp;bf, fname, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to create snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">int</span> ptype_offset[6]={0};</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">int</span> ptype_count[6]={0};</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    int64_t <a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[6]={0};</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">int</span> * selection = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;Selection&quot;</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">petaio_build_selection</a>(selection, ptype_offset, ptype_count, <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>, NULL);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a>(6, ptype_count, <a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconversions.html">conversions</a> conv = {0};</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    conv.<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> = <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    conv.<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a> = <a class="code" href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="petaio_8c.html#a73c14ef51e734575530746ea9190a0d6">petaio_write_header</a>(&amp;bf, <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>, NTotal, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, &amp;<a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>; i ++) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">/* only process the particle blocks */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">char</span> blockname[128];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        BigArray array = {0};</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">/*This exclude FOF blocks*/</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span>(!(ptype &lt; 6 &amp;&amp; ptype &gt;= 0)) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        sprintf(blockname, <span class="stringliteral">&quot;%d/%s&quot;</span>, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">petaio_build_buffer</a>(&amp;array, &amp;<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i], selection + ptype_offset[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], ptype_count[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, &amp;conv);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a>(&amp;bf, blockname, &amp;array, verbose);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a>(&amp;array);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a>) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="neutrinos__lra_8c.html#a39c02b28bdd5e47c48690dcb7c33ee0f">petaio_save_neutrinos</a>(&amp;bf, <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_close(&amp;bf, MPI_COMM_WORLD)){</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(selection);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">char</span> *</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="petaio_8c.html#aa9f0c122d6f42044d52e588d47a01e19">  207</a></span>&#160;<a class="code" href="petaio_8c.html#aa9f0c122d6f42044d52e588d47a01e19">petaio_get_snapshot_fname</a>(<span class="keywordtype">int</span> num, <span class="keyword">const</span> <span class="keywordtype">char</span> * OutputDir)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">char</span> * fname;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span>(num == -1) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        fname = <a class="code" href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">InitCondFile</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        fname = <a class="code" href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a>(<span class="stringliteral">&quot;%s/%s_%03d&quot;</span>, OutputDir, <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">SnapshotFileBase</a>, num);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> fname;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">struct </span><a class="code" href="structheader__data.html">header_data</a></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="petaio_8c.html#a302a6962b9f0b858b487fd3e6a24cf76">petaio_read_header</a>(int num, const char * OutputDir, <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    BigFile bf = {0};</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">char</span> * fname = <a class="code" href="petaio_8c.html#aa9f0c122d6f42044d52e588d47a01e19">petaio_get_snapshot_fname</a>(num, OutputDir);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Probing Header of snapshot file: %s\n&quot;</span>, fname);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_open(&amp;bf, fname, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to open snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">struct </span><a class="code" href="structheader__data.html">header_data</a> head;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="petaio_8c.html#a0d895ac57d1a8b60d87677ee164c32ad">petaio_read_header_internal</a>(&amp;bf, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, &amp;head);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    head.neutrinonk = -1;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/* Try to read the neutrino header data from the snapshot.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     * If this fails then neutrinonk will be zero.*/</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>(num &gt;= 0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        BigBlock bn;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">if</span>(0 == big_file_mpi_open_block(&amp;bf, &amp;bn, <span class="stringliteral">&quot;Neutrino&quot;</span>, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span>(0 != big_block_get_attr(&amp;bn, <span class="stringliteral">&quot;Nkval&quot;</span>, &amp;head.neutrinonk, <span class="stringliteral">&quot;u8&quot;</span>, 1))</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to read attr: %s\n&quot;</span>, big_file_get_error_message());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            big_block_mpi_close(&amp;bn, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_close(&amp;bf, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(fname);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a> = head;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> head;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="petaio_8c.html#a18ce9fa2faeaab142a978b2293493b5d">  255</a></span>&#160;<a class="code" href="petaio_8c.html#a18ce9fa2faeaab142a978b2293493b5d">petaio_read_snapshot</a>(<span class="keywordtype">int</span> num, <span class="keyword">const</span> <span class="keywordtype">char</span> * OutputDir, <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * header, <span class="keyword">struct</span> <a class="code" href="structpart__manager__type.html">part_manager_type</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <span class="keyword">struct</span> <a class="code" href="structslots__manager__type.html">slots_manager_type</a> * <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, MPI_Comm Comm)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">char</span> * fname = <a class="code" href="petaio_8c.html#aa9f0c122d6f42044d52e588d47a01e19">petaio_get_snapshot_fname</a>(num, OutputDir);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ic = (num == -1);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    BigFile bf = {0};</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Reading snapshot %s\n&quot;</span>, fname);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_open(&amp;bf, fname, Comm)) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to open snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">/*Read neutrinos from the snapshot if necessary*/</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a>) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        MPI_Comm_rank(Comm, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">/*Read the neutrino transfer function from the ICs: init_neutrinos_lra should have been called before this!*/</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span>(ic)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="neutrinos__lra_8c.html#aa3dab78745a5f7d3f613fa29da4c2d28">petaio_read_icnutransfer</a>(&amp;bf, <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <a class="code" href="neutrinos__lra_8c.html#a5b46eee96d80ad18315e161c1cf48f03">petaio_read_neutrinos</a>(&amp;bf, <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconversions.html">conversions</a> conv = {0};</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    conv.<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> = header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    conv.<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a> = <a class="code" href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">struct </span><a class="code" href="structIOTable.html">IOTable</a> <a class="code" href="structIOTable.html">IOTable</a>[1] = {0};</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">/* Always try to read the metal tables.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">     * This lets us turn it off for a short period and then re-enable it.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">     * Note the metal fields are non-fatal so this does not break resuming without metals.*/</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">register_io_blocks</a>(<a class="code" href="structIOTable.html">IOTable</a>, 0, 1);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>; i ++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">/* only process the particle blocks */</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">char</span> blockname[128];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        BigArray array = {0};</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span>(!(ptype &lt; 6 &amp;&amp; ptype &gt;= 0)) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span>(header-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span>(ic) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="comment">/* for IC read in only three blocks */</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordtype">int</span> keep = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;Position&quot;</span>));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;Velocity&quot;</span>));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;ID&quot;</span>));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> == 5) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;Mass&quot;</span>));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;BlackholeMass&quot;</span>));</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                keep |= (0 == strcmp(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <span class="stringliteral">&quot;MinPotPos&quot;</span>));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span>(!keep) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#aca5a071ce97564cf069f4c1bbbe15894">setter</a> == NULL) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">/* FIXME: do not know how to read this block; assume the fucker is</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">             * internally intialized; */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        sprintf(blockname, <span class="stringliteral">&quot;%d/%s&quot;</span>, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="petaio_8c.html#aafe1fe998e7ca93a780ad69be4d061dc">petaio_alloc_buffer</a>(&amp;array, &amp;<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i], header-&gt;<a class="code" href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">NLocal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>]);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span>(0 == <a class="code" href="petaio_8c.html#a7a50e88c3636833ec36fa7fb07f96cb8">petaio_read_block</a>(&amp;bf, blockname, &amp;array, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#abd017805b410e444ec76f0633c530ea4">required</a>))</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <a class="code" href="petaio_8c.html#ae7642f843e7c02260f104e7963cbf380">petaio_readout_buffer</a>(&amp;array, &amp;<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i], &amp;conv, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a>(&amp;array);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a>(<a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_close(&amp;bf, Comm)) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close snapshot at %s:%s\n&quot;</span>, fname,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/* now we have IDs, set up the ID consistency between slots. */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="slotsmanager_8c.html#a0820c393c6f3cf51ae76cbf54841d128">slots_setup_id</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(fname);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span>(ic) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">         *  IC doesn&#39;t have entropy or energy; always use the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">         *  InitTemp in paramfile, then use init.c to convert to</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">         *  entropy.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">         * */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * parts = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">/* touch up the mass -- IC files save mass in header */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            parts[i].<a class="code" href="structparticle__data.html#a710e551be01f4ef85442d0928aca728c">Mass</a> = header-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[parts[i].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a>];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a> ) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">/* fixing the unit of velocity from Legacy GenIC IC */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">            #pragma omp parallel for</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="comment">/* for GenIC&#39;s Gadget-1 snapshot Unit to Gadget-2 Internal velocity unit */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">for</span>(k = 0; k &lt; 3; k++)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    parts[i].<a class="code" href="structparticle__data.html#a84dddcea5cce7e09b93965b65ddaf4e6">Vel</a>[k] *= sqrt(header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>) * header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">/* write a header block */</span></div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="petaio_8c.html#a73c14ef51e734575530746ea9190a0d6">  361</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a73c14ef51e734575530746ea9190a0d6">petaio_write_header</a>(BigFile * bf, <span class="keyword">const</span> <span class="keywordtype">double</span> atime, <span class="keyword">const</span> int64_t * NTotal, <span class="keyword">const</span> <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * data) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    BigBlock bh;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_create_block(bf, &amp;bh, <span class="stringliteral">&quot;Header&quot;</span>, NULL, 0, 0, 0, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to create block at %s:%s\n&quot;</span>, <span class="stringliteral">&quot;Header&quot;</span>,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                big_file_get_error_message());</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">/* conversion from peculiar velocity to RSD */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> hubble = <a class="code" href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, atime);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">double</span> RSD = 1.0 / (atime * hubble);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        RSD /= atime; <span class="comment">/* Conversion from internal velocity to RSD */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">int</span> dk = <a class="code" href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;TotNumPart&quot;</span>, NTotal, <span class="stringliteral">&quot;u8&quot;</span>, 6)) ||</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;TotNumPartInit&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>, <span class="stringliteral">&quot;u8&quot;</span>, 6)) ||</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;MassTable&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>, <span class="stringliteral">&quot;f8&quot;</span>, 6)) ||</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;Time&quot;</span>, &amp;atime, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;TimeIC&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;BoxSize&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">BoxSize</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;OmegaLambda&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;RSDFactor&quot;</span>, &amp;RSD, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;UsePeculiarVelocity&quot;</span>, &amp;<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>, <span class="stringliteral">&quot;i4&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;Omega0&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;CMBTemperature&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">CMBTemperature</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;OmegaBaryon&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;UnitLength_in_cm&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;UnitMass_in_g&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">UnitMass_in_g</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;UnitVelocity_in_cm_per_s&quot;</span>, &amp;data-&gt;<a class="code" href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">UnitVelocity_in_cm_per_s</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;CodeVersion&quot;</span>, <a class="code" href="config_8c.html#a82a5b237c2a6ea936d4616eb497fbcbc">GADGET_VERSION</a>, <span class="stringliteral">&quot;S1&quot;</span>, strlen(<a class="code" href="config_8c.html#a82a5b237c2a6ea936d4616eb497fbcbc">GADGET_VERSION</a>))) ||</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;CompilerSettings&quot;</span>, <a class="code" href="config_8c.html#a830d94dc6903634aac8e61f4168a75a2">GADGET_COMPILER_SETTINGS</a>, <span class="stringliteral">&quot;S1&quot;</span>, strlen(<a class="code" href="config_8c.html#a830d94dc6903634aac8e61f4168a75a2">GADGET_COMPILER_SETTINGS</a>))) ||</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;DensityKernel&quot;</span>, &amp;dk, <span class="stringliteral">&quot;i4&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    (0 != big_block_set_attr(&amp;bh, <span class="stringliteral">&quot;HubbleParam&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to write attributes %s\n&quot;</span>,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_close(&amp;bh, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close block %s\n&quot;</span>,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span></div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">  407</a></span>&#160;<a class="code" href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">_get_attr_double</a>(BigBlock * bh, <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> def)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">double</span> foo;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_get_attr(bh, <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, &amp;foo, <span class="stringliteral">&quot;f8&quot;</span>, 1)) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        foo = def;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> foo;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="petaio_8c.html#a0d57cecf1e6785931f364f14e64353c3">  416</a></span>&#160;<a class="code" href="petaio_8c.html#a0d57cecf1e6785931f364f14e64353c3">_get_attr_int</a>(BigBlock * bh, <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> def)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">int</span> foo;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_get_attr(bh, <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, &amp;foo, <span class="stringliteral">&quot;i4&quot;</span>, 1)) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        foo = def;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> foo;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="petaio_8c.html#a0d895ac57d1a8b60d87677ee164c32ad">  426</a></span>&#160;<a class="code" href="petaio_8c.html#a0d895ac57d1a8b60d87677ee164c32ad">petaio_read_header_internal</a>(BigFile * bf, <a class="code" href="structCosmology.html">Cosmology</a> * <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    BigBlock bh;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_open_block(bf, &amp;bh, <span class="stringliteral">&quot;Header&quot;</span>, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to create block at %s:%s\n&quot;</span>, <span class="stringliteral">&quot;Header&quot;</span>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">double</span> Time = 0.;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    (0 != big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;TotNumPart&quot;</span>, <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>, <span class="stringliteral">&quot;u8&quot;</span>, 6)) ||</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    (0 != big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;MassTable&quot;</span>, <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>, <span class="stringliteral">&quot;f8&quot;</span>, 6)) ||</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    (0 != big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;BoxSize&quot;</span>, &amp;<a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">BoxSize</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1)) ||</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    (0 != big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;Time&quot;</span>, &amp;Time, <span class="stringliteral">&quot;f8&quot;</span>, 1))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to read attr: %s\n&quot;</span>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a> = Time;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span>(0!= big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;TimeIC&quot;</span>, &amp;<a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1))</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a> = Time;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">/* Set a reasonable MassTable entry for stars and BHs*/</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[4] == 0)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[4] = <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[0] / <a class="code" href="sfr__eff_8c.html#a50b5665399825c31849545fe351e51ab">get_generations</a>();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[5] == 0)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[5] = <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[4];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">/* fall back to traditional MP-Gadget Units if not given in the snapshot file. */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">UnitVelocity_in_cm_per_s</a> = <a class="code" href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">_get_attr_double</a>(&amp;bh, <span class="stringliteral">&quot;UnitVelocity_in_cm_per_s&quot;</span>, 1e5); <span class="comment">/* 1 km/sec */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a> = <a class="code" href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">_get_attr_double</a>(&amp;bh, <span class="stringliteral">&quot;UnitLength_in_cm&quot;</span>,  3.085678e21); <span class="comment">/* 1.0 Kpc /h */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">UnitMass_in_g</a> = <a class="code" href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">_get_attr_double</a>(&amp;bh, <span class="stringliteral">&quot;UnitMass_in_g&quot;</span>, 1.989e43); <span class="comment">/* 1e10 Msun/h */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">double</span> OmegaBaryon = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">double</span> HubbleParam = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">double</span> OmegaLambda = <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span>(0 == big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;OmegaBaryon&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1) &amp;&amp;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            OmegaBaryon &gt; 0 &amp;&amp; fabs(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> - OmegaBaryon) &gt; 1e-3)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0,<span class="stringliteral">&quot;IC Header has Omega_b = %g but paramfile wants %g\n&quot;</span>, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a>, OmegaBaryon);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span>(0 == big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;HubbleParam&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1) &amp;&amp;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            HubbleParam &gt; 0 &amp;&amp; fabs(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a> - HubbleParam) &gt; 1e-3)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0,<span class="stringliteral">&quot;IC Header has HubbleParam = %g but paramfile wants %g\n&quot;</span>, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a>, HubbleParam);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span>(0 == big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;OmegaLambda&quot;</span>, &amp;<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a>, <span class="stringliteral">&quot;f8&quot;</span>, 1) &amp;&amp;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            OmegaLambda &gt; 0 &amp;&amp; fabs(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a> - OmegaLambda) &gt; 1e-3)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0,<span class="stringliteral">&quot;IC Header has Omega_L = %g but paramfile wants %g\n&quot;</span>, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>-&gt;<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a>, OmegaLambda);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">/* If UsePeculiarVelocity = 1 then snapshots save to the velocity field the physical peculiar velocity, v = a dx/dt (where x is comoving distance).</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">     * If UsePeculiarVelocity = 0 then the velocity field is a * v = a^2 dx/dt in snapshots</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">     * and v / sqrt(a) = sqrt(a) dx/dt in the ICs. Note that snapshots never match Gadget-2, which</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">     * saves physical peculiar velocity / sqrt(a) in both ICs and snapshots. */</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a> = <a class="code" href="petaio_8c.html#a0d57cecf1e6785931f364f14e64353c3">_get_attr_int</a>(&amp;bh, <span class="stringliteral">&quot;UsePeculiarVelocity&quot;</span>, 0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_get_attr(&amp;bh, <span class="stringliteral">&quot;TotNumPartInit&quot;</span>, <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>, <span class="stringliteral">&quot;u8&quot;</span>, 6)) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> ++) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>] = <a class="code" href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a>-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>];</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_close(&amp;bh, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close block: %s\n&quot;</span>,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="petaio_8c.html#aafe1fe998e7ca93a780ad69be4d061dc">  491</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#aafe1fe998e7ca93a780ad69be4d061dc">petaio_alloc_buffer</a>(BigArray * array, <a class="code" href="structIOTableEntry.html">IOTableEntry</a> * ent, int64_t localsize) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">size_t</span> dims[2];</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    ptrdiff_t strides[2];</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">int</span> elsize = dtype_itemsize(ent-&gt;<a class="code" href="structIOTableEntry.html#a76dbf5bd339f62204ec9af6edff35f2b">dtype</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    dims[0] = localsize;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    dims[1] = ent-&gt;<a class="code" href="structIOTableEntry.html#a2cd7cf3c7b9731be73d16e80ed389e21">items</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    strides[1] = elsize;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    strides[0] = elsize * ent-&gt;<a class="code" href="structIOTableEntry.html#a2cd7cf3c7b9731be73d16e80ed389e21">items</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">char</span> * buffer = (<span class="keywordtype">char</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;IOBUFFER&quot;</span>, dims[0] * dims[1] * elsize);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    big_array_init(array, buffer, ent-&gt;<a class="code" href="structIOTableEntry.html#a76dbf5bd339f62204ec9af6edff35f2b">dtype</a>, 2, dims, strides);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">/* readout array into P struct with setters */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="petaio_8c.html#ae7642f843e7c02260f104e7963cbf380">  506</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#ae7642f843e7c02260f104e7963cbf380">petaio_readout_buffer</a>(BigArray * array, <a class="code" href="structIOTableEntry.html">IOTableEntry</a> * ent, <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * conv, <span class="keyword">struct</span> <a class="code" href="structpart__manager__type.html">part_manager_type</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <span class="keyword">struct</span> <a class="code" href="structslots__manager__type.html">slots_manager_type</a> * <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/* fill the buffer */</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">char</span> * p = (<span class="keywordtype">char</span> *) array-&gt;data;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; PartManager-&gt;NumPart; i ++) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>[i].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a> != ent-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        ent-&gt;<a class="code" href="structIOTableEntry.html#aca5a071ce97564cf069f4c1bbbe15894">setter</a>(i, p, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, conv);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        p += array-&gt;strides[0];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/* build an IO buffer for block, based on selection</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> * only check P[ selection[i]]. If selection is NULL, just use P[i].</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> * NOTE: selected range should contain only one particle type!</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">  521</a></span>&#160;<a class="code" href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">petaio_build_buffer</a>(BigArray * array, <a class="code" href="structIOTableEntry.html">IOTableEntry</a> * ent, <span class="keyword">const</span> <span class="keywordtype">int</span> * selection, <span class="keyword">const</span> <span class="keywordtype">int</span> NumSelection, <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a> * Parts, <span class="keyword">struct</span> <a class="code" href="structslots__manager__type.html">slots_manager_type</a> * <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * conv)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span>(selection == NULL) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(-1, <span class="stringliteral">&quot;NULL selection is not supported\n&quot;</span>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">/* don&#39;t forget to free buffer after its done*/</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="petaio_8c.html#aafe1fe998e7ca93a780ad69be4d061dc">petaio_alloc_buffer</a>(array, ent, NumSelection);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">/* Fast code path if there are no such particles */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span>(NumSelection == 0) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> tid = omp_get_thread_num();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> NT = omp_get_num_threads();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> start = NumSelection * (size_t) tid / NT;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> end = NumSelection * ((size_t) tid + 1) / NT;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">/* fill the buffer */</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordtype">char</span> * p = (<span class="keywordtype">char</span> *) array-&gt;data;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        p += array-&gt;strides[0] * start;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">for</span>(i = start; i &lt; end; i ++) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> j = selection[i];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keywordflow">if</span>(Parts[j].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a> != ent-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(2, <span class="stringliteral">&quot;Selection %d has type = %d != %d\n&quot;</span>, j, Parts[j].<a class="code" href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">Type</a>, ent-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            ent-&gt;<a class="code" href="structIOTableEntry.html#ac571725e2d3247c7e038821bca7bf87f">getter</a>(j, p, Parts, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>, conv);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            p += array-&gt;strides[0];</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">/* destroy a buffer, freeing its memory */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">  557</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a>(BigArray * array) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(array-&gt;data);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">/* read a block from disk, spread the values to memory with setters  */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="petaio_8c.html#a7a50e88c3636833ec36fa7fb07f96cb8">  562</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="petaio_8c.html#a7a50e88c3636833ec36fa7fb07f96cb8">petaio_read_block</a>(BigFile * bf, <span class="keyword">const</span> <span class="keywordtype">char</span> * blockname, BigArray * array, <span class="keywordtype">int</span> required) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    BigBlock bb;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    BigBlockPtr ptr;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">/* open the block */</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_open_block(bf, &amp;bb, blockname, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span>(required)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to open block at %s:%s\n&quot;</span>, blockname, big_file_get_error_message());</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_seek(&amp;bb, &amp;ptr, 0)) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;Failed to seek block %s: %s\n&quot;</span>, blockname, big_file_get_error_message());</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_read(&amp;bb, &amp;ptr, array, <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a>, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;Failed to read from block %s: %s\n&quot;</span>, blockname, big_file_get_error_message());</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_close(&amp;bb, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close block at %s:%s\n&quot;</span>, blockname,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">/* save a block to disk */</span></div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">  587</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a>(BigFile * bf, <span class="keyword">const</span> <span class="keywordtype">char</span> * blockname, BigArray * array, <span class="keywordtype">int</span> verbose)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    BigBlock bb;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    BigBlockPtr ptr;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">int</span> elsize = big_file_dtype_itemsize(array-&gt;dtype);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">int</span> NumWriters = <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">NumWriters</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">size_t</span> size = <a class="code" href="system_8c.html#a1d471d98379273269e8045d2998eca73">count_sum</a>(array-&gt;dims[0]);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">int</span> NumFiles;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">EnableAggregatedIO</a>) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        NumFiles = (size * elsize + <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">BytesPerFile</a> - 1) / <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">BytesPerFile</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span>(NumWriters &gt; NumFiles * <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a>) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            NumWriters = NumFiles * <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Throttling NumWriters to %d.\n&quot;</span>, NumWriters);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span>(NumWriters &lt; <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">MinNumWriters</a>) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            NumWriters = <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">MinNumWriters</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            NumFiles = (NumWriters + <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a> - 1) / <a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">WritersPerFile</a> ;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Throttling NumWriters to %d.\n&quot;</span>, NumWriters);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        NumFiles = NumWriters;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">/*Do not write empty files*/</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span>(size == 0) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        NumFiles = 0;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">if</span>(verbose &amp;&amp; size &gt; 0) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Will write %td particles to %d Files for %s\n&quot;</span>, size, NumFiles, blockname);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">/* create the block */</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">/* dims[1] is the number of members per item */</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_create_block(bf, &amp;bb, blockname, array-&gt;dtype, array-&gt;dims[1], NumFiles, size, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to create block at %s:%s\n&quot;</span>, blockname,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    big_file_get_error_message());</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_seek(&amp;bb, &amp;ptr, 0)) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to seek:%s\n&quot;</span>, big_file_get_error_message());</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_write(&amp;bb, &amp;ptr, array, NumWriters, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to write :%s\n&quot;</span>, big_file_get_error_message());</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span>(verbose &amp;&amp; size &gt; 0)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Done writing %td particles to %d Files\n&quot;</span>, size, NumFiles);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">if</span>(0 != big_block_mpi_close(&amp;bb, MPI_COMM_WORLD)) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to close block at %s:%s\n&quot;</span>, blockname,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                big_file_get_error_message());</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment"> * register an IO block of name for particle type ptype.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"> * use IO_REG wrapper.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"> * with getter function getter</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"> * getter(i, output)</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"> * will fill the property of particle i to output.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"> * NOTE: dtype shall match the format of output of getter</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"> * NOTE: currently there is a hard limit (4096 blocks ).</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="petaio_8c.html#a229dcc3a89c8aa64e95e38ab0ae65ad5">  658</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a229dcc3a89c8aa64e95e38ab0ae65ad5">io_register_io_block</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> * dtype,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordtype">int</span> items,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="petaio_8h.html#a5ea6254806bbf3110f574283d3795e66">property_getter</a> getter,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="petaio_8h.html#a2b36a04af941d669d490ab774f804a58">property_setter</a> setter,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordtype">int</span> required,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keyword">struct</span> <a class="code" href="structIOTable.html">IOTable</a> * <a class="code" href="structIOTable.html">IOTable</a></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        ) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a> == <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a>) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a> = (<a class="code" href="structIOTableEntry.html">IOTableEntry</a> *) <a class="code" href="mymalloc_8h.html#a81d253773ecedbda7d865554e707489f">myrealloc</a>(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>, 2*<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a>*<span class="keyword">sizeof</span>(<a class="code" href="structIOTableEntry.html">IOTableEntry</a>));</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a> *= 2;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="structIOTableEntry.html">IOTableEntry</a> * ent = &amp;<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>];</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    strncpy(ent-&gt;<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>, <a class="code" href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, 63);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>[63] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">zorder</a> = <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a> = <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    strncpy(ent-&gt;<a class="code" href="structIOTableEntry.html#a76dbf5bd339f62204ec9af6edff35f2b">dtype</a>, dtype, 7);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#a76dbf5bd339f62204ec9af6edff35f2b">dtype</a>[7] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#ac571725e2d3247c7e038821bca7bf87f">getter</a> = getter;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#aca5a071ce97564cf069f4c1bbbe15894">setter</a> = setter;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#a2cd7cf3c7b9731be73d16e80ed389e21">items</a> = items;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    ent-&gt;<a class="code" href="structIOTableEntry.html#abd017805b410e444ec76f0633c530ea4">required</a> = required;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a> ++;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="petaio_8c.html#ad76290bb6ec4c1cf1d41ea6d499751fc">  685</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#ad76290bb6ec4c1cf1d41ea6d499751fc">GTPosition</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">/* Remove the particle offset before saving*/</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        out[d] = part[i].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>[d] - <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5462d473b8cd90abf7f7f7a56d822649">CurrentParticleOffset</a>[d];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">while</span>(out[d] &gt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>) out[d] -= <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">while</span>(out[d] &lt;= 0) out[d] += <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="petaio_8c.html#a2cc30fe5e6753cab8ec6d84adbf29216">  696</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a2cc30fe5e6753cab8ec6d84adbf29216">STPosition</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        part[i].<a class="code" href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">Pos</a>[d] = out[d];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">  704</a></span>&#160;<span class="preprocessor">#define SIMPLE_PROPERTY(name, field, type, items) \</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">    SIMPLE_GETTER(GT ## name , field, type, items, struct particle_data) \</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">    SIMPLE_SETTER(ST ## name , field, type, items, struct particle_data)</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">/*A property with getters and setters that are type specific*/</span></div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="petaio_8c.html#aa720326cfa548d617eaf46b6f75bead8">  708</a></span>&#160;<span class="preprocessor">#define SIMPLE_PROPERTY_TYPE(name, ptype, field, type, items) \</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">    SIMPLE_GETTER(GT ## ptype ## name , field, type, items, struct particle_data) \</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">    SIMPLE_SETTER(ST ## ptype ## name , field, type, items, struct particle_data)</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">/* A property that uses getters and setters via the PI of a particle data array.*/</span></div>
<div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">  713</a></span>&#160;<span class="preprocessor">#define SIMPLE_GETTER_PI(name, field, dtype, items, slottype) \</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">static void name(int i, dtype * out, void * baseptr, void * smanptr, const struct conversions * params) { \</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="preprocessor">    int PI = ((struct particle_data *) baseptr)[i].PI; \</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">    int ptype = ((struct particle_data *) baseptr)[i].Type; \</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">    struct slot_info * info = &amp;(((struct slots_manager_type *) smanptr)-&gt;info[ptype]); \</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">    slottype * sl = (slottype *) info-&gt;ptr; \</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">    int k; \</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">    for(k = 0; k &lt; items; k ++) { \</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor">        out[k] = *(&amp;(sl[PI].field) + k); \</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="preprocessor">    } \</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="petaio_8c.html#a89ccdb5232f50ba41297b3c70ef599f8">  725</a></span>&#160;<span class="preprocessor">#define SIMPLE_SETTER_PI(name, field, dtype, items, slottype) \</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="preprocessor">static void name(int i, dtype * out, void * baseptr, void * smanptr, const struct conversions * params) { \</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">    int PI = ((struct particle_data *) baseptr)[i].PI; \</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">    int ptype = ((struct particle_data *) baseptr)[i].Type; \</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">    struct slot_info * info = &amp;(((struct slots_manager_type *) smanptr)-&gt;info[ptype]); \</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">    slottype * sl = (slottype *) info-&gt;ptr; \</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">    int k; \</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor">    for(k = 0; k &lt; items; k ++) { \</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="preprocessor">        *(&amp;(sl[PI].field) + k) = out[k]; \</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">    } \</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">  737</a></span>&#160;<span class="preprocessor">#define SIMPLE_PROPERTY_PI(name, field, type, items, slottype) \</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">    SIMPLE_GETTER_PI(GT ## name , field, type, items, slottype) \</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">    SIMPLE_SETTER_PI(ST ## name , field, type, items, slottype)</span></div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">  740</a></span>&#160;<span class="preprocessor">#define SIMPLE_PROPERTY_TYPE_PI(name, ptype, field, type, items, slottype) \</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor">    SIMPLE_GETTER_PI(GT ## ptype ## name , field, type, items, slottype) \</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">    SIMPLE_SETTER_PI(ST ## ptype ## name , field, type, items, slottype)</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="petaio_8c.html#a304f97166f7f3936ca9c0b59361fb6ac">  744</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a304f97166f7f3936ca9c0b59361fb6ac">GTVelocity</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">/* Convert to Peculiar Velocity if UsePeculiarVelocity is set */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">double</span> fac;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        fac = 1.0 / params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        fac = 1.0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        out[d] = fac * part[i].<a class="code" href="structparticle__data.html#a84dddcea5cce7e09b93965b65ddaf4e6">Vel</a>[d];</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="petaio_8c.html#a28b5957862eebca113e770127c4cbd29">  759</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a28b5957862eebca113e770127c4cbd29">STVelocity</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordtype">double</span> fac;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">UsePeculiarVelocity</a>) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        fac = params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        fac = 1.0;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        part[i].<a class="code" href="structparticle__data.html#a84dddcea5cce7e09b93965b65ddaf4e6">Vel</a>[d] = out[d] * fac;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;}</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<a class="code" href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">SIMPLE_PROPERTY</a>(<a class="code" href="structparticle__data.html#a710e551be01f4ef85442d0928aca728c">Mass</a>, <a class="code" href="structparticle__data.html#a710e551be01f4ef85442d0928aca728c">Mass</a>, <span class="keywordtype">float</span>, 1)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<a class="code" href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">SIMPLE_PROPERTY</a>(<a class="code" href="structparticle__data.html#a6adea4c443a9de86d16d0b3137a67788">ID</a>, <a class="code" href="structparticle__data.html#a6adea4c443a9de86d16d0b3137a67788">ID</a>, uint64_t, 1)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<a class="code" href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">SIMPLE_PROPERTY</a>(<a class="code" href="structparticle__data.html#afe2b9d3e1632979f85f9cab4d62ea299">Generation</a>, <a class="code" href="structparticle__data.html#afe2b9d3e1632979f85f9cab4d62ea299">Generation</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, 1)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<a class="code" href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a>(GTPotential, <a class="code" href="structparticle__data.html#a1f56dd3ed661c7c03822d9767f09477c">Potential</a>, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structparticle__data.html">particle_data</a>)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<a class="code" href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a>(GTTimeBin, <a class="code" href="structparticle__data.html#a05fd8464aa98ca965a3e57109a326dd6">TimeBin</a>, <span class="keywordtype">int</span>, 1, struct <a class="code" href="structparticle__data.html">particle_data</a>)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<a class="code" href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">SIMPLE_PROPERTY</a>(SmoothingLength, <a class="code" href="structparticle__data.html#a68637c72824f83371e5ad01217c4fde6">Hsml</a>, <span class="keywordtype">float</span>, 1)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(Density, Density, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(EgyWtDensity, EgyWtDensity, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(ElectronAbundance, Ne, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(DelayTime, DelayTime, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(StarFormationTime, 4, FormationTime, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BirthDensity, BirthDensity, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(Metallicity, 4, Metallicity, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(LastEnrichmentMyr, 4, LastEnrichmentMyr, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(TotalMassReturned, 4, TotalMassReturned, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(Metallicity, 0, Metallicity, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(Metals, 4, Metals[0], <span class="keywordtype">float</span>, <a class="code" href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a>, struct <a class="code" href="structstar__particle__data.html">star_particle_data</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(Metals, 0, Metals[0], <span class="keywordtype">float</span>, <a class="code" href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a>, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTStarFormationRate, Sfr, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<a class="code" href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a>(StarFormationTime, 5, FormationTime, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeMass, <a class="code" href="structparticle__data.html#a710e551be01f4ef85442d0928aca728c">Mass</a>, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeDensity, Density, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeAccretionRate, Mdot, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeProgenitors, CountProgs, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeSwallowID, SwallowID, uint64_t, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeSwallowTime, SwallowTime, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeJumpToMinPot, JumpToMinPot, <span class="keywordtype">int</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeMtrack, Mtrack, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeMseed, Mseed, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<a class="code" href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a>(BlackholeKineticFdbkEnergy, KineticFdbkEnergy, <span class="keywordtype">float</span>, 1, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<a class="code" href="petaio_8c.html#a89ccdb5232f50ba41297b3c70ef599f8">SIMPLE_SETTER_PI</a>(STBlackholeMinPotPos , MinPotPos[0], <span class="keywordtype">double</span>, 3, struct <a class="code" href="structbh__particle__data.html">bh_particle_data</a>)</div>
<div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="petaio_8c.html#a0c1604fb9eefe0d30a45cc76dafaf70c">  806</a></span>&#160;static <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a0c1604fb9eefe0d30a45cc76dafaf70c">GTBlackholeMinPotPos</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, const struct <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">/* Remove the particle offset before saving*/</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a> = part[i].<a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[5]);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbh__particle__data.html">bh_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structbh__particle__data.html">bh_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordtype">int</span> d;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">for</span>(d = 0; d &lt; 3; d ++) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        out[d] = sl[PI].<a class="code" href="structbh__particle__data.html#a732a76510a864f4d5e1dd4c67b637aaf">MinPotPos</a>[d] - <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5462d473b8cd90abf7f7f7a56d822649">CurrentParticleOffset</a>[d];</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">while</span>(out[d] &gt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>) out[d] -= <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">while</span>(out[d] &lt;= 0) out[d] += <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">/*This is only used if FoF is enabled*/</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<a class="code" href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a>(GTGroupID, GrNr, uint32_t, 1, <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a>)</div>
<div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="petaio_8c.html#a52bacc56b79300a30f2ac8ebc1c7fd07">  822</a></span>&#160;static <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a52bacc56b79300a30f2ac8ebc1c7fd07">GTNeutralHydrogenFraction</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, const struct <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">double</span> redshift = 1./params-&gt;atime - 1;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * pl = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)+i;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a> = pl-&gt;<a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    *out = <a class="code" href="sfr__eff_8c.html#a4e4a6b5d6976b26f1ababfba475c1f4c">get_neutral_fraction_sfreff</a>(redshift, params-&gt;hubble, pl, sl+PI);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;}</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="petaio_8c.html#a7c9ab26d8fa276570275e651ef60b626">  831</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a7c9ab26d8fa276570275e651ef60b626">GTHeliumIFraction</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordtype">double</span> redshift = 1./params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> - 1;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * pl = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)+i;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a> = pl-&gt;<a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    *out = <a class="code" href="sfr__eff_8c.html#a18c2f2fb564de2ff8a5372d8bcbe0968">get_helium_neutral_fraction_sfreff</a>(0, redshift, params-&gt;<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a>, pl, sl+PI);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;}</div>
<div class="line"><a name="l00839"></a><span class="lineno"><a class="line" href="petaio_8c.html#a07cf999493947ef5a5a1c09a6eb9a811">  839</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a07cf999493947ef5a5a1c09a6eb9a811">GTHeliumIIFraction</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">double</span> redshift = 1./params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> - 1;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * pl = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)+i;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a> = pl-&gt;<a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    *out = <a class="code" href="sfr__eff_8c.html#a18c2f2fb564de2ff8a5372d8bcbe0968">get_helium_neutral_fraction_sfreff</a>(1, redshift, params-&gt;<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a>, pl, sl+PI);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="petaio_8c.html#ab79156c0afd70a6ac3953b8db5a718a3">  847</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#ab79156c0afd70a6ac3953b8db5a718a3">GTHeliumIIIFraction</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">double</span> redshift = 1./params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> - 1;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * pl = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)+i;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a> = pl-&gt;<a class="code" href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">PI</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    *out = <a class="code" href="sfr__eff_8c.html#a18c2f2fb564de2ff8a5372d8bcbe0968">get_helium_neutral_fraction_sfreff</a>(2, redshift, params-&gt;<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a>, pl, sl+PI);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;}</div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="petaio_8c.html#ac108641a87ba67ec15342ab50b0fd73b">  855</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#ac108641a87ba67ec15342ab50b0fd73b">GTInternalEnergy</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">int</span> PI = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)[i].PI;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">double</span> a3inv = 1/(params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> * params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> * params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    *out = sl[PI].<a class="code" href="structsph__particle__data.html#a1519e54bbe3cf301cd3fc1224178e4f9">Entropy</a> / <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a> * pow(sl[PI].<a class="code" href="structsph__particle__data.html#a40e26648ca8d900ec500a36a5d876ed7">Density</a> * a3inv, <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="petaio_8c.html#a866b1f592a7aaae5082fa653d62fa851">  863</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a866b1f592a7aaae5082fa653d62fa851">STInternalEnergy</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">float</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordtype">float</span> u = *out;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">int</span> PI = ((<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr)[i].PI;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keyword">struct </span><a class="code" href="structslot__info.html">slot_info</a> * info = &amp;(((<span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> *) smanptr)-&gt;info[0]);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> * sl = (<span class="keyword">struct </span><a class="code" href="structsph__particle__data.html">sph_particle_data</a> *) info-&gt;<a class="code" href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">ptr</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">double</span> a3inv = 1/(params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> * params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> * params-&gt;<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    sl[PI].<a class="code" href="structsph__particle__data.html#a1519e54bbe3cf301cd3fc1224178e4f9">Entropy</a>  = <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a> * u / pow(sl[PI].<a class="code" href="structsph__particle__data.html#a40e26648ca8d900ec500a36a5d876ed7">Density</a> * a3inv, <a class="code" href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;}</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">/* Can&#39;t use the macros because cannot take address of a bitfield*/</span></div>
<div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="petaio_8c.html#a41d1f46150ba68a2f8b8d49b5fc92427">  873</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a41d1f46150ba68a2f8b8d49b5fc92427">GTHeIIIIonized</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    *out = part[i].<a class="code" href="structparticle__data.html#a5ef3af5f8686e921896560e369878d49">HeIIIionized</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;}</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="petaio_8c.html#acf588cb445a56fbf129a926cce5a6b58">  878</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#acf588cb445a56fbf129a926cce5a6b58">STHeIIIIonized</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    part[i].<a class="code" href="structparticle__data.html#a5ef3af5f8686e921896560e369878d49">HeIIIionized</a> = *out;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div>
<div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="petaio_8c.html#a1c1179f94fcfef42fcebe73c2eb232d7">  882</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a1c1179f94fcfef42fcebe73c2eb232d7">GTSwallowed</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    *out = part[i].<a class="code" href="structparticle__data.html#a6ed5ff97d6d940a36218002cf48bff62">Swallowed</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;}</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="petaio_8c.html#abc25bbc922c9c90687c858b1c15b6a7e">  887</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#abc25bbc922c9c90687c858b1c15b6a7e">STSwallowed</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * out, <span class="keywordtype">void</span> * baseptr, <span class="keywordtype">void</span> * smanptr, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structconversions.html">conversions</a> * params) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> * part = (<span class="keyword">struct </span><a class="code" href="structparticle__data.html">particle_data</a> *) baseptr;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    part[i].<a class="code" href="structparticle__data.html#a6ed5ff97d6d940a36218002cf48bff62">Swallowed</a> = *out;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="petaio_8c.html#a54ed522ccc2f848abe664cfa255a6305">  892</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="petaio_8c.html#a54ed522ccc2f848abe664cfa255a6305">order_by_type</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structIOTableEntry.html">IOTableEntry</a> * pa  = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structIOTableEntry.html">IOTableEntry</a> *) a;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structIOTableEntry.html">IOTableEntry</a> * pb  = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structIOTableEntry.html">IOTableEntry</a> *) b;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">if</span>(pa-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a> &lt; pb-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span>(pa-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a> &gt; pb-&gt;<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">return</span> +1;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span>(pa-&gt;<a class="code" href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">zorder</a> &lt; pb-&gt;<a class="code" href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">zorder</a>)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span>(pa-&gt;<a class="code" href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">zorder</a> &gt; pb-&gt;<a class="code" href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">zorder</a>)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno"><a class="line" href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">  909</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">register_io_blocks</a>(<span class="keyword">struct</span> <a class="code" href="structIOTable.html">IOTable</a> * <a class="code" href="structIOTable.html">IOTable</a>, <span class="keywordtype">int</span> WriteGroupID, <span class="keywordtype">int</span> MetalReturnOn)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;{</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a> = 0;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a> = 100;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a> = (<a class="code" href="structIOTableEntry.html">IOTableEntry</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;IOTable&quot;</span>, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a> * <span class="keyword">sizeof</span>(<a class="code" href="structIOTableEntry.html">IOTableEntry</a>));</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">/* Bare Bone Gravity*/</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 6; i ++) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">/* We put Mass first because sometimes there is</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">         * corruption in the first array and we can recover from Mass corruption*/</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Mass,     <span class="stringliteral">&quot;f4&quot;</span>, 1, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Position, <span class="stringliteral">&quot;f8&quot;</span>, 3, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Velocity, <span class="stringliteral">&quot;f4&quot;</span>, 3, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(ID,       <span class="stringliteral">&quot;u8&quot;</span>, 1, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a4f78ba12322f124eaafa8d2e244eacd6">OutputPotential</a>)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(Potential, <span class="stringliteral">&quot;f4&quot;</span>, 1, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span>(WriteGroupID)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(GroupID, <span class="stringliteral">&quot;u4&quot;</span>, 1, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">OutputTimebins</a>)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(TimeBin,       <span class="stringliteral">&quot;u4&quot;</span>, 1, i, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Generation,       <span class="stringliteral">&quot;u1&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Generation,       <span class="stringliteral">&quot;u1&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Generation,       <span class="stringliteral">&quot;u1&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">/* Bare Bone SPH*/</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(SmoothingLength,  <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(Density,          <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a>())</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(EgyWtDensity,          <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">/* On reload this sets the Entropy variable, need the densities.</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">     * Register this after Density and EgyWtDensity will ensure density is read</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">     * before this. */</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(InternalEnergy,   <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">/* Cooling */</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(ElectronAbundance,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(NeutralHydrogenFraction, <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a564b4ef21e716b593ab47d7b75632891">OutputHeliumFractions</a>) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(HeliumIFraction, <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(HeliumIIFraction, <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(HeliumIIIFraction, <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">/* Marks whether a particle has been HeIII ionized yet*/</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(HeIIIIonized, <span class="stringliteral">&quot;u1&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">/* SF */</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(StarFormationRate, <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">/* Another new addition: save the DelayTime for wind particles*/</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(DelayTime,  <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(BirthDensity, <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(StarFormationTime, <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(Metallicity,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(Metallicity,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span>(MetalReturnOn) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(Metals,       <span class="stringliteral">&quot;f4&quot;</span>, <a class="code" href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a>, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(Metals,       <span class="stringliteral">&quot;f4&quot;</span>, <a class="code" href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a>, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(LastEnrichmentMyr, <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(TotalMassReturned, <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(SmoothingLength,  <span class="stringliteral">&quot;f4&quot;</span>, 1, 4, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">/* end SF */</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">/* Black hole */</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a>(StarFormationTime, <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeMass,          <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeDensity,          <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeAccretionRate, <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeProgenitors,   <span class="stringliteral">&quot;i4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeMinPotPos, <span class="stringliteral">&quot;f8&quot;</span>, 3, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeJumpToMinPot,   <span class="stringliteral">&quot;i4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a>(BlackholeMtrack,         <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(BlackholeMseed,         <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(BlackholeKineticFdbkEnergy, <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">/* Smoothing lengths for black hole: this is a new addition*/</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(SmoothingLength,  <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">/* Marks whether a BH particle has been swallowed*/</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(Swallowed, <span class="stringliteral">&quot;u1&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">/* ID of the swallowing black hole particle. If == -1, then particle is live*/</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(BlackholeSwallowID, <span class="stringliteral">&quot;u8&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">/* Time the BH was swallowed*/</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a>(BlackholeSwallowTime, <span class="stringliteral">&quot;f4&quot;</span>, 1, 5, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">/*Sort IO blocks so similar types are together; then ordered by the sequence they are declared. */</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a>(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structIOTableEntry.html">IOTableEntry</a>), <a class="code" href="petaio_8c.html#a54ed522ccc2f848abe664cfa255a6305">order_by_type</a>);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">/* Add extra debug blocks to the output*/</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/* Write (but don&#39;t read) them, only useful for debugging the particle structures.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"> * Warning: future code versions may change the units!*/</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<a class="code" href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a>(GTGravAccel, GravAccel[0], <span class="keywordtype">float</span>, 3, <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a>)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<a class="code" href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a>(GTGravPM, <a class="code" href="gravpm_8c.html#ad87ae67d47af9b3b87d59c50c4f2f781">GravPM</a>[0], <span class="keywordtype">float</span>, 3, <span class="keyword">struct</span> <a class="code" href="structparticle__data.html">particle_data</a>)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTHydroAccel, HydroAccel[0], <span class="keywordtype">float</span>, 3, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTMaxSignalVel, MaxSignalVel, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTEntropy, Entropy, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTDtEntropy, DtEntropy, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTDhsmlEgyDensityFactor, DhsmlEgyDensityFactor, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTDivVel, DivVel, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<a class="code" href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a>(GTCurlVel, CurlVel, <span class="keywordtype">float</span>, 1, <span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="petaio_8c.html#aa7a13b13b421e189d663685fff0c1018"> 1014</a></span>&#160;void <a class="code" href="petaio_8c.html#aa7a13b13b421e189d663685fff0c1018">register_debug_io_blocks</a>(struct <a class="code" href="structIOTable.html">IOTable</a> * <a class="code" href="structIOTable.html">IOTable</a>)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = 0; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> &lt; 6; <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>++) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(GravAccel,       <span class="stringliteral">&quot;f4&quot;</span>, 3, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(<a class="code" href="gravpm_8c.html#ad87ae67d47af9b3b87d59c50c4f2f781">GravPM</a>,       <span class="stringliteral">&quot;f4&quot;</span>, 3, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a>.<a class="code" href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">OutputTimebins</a>) <span class="comment">/* Otherwise it is output in the regular blocks*/</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(TimeBin,       <span class="stringliteral">&quot;u4&quot;</span>, 1, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(HydroAccel,       <span class="stringliteral">&quot;f4&quot;</span>, 3, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(MaxSignalVel,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(Entropy,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(DtEntropy,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(DhsmlEgyDensityFactor,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(DivVel,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a>(CurlVel,       <span class="stringliteral">&quot;f4&quot;</span>, 1, 0, <a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">/*Sort IO blocks so similar types are together; then ordered by the sequence they are declared. */</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a>(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>, <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structIOTableEntry.html">IOTableEntry</a>), <a class="code" href="petaio_8c.html#a54ed522ccc2f848abe664cfa255a6305">order_by_type</a>);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379"> 1034</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a>(<span class="keyword">struct</span> <a class="code" href="structIOTable.html">IOTable</a> * <a class="code" href="structIOTable.html">IOTable</a>) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(<a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="structIOTable.html">IOTable</a>-&gt;<a class="code" href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">allocated</a> = 0;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div>
<div class="ttc" id="aconfig_8c_html_a82a5b237c2a6ea936d4616eb497fbcbc"><div class="ttname"><a href="config_8c.html#a82a5b237c2a6ea936d4616eb497fbcbc">GADGET_VERSION</a></div><div class="ttdeci">const char * GADGET_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="config_8c_source.html#l00007">config.c:7</a></div></div>
<div class="ttc" id="aconfig_8c_html_a830d94dc6903634aac8e61f4168a75a2"><div class="ttname"><a href="config_8c.html#a830d94dc6903634aac8e61f4168a75a2">GADGET_COMPILER_SETTINGS</a></div><div class="ttdeci">const char * GADGET_COMPILER_SETTINGS</div><div class="ttdef"><b>Definition:</b> <a href="config_8c_source.html#l00001">config.c:1</a></div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="acooling_8h_html"><div class="ttname"><a href="cooling_8h.html">cooling.h</a></div></div>
<div class="ttc" id="acosmology_8c_html_ab425f16e6fe06110e2fb4944065b81bb"><div class="ttname"><a href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a></div><div class="ttdeci">double hubble_function(const Cosmology *CP, double a)</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8c_source.html#l00058">cosmology.c:58</a></div></div>
<div class="ttc" id="adensity_8c_html_ac40e53af730ce9956d564e3dc18d6f0e"><div class="ttname"><a href="density_8c.html#ac40e53af730ce9956d564e3dc18d6f0e">GetDensityKernelType</a></div><div class="ttdeci">enum DensityKernelType GetDensityKernelType(void)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00055">density.c:63</a></div></div>
<div class="ttc" id="adensity_8h_html"><div class="ttname"><a href="density_8h.html">density.h</a></div></div>
<div class="ttc" id="adensitykernel_8c_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="densitykernel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="densitykernel_8c_source.html#l00093">densitykernel.c:93</a></div></div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
<div class="ttc" id="agravpm_8c_html_ad87ae67d47af9b3b87d59c50c4f2f781"><div class="ttname"><a href="gravpm_8c.html#ad87ae67d47af9b3b87d59c50c4f2f781">GravPM</a></div><div class="ttdeci">static struct gravpm_params GravPM</div></div>
<div class="ttc" id="ahydra_8c_html_ad2e04e2dce31315c1541bbea55f33d2a"><div class="ttname"><a href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a></div><div class="ttdeci">int DensityIndependentSphOn(void)</div><div class="ttdef"><b>Definition:</b> <a href="hydra_8c_source.html#l00049">hydra.c:49</a></div></div>
<div class="ttc" id="ahydra_8h_html"><div class="ttname"><a href="hydra_8h.html">hydra.h</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a81d253773ecedbda7d865554e707489f"><div class="ttname"><a href="mymalloc_8h.html#a81d253773ecedbda7d865554e707489f">myrealloc</a></div><div class="ttdeci">#define myrealloc(ptr, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00018">mymalloc.h:18</a></div></div>
<div class="ttc" id="amymalloc_8h_html_ac576b6f19b635b512399d6afb8c20d99"><div class="ttname"><a href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a></div><div class="ttdeci">#define mymalloc2(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00016">mymalloc.h:16</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="aneutrinos__lra_8c_html_a39c02b28bdd5e47c48690dcb7c33ee0f"><div class="ttname"><a href="neutrinos__lra_8c.html#a39c02b28bdd5e47c48690dcb7c33ee0f">petaio_save_neutrinos</a></div><div class="ttdeci">void petaio_save_neutrinos(BigFile *bf, int ThisTask)</div><div class="ttdef"><b>Definition:</b> <a href="neutrinos__lra_8c_source.html#l00265">neutrinos_lra.c:265</a></div></div>
<div class="ttc" id="aneutrinos__lra_8c_html_a5b46eee96d80ad18315e161c1cf48f03"><div class="ttname"><a href="neutrinos__lra_8c.html#a5b46eee96d80ad18315e161c1cf48f03">petaio_read_neutrinos</a></div><div class="ttdeci">void petaio_read_neutrinos(BigFile *bf, int ThisTask)</div><div class="ttdef"><b>Definition:</b> <a href="neutrinos__lra_8c_source.html#l00376">neutrinos_lra.c:376</a></div></div>
<div class="ttc" id="aneutrinos__lra_8c_html_aa3dab78745a5f7d3f613fa29da4c2d28"><div class="ttname"><a href="neutrinos__lra_8c.html#aa3dab78745a5f7d3f613fa29da4c2d28">petaio_read_icnutransfer</a></div><div class="ttdeci">void petaio_read_icnutransfer(BigFile *bf, int ThisTask)</div><div class="ttdef"><b>Definition:</b> <a href="neutrinos__lra_8c_source.html#l00317">neutrinos_lra.c:317</a></div></div>
<div class="ttc" id="aneutrinos__lra_8h_html"><div class="ttname"><a href="neutrinos__lra_8h.html">neutrinos_lra.h</a></div></div>
<div class="ttc" id="aparamset_8c_html_a1f6042209e35f2497db00411eb03a495"><div class="ttname"><a href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a></div><div class="ttdeci">void param_get_string2(ParameterSet *ps, const char *name, char *dst, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00355">paramset.c:355</a></div></div>
<div class="ttc" id="aparamset_8c_html_a6228c17649c46aef53e74cd7ccb93fb0"><div class="ttname"><a href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a></div><div class="ttdeci">int param_get_int(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00368">paramset.c:368</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html"><div class="ttname"><a href="partmanager_8h.html">partmanager.h</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="apetaio_8c_html_a00bc8b1ba2ab1de94d983b08b14580c7"><div class="ttname"><a href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a></div><div class="ttdeci">void petaio_destroy_buffer(BigArray *array)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00557">petaio.c:557</a></div></div>
<div class="ttc" id="apetaio_8c_html_a0419b189568e38417ec76fd205f38304"><div class="ttname"><a href="petaio_8c.html#a0419b189568e38417ec76fd205f38304">SIMPLE_GETTER_PI</a></div><div class="ttdeci">#define SIMPLE_GETTER_PI(name, field, dtype, items, slottype)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00713">petaio.c:713</a></div></div>
<div class="ttc" id="apetaio_8c_html_a07cf999493947ef5a5a1c09a6eb9a811"><div class="ttname"><a href="petaio_8c.html#a07cf999493947ef5a5a1c09a6eb9a811">GTHeliumIIFraction</a></div><div class="ttdeci">static void GTHeliumIIFraction(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00839">petaio.c:839</a></div></div>
<div class="ttc" id="apetaio_8c_html_a0c1604fb9eefe0d30a45cc76dafaf70c"><div class="ttname"><a href="petaio_8c.html#a0c1604fb9eefe0d30a45cc76dafaf70c">GTBlackholeMinPotPos</a></div><div class="ttdeci">static void GTBlackholeMinPotPos(int i, double *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00806">petaio.c:806</a></div></div>
<div class="ttc" id="apetaio_8c_html_a0d57cecf1e6785931f364f14e64353c3"><div class="ttname"><a href="petaio_8c.html#a0d57cecf1e6785931f364f14e64353c3">_get_attr_int</a></div><div class="ttdeci">static int _get_attr_int(BigBlock *bh, const char *name, const int def)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00416">petaio.c:416</a></div></div>
<div class="ttc" id="apetaio_8c_html_a0d895ac57d1a8b60d87677ee164c32ad"><div class="ttname"><a href="petaio_8c.html#a0d895ac57d1a8b60d87677ee164c32ad">petaio_read_header_internal</a></div><div class="ttdeci">static void petaio_read_header_internal(BigFile *bf, Cosmology *CP, struct header_data *data)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00426">petaio.c:426</a></div></div>
<div class="ttc" id="apetaio_8c_html_a18ce9fa2faeaab142a978b2293493b5d"><div class="ttname"><a href="petaio_8c.html#a18ce9fa2faeaab142a978b2293493b5d">petaio_read_snapshot</a></div><div class="ttdeci">void petaio_read_snapshot(int num, const char *OutputDir, Cosmology *CP, struct header_data *header, struct part_manager_type *PartManager, struct slots_manager_type *SlotsManager, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00255">petaio.c:255</a></div></div>
<div class="ttc" id="apetaio_8c_html_a1ab7a88228a6b7d76399c221d467770b"><div class="ttname"><a href="petaio_8c.html#a1ab7a88228a6b7d76399c221d467770b">SIMPLE_PROPERTY</a></div><div class="ttdeci">#define SIMPLE_PROPERTY(name, field, type, items)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00704">petaio.c:704</a></div></div>
<div class="ttc" id="apetaio_8c_html_a1c1179f94fcfef42fcebe73c2eb232d7"><div class="ttname"><a href="petaio_8c.html#a1c1179f94fcfef42fcebe73c2eb232d7">GTSwallowed</a></div><div class="ttdeci">static void GTSwallowed(int i, unsigned char *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00882">petaio.c:882</a></div></div>
<div class="ttc" id="apetaio_8c_html_a1c871e65271b0182ecf7d82dfc0c97ae"><div class="ttname"><a href="petaio_8c.html#a1c871e65271b0182ecf7d82dfc0c97ae">IO</a></div><div class="ttdeci">static struct petaio_params IO</div></div>
<div class="ttc" id="apetaio_8c_html_a229dcc3a89c8aa64e95e38ab0ae65ad5"><div class="ttname"><a href="petaio_8c.html#a229dcc3a89c8aa64e95e38ab0ae65ad5">io_register_io_block</a></div><div class="ttdeci">void io_register_io_block(const char *name, const char *dtype, int items, int ptype, property_getter getter, property_setter setter, int required, struct IOTable *IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00658">petaio.c:658</a></div></div>
<div class="ttc" id="apetaio_8c_html_a28b5957862eebca113e770127c4cbd29"><div class="ttname"><a href="petaio_8c.html#a28b5957862eebca113e770127c4cbd29">STVelocity</a></div><div class="ttdeci">static void STVelocity(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00759">petaio.c:759</a></div></div>
<div class="ttc" id="apetaio_8c_html_a2cc30fe5e6753cab8ec6d84adbf29216"><div class="ttname"><a href="petaio_8c.html#a2cc30fe5e6753cab8ec6d84adbf29216">STPosition</a></div><div class="ttdeci">static void STPosition(int i, double *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00696">petaio.c:696</a></div></div>
<div class="ttc" id="apetaio_8c_html_a302a6962b9f0b858b487fd3e6a24cf76"><div class="ttname"><a href="petaio_8c.html#a302a6962b9f0b858b487fd3e6a24cf76">petaio_read_header</a></div><div class="ttdeci">struct header_data petaio_read_header(int num, const char *OutputDir, Cosmology *CP)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00207">petaio.c:219</a></div></div>
<div class="ttc" id="apetaio_8c_html_a304f97166f7f3936ca9c0b59361fb6ac"><div class="ttname"><a href="petaio_8c.html#a304f97166f7f3936ca9c0b59361fb6ac">GTVelocity</a></div><div class="ttdeci">static void GTVelocity(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00744">petaio.c:744</a></div></div>
<div class="ttc" id="apetaio_8c_html_a329a32cec3055c120a2b868dc53df379"><div class="ttname"><a href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a></div><div class="ttdeci">void destroy_io_blocks(struct IOTable *IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l01034">petaio.c:1034</a></div></div>
<div class="ttc" id="apetaio_8c_html_a41d1f46150ba68a2f8b8d49b5fc92427"><div class="ttname"><a href="petaio_8c.html#a41d1f46150ba68a2f8b8d49b5fc92427">GTHeIIIIonized</a></div><div class="ttdeci">static void GTHeIIIIonized(int i, unsigned char *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00873">petaio.c:873</a></div></div>
<div class="ttc" id="apetaio_8c_html_a52bacc56b79300a30f2ac8ebc1c7fd07"><div class="ttname"><a href="petaio_8c.html#a52bacc56b79300a30f2ac8ebc1c7fd07">GTNeutralHydrogenFraction</a></div><div class="ttdeci">static void GTNeutralHydrogenFraction(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00822">petaio.c:822</a></div></div>
<div class="ttc" id="apetaio_8c_html_a54ed522ccc2f848abe664cfa255a6305"><div class="ttname"><a href="petaio_8c.html#a54ed522ccc2f848abe664cfa255a6305">order_by_type</a></div><div class="ttdeci">static int order_by_type(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00892">petaio.c:892</a></div></div>
<div class="ttc" id="apetaio_8c_html_a6d0888c0dbd0c70b0de352d0352c9906"><div class="ttname"><a href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">register_io_blocks</a></div><div class="ttdeci">void register_io_blocks(struct IOTable *IOTable, int WriteGroupID, int MetalReturnOn)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00909">petaio.c:909</a></div></div>
<div class="ttc" id="apetaio_8c_html_a6e5c65e14b8bde8d32c7a4f96f223498"><div class="ttname"><a href="petaio_8c.html#a6e5c65e14b8bde8d32c7a4f96f223498">Header</a></div><div class="ttdeci">static struct header_data Header</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00001">petaio.c:53</a></div></div>
<div class="ttc" id="apetaio_8c_html_a73c14ef51e734575530746ea9190a0d6"><div class="ttname"><a href="petaio_8c.html#a73c14ef51e734575530746ea9190a0d6">petaio_write_header</a></div><div class="ttdeci">static void petaio_write_header(BigFile *bf, const double atime, const int64_t *NTotal, const Cosmology *CP, const struct header_data *data)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00361">petaio.c:361</a></div></div>
<div class="ttc" id="apetaio_8c_html_a7a50e88c3636833ec36fa7fb07f96cb8"><div class="ttname"><a href="petaio_8c.html#a7a50e88c3636833ec36fa7fb07f96cb8">petaio_read_block</a></div><div class="ttdeci">int petaio_read_block(BigFile *bf, const char *blockname, BigArray *array, int required)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00562">petaio.c:562</a></div></div>
<div class="ttc" id="apetaio_8c_html_a7c9ab26d8fa276570275e651ef60b626"><div class="ttname"><a href="petaio_8c.html#a7c9ab26d8fa276570275e651ef60b626">GTHeliumIFraction</a></div><div class="ttdeci">static void GTHeliumIFraction(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00831">petaio.c:831</a></div></div>
<div class="ttc" id="apetaio_8c_html_a866b1f592a7aaae5082fa653d62fa851"><div class="ttname"><a href="petaio_8c.html#a866b1f592a7aaae5082fa653d62fa851">STInternalEnergy</a></div><div class="ttdeci">static void STInternalEnergy(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00863">petaio.c:863</a></div></div>
<div class="ttc" id="apetaio_8c_html_a89ccdb5232f50ba41297b3c70ef599f8"><div class="ttname"><a href="petaio_8c.html#a89ccdb5232f50ba41297b3c70ef599f8">SIMPLE_SETTER_PI</a></div><div class="ttdeci">#define SIMPLE_SETTER_PI(name, field, dtype, items, slottype)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00725">petaio.c:725</a></div></div>
<div class="ttc" id="apetaio_8c_html_a89fdd3f9913ac2a32579155754096620"><div class="ttname"><a href="petaio_8c.html#a89fdd3f9913ac2a32579155754096620">petaio_init</a></div><div class="ttdeci">void petaio_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00088">petaio.c:88</a></div></div>
<div class="ttc" id="apetaio_8c_html_a99bd84bc28e4a49d4cefb8dd98a5decb"><div class="ttname"><a href="petaio_8c.html#a99bd84bc28e4a49d4cefb8dd98a5decb">petaio_save_snapshot</a></div><div class="ttdeci">void petaio_save_snapshot(const char *fname, struct IOTable *IOTable, int verbose, const double atime, const Cosmology *CP)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00151">petaio.c:151</a></div></div>
<div class="ttc" id="apetaio_8c_html_aa7a13b13b421e189d663685fff0c1018"><div class="ttname"><a href="petaio_8c.html#aa7a13b13b421e189d663685fff0c1018">register_debug_io_blocks</a></div><div class="ttdeci">void register_debug_io_blocks(struct IOTable *IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l01014">petaio.c:1014</a></div></div>
<div class="ttc" id="apetaio_8c_html_aa9f0c122d6f42044d52e588d47a01e19"><div class="ttname"><a href="petaio_8c.html#aa9f0c122d6f42044d52e588d47a01e19">petaio_get_snapshot_fname</a></div><div class="ttdeci">char * petaio_get_snapshot_fname(int num, const char *OutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00207">petaio.c:207</a></div></div>
<div class="ttc" id="apetaio_8c_html_aacb623e82f8c6aa12d46c1c6e010bd9f"><div class="ttname"><a href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">petaio_build_selection</a></div><div class="ttdeci">void petaio_build_selection(int *selection, int *ptype_offset, int *ptype_count, const struct particle_data *Parts, const int NumPart, int(*select_func)(int i, const struct particle_data *Parts))</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00113">petaio.c:113</a></div></div>
<div class="ttc" id="apetaio_8c_html_aafe1fe998e7ca93a780ad69be4d061dc"><div class="ttname"><a href="petaio_8c.html#aafe1fe998e7ca93a780ad69be4d061dc">petaio_alloc_buffer</a></div><div class="ttdeci">void petaio_alloc_buffer(BigArray *array, IOTableEntry *ent, int64_t localsize)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00491">petaio.c:491</a></div></div>
<div class="ttc" id="apetaio_8c_html_ab6fdd6f262d6108be8c4720ba1e0505b"><div class="ttname"><a href="petaio_8c.html#ab6fdd6f262d6108be8c4720ba1e0505b">GetUsePeculiarVelocity</a></div><div class="ttdeci">int GetUsePeculiarVelocity(void)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00079">petaio.c:79</a></div></div>
<div class="ttc" id="apetaio_8c_html_ab79156c0afd70a6ac3953b8db5a718a3"><div class="ttname"><a href="petaio_8c.html#ab79156c0afd70a6ac3953b8db5a718a3">GTHeliumIIIFraction</a></div><div class="ttdeci">static void GTHeliumIIIFraction(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00847">petaio.c:847</a></div></div>
<div class="ttc" id="apetaio_8c_html_abc25bbc922c9c90687c858b1c15b6a7e"><div class="ttname"><a href="petaio_8c.html#abc25bbc922c9c90687c858b1c15b6a7e">STSwallowed</a></div><div class="ttdeci">static void STSwallowed(int i, unsigned char *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00887">petaio.c:887</a></div></div>
<div class="ttc" id="apetaio_8c_html_abe120edc74b93ec164168b08c4a4710c"><div class="ttname"><a href="petaio_8c.html#abe120edc74b93ec164168b08c4a4710c">set_petaio_params</a></div><div class="ttdeci">void set_petaio_params(ParameterSet *ps)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00057">petaio.c:57</a></div></div>
<div class="ttc" id="apetaio_8c_html_ac108641a87ba67ec15342ab50b0fd73b"><div class="ttname"><a href="petaio_8c.html#ac108641a87ba67ec15342ab50b0fd73b">GTInternalEnergy</a></div><div class="ttdeci">static void GTInternalEnergy(int i, float *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00855">petaio.c:855</a></div></div>
<div class="ttc" id="apetaio_8c_html_aca46e674c5a694ce6252374fde2b37c1"><div class="ttname"><a href="petaio_8c.html#aca46e674c5a694ce6252374fde2b37c1">SIMPLE_PROPERTY_TYPE_PI</a></div><div class="ttdeci">#define SIMPLE_PROPERTY_TYPE_PI(name, ptype, field, type, items, slottype)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00740">petaio.c:740</a></div></div>
<div class="ttc" id="apetaio_8c_html_acf588cb445a56fbf129a926cce5a6b58"><div class="ttname"><a href="petaio_8c.html#acf588cb445a56fbf129a926cce5a6b58">STHeIIIIonized</a></div><div class="ttdeci">static void STHeIIIIonized(int i, unsigned char *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00878">petaio.c:878</a></div></div>
<div class="ttc" id="apetaio_8c_html_ad76290bb6ec4c1cf1d41ea6d499751fc"><div class="ttname"><a href="petaio_8c.html#ad76290bb6ec4c1cf1d41ea6d499751fc">GTPosition</a></div><div class="ttdeci">static void GTPosition(int i, double *out, void *baseptr, void *smanptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00685">petaio.c:685</a></div></div>
<div class="ttc" id="apetaio_8c_html_ad7b91d2323ffc8919df52d90c9f3b6f2"><div class="ttname"><a href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">petaio_build_buffer</a></div><div class="ttdeci">void petaio_build_buffer(BigArray *array, IOTableEntry *ent, const int *selection, const int NumSelection, struct particle_data *Parts, struct slots_manager_type *SlotsManager, struct conversions *conv)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00521">petaio.c:521</a></div></div>
<div class="ttc" id="apetaio_8c_html_ae7642f843e7c02260f104e7963cbf380"><div class="ttname"><a href="petaio_8c.html#ae7642f843e7c02260f104e7963cbf380">petaio_readout_buffer</a></div><div class="ttdeci">void petaio_readout_buffer(BigArray *array, IOTableEntry *ent, struct conversions *conv, struct part_manager_type *PartManager, struct slots_manager_type *SlotsManager)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00506">petaio.c:506</a></div></div>
<div class="ttc" id="apetaio_8c_html_af02050b2cb4585859b5ed6508ab86f26"><div class="ttname"><a href="petaio_8c.html#af02050b2cb4585859b5ed6508ab86f26">SIMPLE_PROPERTY_PI</a></div><div class="ttdeci">#define SIMPLE_PROPERTY_PI(name, field, type, items, slottype)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00737">petaio.c:737</a></div></div>
<div class="ttc" id="apetaio_8c_html_af6f495a272ad8ddce896b809aa18ad16"><div class="ttname"><a href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a></div><div class="ttdeci">void petaio_save_block(BigFile *bf, const char *blockname, BigArray *array, int verbose)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00587">petaio.c:587</a></div></div>
<div class="ttc" id="apetaio_8c_html_af7b4da515adf0af094febf56f5149b3c"><div class="ttname"><a href="petaio_8c.html#af7b4da515adf0af094febf56f5149b3c">_get_attr_double</a></div><div class="ttdeci">static double _get_attr_double(BigBlock *bh, const char *name, const double def)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00407">petaio.c:407</a></div></div>
<div class="ttc" id="apetaio_8h_html"><div class="ttname"><a href="petaio_8h.html">petaio.h</a></div></div>
<div class="ttc" id="apetaio_8h_html_a2b36a04af941d669d490ab774f804a58"><div class="ttname"><a href="petaio_8h.html#a2b36a04af941d669d490ab774f804a58">property_setter</a></div><div class="ttdeci">void(* property_setter)(int i, void *target, void *baseptr, void *slotptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00046">petaio.h:46</a></div></div>
<div class="ttc" id="apetaio_8h_html_a2f674bdbb99903a85ae61e4c7afb688f"><div class="ttname"><a href="petaio_8h.html#a2f674bdbb99903a85ae61e4c7afb688f">SIMPLE_GETTER</a></div><div class="ttdeci">#define SIMPLE_GETTER(name, field, type, items, stype)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00145">petaio.h:145</a></div></div>
<div class="ttc" id="apetaio_8h_html_a3fdfa786bd651881e49e723acfac457f"><div class="ttname"><a href="petaio_8h.html#a3fdfa786bd651881e49e723acfac457f">IO_REG_WRONLY</a></div><div class="ttdeci">#define IO_REG_WRONLY(name, dtype, items, ptype, IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00117">petaio.h:117</a></div></div>
<div class="ttc" id="apetaio_8h_html_a5ea6254806bbf3110f574283d3795e66"><div class="ttname"><a href="petaio_8h.html#a5ea6254806bbf3110f574283d3795e66">property_getter</a></div><div class="ttdeci">void(* property_getter)(int i, void *result, void *baseptr, void *slotptr, const struct conversions *params)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00045">petaio.h:45</a></div></div>
<div class="ttc" id="apetaio_8h_html_abbf3e5cae8b26eb7109e39d05ad562ca"><div class="ttname"><a href="petaio_8h.html#abbf3e5cae8b26eb7109e39d05ad562ca">IO_REG</a></div><div class="ttdeci">#define IO_REG(name, dtype, items, ptype, IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00113">petaio.h:113</a></div></div>
<div class="ttc" id="apetaio_8h_html_ad6f414270d5fb192595f06d5e0280606"><div class="ttname"><a href="petaio_8h.html#ad6f414270d5fb192595f06d5e0280606">IO_REG_NONFATAL</a></div><div class="ttdeci">#define IO_REG_NONFATAL(name, dtype, items, ptype, IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00119">petaio.h:119</a></div></div>
<div class="ttc" id="apetaio_8h_html_aea3f033ef60233e7e613ddd95047dc19"><div class="ttname"><a href="petaio_8h.html#aea3f033ef60233e7e613ddd95047dc19">IO_REG_TYPE</a></div><div class="ttdeci">#define IO_REG_TYPE(name, dtype, items, ptype, IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00115">petaio.h:115</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a75216f9bf4030240b1fc0e1855e032d2"><div class="ttname"><a href="physconst_8h.html#a75216f9bf4030240b1fc0e1855e032d2">GAMMA_MINUS1</a></div><div class="ttdeci">#define GAMMA_MINUS1</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00035">physconst.h:35</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_a18c2f2fb564de2ff8a5372d8bcbe0968"><div class="ttname"><a href="sfr__eff_8c.html#a18c2f2fb564de2ff8a5372d8bcbe0968">get_helium_neutral_fraction_sfreff</a></div><div class="ttdeci">double get_helium_neutral_fraction_sfreff(int ion, double redshift, double hubble, struct particle_data *partdata, struct sph_particle_data *sphdata)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00548">sfr_eff.c:548</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_a4e4a6b5d6976b26f1ababfba475c1f4c"><div class="ttname"><a href="sfr__eff_8c.html#a4e4a6b5d6976b26f1ababfba475c1f4c">get_neutral_fraction_sfreff</a></div><div class="ttdeci">double get_neutral_fraction_sfreff(double redshift, double hubble, struct particle_data *partdata, struct sph_particle_data *sphdata)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00520">sfr_eff.c:520</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_a50b5665399825c31849545fe351e51ab"><div class="ttname"><a href="sfr__eff_8c.html#a50b5665399825c31849545fe351e51ab">get_generations</a></div><div class="ttdeci">int get_generations(void)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00087">sfr_eff.c:87</a></div></div>
<div class="ttc" id="asfr__eff_8h_html"><div class="ttname"><a href="sfr__eff_8h.html">sfr_eff.h</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a0820c393c6f3cf51ae76cbf54841d128"><div class="ttname"><a href="slotsmanager_8c.html#a0820c393c6f3cf51ae76cbf54841d128">slots_setup_id</a></div><div class="ttdeci">void slots_setup_id(const struct part_manager_type *pman, struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00653">slotsmanager.c:653</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html"><div class="ttname"><a href="slotsmanager_8h.html">slotsmanager.h</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html_ad07d3b873121463218a991d53512e49b"><div class="ttname"><a href="slotsmanager_8h.html#ad07d3b873121463218a991d53512e49b">NMETALS</a></div><div class="ttdeci">#define NMETALS</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00060">slotsmanager.h:60</a></div></div>
<div class="ttc" id="astring_8c_html_a787c3b0717214d830c69b7e8785a3e33"><div class="ttname"><a href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a></div><div class="ttdeci">char * fastpm_strdup_printf(const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00041">string.c:41</a></div></div>
<div class="ttc" id="astring_8h_html"><div class="ttname"><a href="string_8h.html">string.h</a></div></div>
<div class="ttc" id="astructCosmology_html"><div class="ttname"><a href="structCosmology.html">Cosmology</a></div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00008">cosmology.h:8</a></div></div>
<div class="ttc" id="astructCosmology_html_a43e0dba956c6dc4fad8b1aaf0fa84248"><div class="ttname"><a href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Cosmology::Omega0</a></div><div class="ttdeci">double Omega0</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00010">cosmology.h:10</a></div></div>
<div class="ttc" id="astructCosmology_html_a4b79dcaa1e1c38d07258c3f539e2cb20"><div class="ttname"><a href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">Cosmology::HubbleParam</a></div><div class="ttdeci">double HubbleParam</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00020">cosmology.h:20</a></div></div>
<div class="ttc" id="astructCosmology_html_a62b59388eea6cbc92a29697e2e969b34"><div class="ttname"><a href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">Cosmology::CMBTemperature</a></div><div class="ttdeci">double CMBTemperature</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00009">cosmology.h:9</a></div></div>
<div class="ttc" id="astructCosmology_html_ac27ad0bd8a6135a2b7da6c49c375d73e"><div class="ttname"><a href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">Cosmology::OmegaLambda</a></div><div class="ttdeci">double OmegaLambda</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00014">cosmology.h:14</a></div></div>
<div class="ttc" id="astructCosmology_html_ac818659114fd72f09039b088e43e8624"><div class="ttname"><a href="structCosmology.html#ac818659114fd72f09039b088e43e8624">Cosmology::OmegaBaryon</a></div><div class="ttdeci">double OmegaBaryon</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00019">cosmology.h:19</a></div></div>
<div class="ttc" id="astructCosmology_html_ad088df185d7995a9c95eb5e87e006ea5"><div class="ttname"><a href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">Cosmology::MassiveNuLinRespOn</a></div><div class="ttdeci">int MassiveNuLinRespOn</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00026">cosmology.h:26</a></div></div>
<div class="ttc" id="astructIOTableEntry_html"><div class="ttname"><a href="structIOTableEntry.html">IOTableEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00049">petaio.h:49</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_a2cd7cf3c7b9731be73d16e80ed389e21"><div class="ttname"><a href="structIOTableEntry.html#a2cd7cf3c7b9731be73d16e80ed389e21">IOTableEntry::items</a></div><div class="ttdeci">int items</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00054">petaio.h:54</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_a76dbf5bd339f62204ec9af6edff35f2b"><div class="ttname"><a href="structIOTableEntry.html#a76dbf5bd339f62204ec9af6edff35f2b">IOTableEntry::dtype</a></div><div class="ttdeci">char dtype[8]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00053">petaio.h:53</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_aa037a23807dcc34b66c5c71d49db4914"><div class="ttname"><a href="structIOTableEntry.html#aa037a23807dcc34b66c5c71d49db4914">IOTableEntry::zorder</a></div><div class="ttdeci">int zorder</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00050">petaio.h:50</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_ab5ee266f94a60e5b12aab7c40b267c87"><div class="ttname"><a href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">IOTableEntry::ptype</a></div><div class="ttdeci">int ptype</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00052">petaio.h:52</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_abd017805b410e444ec76f0633c530ea4"><div class="ttname"><a href="structIOTableEntry.html#abd017805b410e444ec76f0633c530ea4">IOTableEntry::required</a></div><div class="ttdeci">int required</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00055">petaio.h:55</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_ac571725e2d3247c7e038821bca7bf87f"><div class="ttname"><a href="structIOTableEntry.html#ac571725e2d3247c7e038821bca7bf87f">IOTableEntry::getter</a></div><div class="ttdeci">property_getter getter</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00056">petaio.h:56</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_aca5a071ce97564cf069f4c1bbbe15894"><div class="ttname"><a href="structIOTableEntry.html#aca5a071ce97564cf069f4c1bbbe15894">IOTableEntry::setter</a></div><div class="ttdeci">property_setter setter</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00057">petaio.h:57</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_ae8210949ad522cfbf6342e4b8caeefc2"><div class="ttname"><a href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">IOTableEntry::name</a></div><div class="ttdeci">char name[64]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00051">petaio.h:51</a></div></div>
<div class="ttc" id="astructIOTable_html"><div class="ttname"><a href="structIOTable.html">IOTable</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00060">petaio.h:60</a></div></div>
<div class="ttc" id="astructIOTable_html_a5653cce54984987c97ee9473ad06c76d"><div class="ttname"><a href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">IOTable::used</a></div><div class="ttdeci">int used</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00062">petaio.h:62</a></div></div>
<div class="ttc" id="astructIOTable_html_aa30dff5cc02af37f073e52e75eb17e5c"><div class="ttname"><a href="structIOTable.html#aa30dff5cc02af37f073e52e75eb17e5c">IOTable::allocated</a></div><div class="ttdeci">int allocated</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00063">petaio.h:63</a></div></div>
<div class="ttc" id="astructIOTable_html_aa59c489dda5e12b28ac676fec4935194"><div class="ttname"><a href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">IOTable::ent</a></div><div class="ttdeci">IOTableEntry * ent</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00061">petaio.h:61</a></div></div>
<div class="ttc" id="astructParameterSet_html"><div class="ttname"><a href="structParameterSet.html">ParameterSet</a></div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00095">paramset.c:95</a></div></div>
<div class="ttc" id="astructbh__particle__data_html"><div class="ttname"><a href="structbh__particle__data.html">bh_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00028">slotsmanager.h:28</a></div></div>
<div class="ttc" id="astructbh__particle__data_html_a732a76510a864f4d5e1dd4c67b637aaf"><div class="ttname"><a href="structbh__particle__data.html#a732a76510a864f4d5e1dd4c67b637aaf">bh_particle_data::MinPotPos</a></div><div class="ttdeci">double MinPotPos[3]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00041">slotsmanager.h:41</a></div></div>
<div class="ttc" id="astructconversions_html"><div class="ttname"><a href="structconversions.html">conversions</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00039">petaio.h:40</a></div></div>
<div class="ttc" id="astructconversions_html_a5c554fbb955309fd8d5df4588baa9e35"><div class="ttname"><a href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">conversions::atime</a></div><div class="ttdeci">double atime</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00041">petaio.h:41</a></div></div>
<div class="ttc" id="astructconversions_html_afe2ede2f433be43288e55c55dff47e70"><div class="ttname"><a href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">conversions::hubble</a></div><div class="ttdeci">double hubble</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00042">petaio.h:42</a></div></div>
<div class="ttc" id="astructheader__data_html"><div class="ttname"><a href="structheader__data.html">header_data</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00013">petaio.h:14</a></div></div>
<div class="ttc" id="astructheader__data_html_a0c7b9fa17aae847e0943fca860b433b8"><div class="ttname"><a href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">header_data::TimeIC</a></div><div class="ttdeci">double TimeIC</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00024">petaio.h:24</a></div></div>
<div class="ttc" id="astructheader__data_html_a3018a9d27eb35ace7191750070e5b738"><div class="ttname"><a href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">header_data::NTotalInit</a></div><div class="ttdeci">int64_t NTotalInit[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00020">petaio.h:20</a></div></div>
<div class="ttc" id="astructheader__data_html_a3f2592f3de9589278f2729aefc8fe470"><div class="ttname"><a href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">header_data::TimeSnapshot</a></div><div class="ttdeci">double TimeSnapshot</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00026">petaio.h:26</a></div></div>
<div class="ttc" id="astructheader__data_html_a688df7c6718763c7e6a31a48d2de0334"><div class="ttname"><a href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">header_data::UnitMass_in_g</a></div><div class="ttdeci">double UnitMass_in_g</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00031">petaio.h:31</a></div></div>
<div class="ttc" id="astructheader__data_html_a9c711b22317be63826f76b8f60d0eeef"><div class="ttname"><a href="structheader__data.html#a9c711b22317be63826f76b8f60d0eeef">header_data::NLocal</a></div><div class="ttdeci">int64_t NLocal[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00016">petaio.h:16</a></div></div>
<div class="ttc" id="astructheader__data_html_aaa78a996d4b10f0509c26ca61eb4d644"><div class="ttname"><a href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">header_data::MassTable</a></div><div class="ttdeci">double MassTable[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00022">petaio.h:22</a></div></div>
<div class="ttc" id="astructheader__data_html_ac36f80ed4e241b322d104dfbddea82d5"><div class="ttname"><a href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">header_data::UnitVelocity_in_cm_per_s</a></div><div class="ttdeci">double UnitVelocity_in_cm_per_s</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00032">petaio.h:32</a></div></div>
<div class="ttc" id="astructheader__data_html_acfb3b8eb5b66cb6cde582cd7fdda04d0"><div class="ttname"><a href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">header_data::UnitLength_in_cm</a></div><div class="ttdeci">double UnitLength_in_cm</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00030">petaio.h:30</a></div></div>
<div class="ttc" id="astructheader__data_html_ae28db91028a22d277523890fd51d72c4"><div class="ttname"><a href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">header_data::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00028">petaio.h:28</a></div></div>
<div class="ttc" id="astructheader__data_html_afd7952ed03fc314454e077e755851558"><div class="ttname"><a href="structheader__data.html#afd7952ed03fc314454e077e755851558">header_data::NTotal</a></div><div class="ttdeci">int64_t NTotal[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00018">petaio.h:18</a></div></div>
<div class="ttc" id="astructpart__manager__type_html"><div class="ttname"><a href="structpart__manager__type.html">part_manager_type</a></div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00073">partmanager.h:73</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a4dcf875204ca1e4c7cbcfe313ca6dea9"><div class="ttname"><a href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">part_manager_type::Base</a></div><div class="ttdeci">struct particle_data * Base</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00074">partmanager.h:74</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a5462d473b8cd90abf7f7f7a56d822649"><div class="ttname"><a href="structpart__manager__type.html#a5462d473b8cd90abf7f7f7a56d822649">part_manager_type::CurrentParticleOffset</a></div><div class="ttdeci">double CurrentParticleOffset[3]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00082">partmanager.h:82</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_afd51316d545eaf7f3f083aea9616858d"><div class="ttname"><a href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">part_manager_type::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00084">partmanager.h:84</a></div></div>
<div class="ttc" id="astructparticle__data_html"><div class="ttname"><a href="structparticle__data.html">particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00010">partmanager.h:11</a></div></div>
<div class="ttc" id="astructparticle__data_html_a05fd8464aa98ca965a3e57109a326dd6"><div class="ttname"><a href="structparticle__data.html#a05fd8464aa98ca965a3e57109a326dd6">particle_data::TimeBin</a></div><div class="ttdeci">unsigned char TimeBin</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00026">partmanager.h:26</a></div></div>
<div class="ttc" id="astructparticle__data_html_a0ab202643f07e8f7febb795f308c5390"><div class="ttname"><a href="structparticle__data.html#a0ab202643f07e8f7febb795f308c5390">particle_data::PI</a></div><div class="ttdeci">int PI</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00034">partmanager.h:34</a></div></div>
<div class="ttc" id="astructparticle__data_html_a1f56dd3ed661c7c03822d9767f09477c"><div class="ttname"><a href="structparticle__data.html#a1f56dd3ed661c7c03822d9767f09477c">particle_data::Potential</a></div><div class="ttdeci">MyFloat Potential</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00045">partmanager.h:45</a></div></div>
<div class="ttc" id="astructparticle__data_html_a5ef3af5f8686e921896560e369878d49"><div class="ttname"><a href="structparticle__data.html#a5ef3af5f8686e921896560e369878d49">particle_data::HeIIIionized</a></div><div class="ttdeci">unsigned char HeIIIionized</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00028">partmanager.h:28</a></div></div>
<div class="ttc" id="astructparticle__data_html_a68637c72824f83371e5ad01217c4fde6"><div class="ttname"><a href="structparticle__data.html#a68637c72824f83371e5ad01217c4fde6">particle_data::Hsml</a></div><div class="ttdeci">MyFloat Hsml</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00059">partmanager.h:59</a></div></div>
<div class="ttc" id="astructparticle__data_html_a6adea4c443a9de86d16d0b3137a67788"><div class="ttname"><a href="structparticle__data.html#a6adea4c443a9de86d16d0b3137a67788">particle_data::ID</a></div><div class="ttdeci">MyIDType ID</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00038">partmanager.h:38</a></div></div>
<div class="ttc" id="astructparticle__data_html_a6ed5ff97d6d940a36218002cf48bff62"><div class="ttname"><a href="structparticle__data.html#a6ed5ff97d6d940a36218002cf48bff62">particle_data::Swallowed</a></div><div class="ttdeci">unsigned int Swallowed</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00020">partmanager.h:20</a></div></div>
<div class="ttc" id="astructparticle__data_html_a710e551be01f4ef85442d0928aca728c"><div class="ttname"><a href="structparticle__data.html#a710e551be01f4ef85442d0928aca728c">particle_data::Mass</a></div><div class="ttdeci">float Mass</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00013">partmanager.h:13</a></div></div>
<div class="ttc" id="astructparticle__data_html_a84dddcea5cce7e09b93965b65ddaf4e6"><div class="ttname"><a href="structparticle__data.html#a84dddcea5cce7e09b93965b65ddaf4e6">particle_data::Vel</a></div><div class="ttdeci">MyFloat Vel[3]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00040">partmanager.h:40</a></div></div>
<div class="ttc" id="astructparticle__data_html_a8a2930279027f0fff6ef709c41e718ec"><div class="ttname"><a href="structparticle__data.html#a8a2930279027f0fff6ef709c41e718ec">particle_data::Pos</a></div><div class="ttdeci">double Pos[3]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00012">partmanager.h:12</a></div></div>
<div class="ttc" id="astructparticle__data_html_a9f7b267932648c5b555b16ef1727e902"><div class="ttname"><a href="structparticle__data.html#a9f7b267932648c5b555b16ef1727e902">particle_data::Type</a></div><div class="ttdeci">unsigned int Type</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00017">partmanager.h:17</a></div></div>
<div class="ttc" id="astructparticle__data_html_afe2b9d3e1632979f85f9cab4d62ea299"><div class="ttname"><a href="structparticle__data.html#afe2b9d3e1632979f85f9cab4d62ea299">particle_data::Generation</a></div><div class="ttdeci">unsigned char Generation</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00023">partmanager.h:23</a></div></div>
<div class="ttc" id="astructpetaio__params_html"><div class="ttname"><a href="structpetaio__params.html">petaio_params</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00031">petaio.c:31</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a0a9f78571a31c14e13676e376f3c40a4"><div class="ttname"><a href="structpetaio__params.html#a0a9f78571a31c14e13676e376f3c40a4">petaio_params::AggregatedIOThreshold</a></div><div class="ttdeci">size_t AggregatedIOThreshold</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00037">petaio.c:37</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a2e4d6921cb852d73b93724740c54d069"><div class="ttname"><a href="structpetaio__params.html#a2e4d6921cb852d73b93724740c54d069">petaio_params::UsePeculiarVelocity</a></div><div class="ttdeci">int UsePeculiarVelocity</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00043">petaio.c:43</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a3a0b4afb01559fc683b313a054aeacc5"><div class="ttname"><a href="structpetaio__params.html#a3a0b4afb01559fc683b313a054aeacc5">petaio_params::EnableAggregatedIO</a></div><div class="ttdeci">int EnableAggregatedIO</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00036">petaio.c:36</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a4f78ba12322f124eaafa8d2e244eacd6"><div class="ttname"><a href="structpetaio__params.html#a4f78ba12322f124eaafa8d2e244eacd6">petaio_params::OutputPotential</a></div><div class="ttdeci">int OutputPotential</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00044">petaio.c:44</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a564b4ef21e716b593ab47d7b75632891"><div class="ttname"><a href="structpetaio__params.html#a564b4ef21e716b593ab47d7b75632891">petaio_params::OutputHeliumFractions</a></div><div class="ttdeci">int OutputHeliumFractions</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00045">petaio.c:45</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a7367d63fac5d853071454643651ce9b6"><div class="ttname"><a href="structpetaio__params.html#a7367d63fac5d853071454643651ce9b6">petaio_params::InitCondFile</a></div><div class="ttdeci">char InitCondFile[100]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00048">petaio.c:48</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a79a37355a35c9e5aaaf0278393b715c9"><div class="ttname"><a href="structpetaio__params.html#a79a37355a35c9e5aaaf0278393b715c9">petaio_params::SnapshotFileBase</a></div><div class="ttdeci">char SnapshotFileBase[100]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00047">petaio.c:47</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a84a45d6f0aa03d467b42e76226b3f8a9"><div class="ttname"><a href="structpetaio__params.html#a84a45d6f0aa03d467b42e76226b3f8a9">petaio_params::WritersPerFile</a></div><div class="ttdeci">int WritersPerFile</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00033">petaio.c:33</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a904ebf8eb5349a10d3100ebb441e622e"><div class="ttname"><a href="structpetaio__params.html#a904ebf8eb5349a10d3100ebb441e622e">petaio_params::NumWriters</a></div><div class="ttdeci">int NumWriters</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00034">petaio.c:34</a></div></div>
<div class="ttc" id="astructpetaio__params_html_a9deb17c22b4ff8c4260e22a0d016a2db"><div class="ttname"><a href="structpetaio__params.html#a9deb17c22b4ff8c4260e22a0d016a2db">petaio_params::OutputTimebins</a></div><div class="ttdeci">int OutputTimebins</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00046">petaio.c:46</a></div></div>
<div class="ttc" id="astructpetaio__params_html_ac1985365172fefa23fbfc568662f42ea"><div class="ttname"><a href="structpetaio__params.html#ac1985365172fefa23fbfc568662f42ea">petaio_params::MinNumWriters</a></div><div class="ttdeci">int MinNumWriters</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00035">petaio.c:35</a></div></div>
<div class="ttc" id="astructpetaio__params_html_aeea00dfdb28d74b449beaf9dd66f8b16"><div class="ttname"><a href="structpetaio__params.html#aeea00dfdb28d74b449beaf9dd66f8b16">petaio_params::BytesPerFile</a></div><div class="ttdeci">size_t BytesPerFile</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00032">petaio.c:32</a></div></div>
<div class="ttc" id="astructslot__info_html"><div class="ttname"><a href="structslot__info.html">slot_info</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00009">slotsmanager.h:9</a></div></div>
<div class="ttc" id="astructslot__info_html_affdde3ed12324d738ce92e886bb73a1d"><div class="ttname"><a href="structslot__info.html#affdde3ed12324d738ce92e886bb73a1d">slot_info::ptr</a></div><div class="ttdeci">char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00010">slotsmanager.h:10</a></div></div>
<div class="ttc" id="astructslots__manager__type_html"><div class="ttname"><a href="structslots__manager__type.html">slots_manager_type</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00111">slotsmanager.h:111</a></div></div>
<div class="ttc" id="astructsph__particle__data_html"><div class="ttname"><a href="structsph__particle__data.html">sph_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00079">slotsmanager.h:80</a></div></div>
<div class="ttc" id="astructsph__particle__data_html_a1519e54bbe3cf301cd3fc1224178e4f9"><div class="ttname"><a href="structsph__particle__data.html#a1519e54bbe3cf301cd3fc1224178e4f9">sph_particle_data::Entropy</a></div><div class="ttdeci">MyFloat Entropy</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00087">slotsmanager.h:87</a></div></div>
<div class="ttc" id="astructsph__particle__data_html_a40e26648ca8d900ec500a36a5d876ed7"><div class="ttname"><a href="structsph__particle__data.html#a40e26648ca8d900ec500a36a5d876ed7">sph_particle_data::Density</a></div><div class="ttdeci">MyFloat Density</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00090">slotsmanager.h:90</a></div></div>
<div class="ttc" id="astructstar__particle__data_html"><div class="ttname"><a href="structstar__particle__data.html">star_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00063">slotsmanager.h:64</a></div></div>
<div class="ttc" id="asystem_8c_html_a1d471d98379273269e8045d2998eca73"><div class="ttname"><a href="system_8c.html#a1d471d98379273269e8045d2998eca73">count_sum</a></div><div class="ttdeci">int64_t count_sum(int64_t countLocal)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00264">system.c:264</a></div></div>
<div class="ttc" id="asystem_8c_html_a866c4b0425665030c89933c11752b1fe"><div class="ttname"><a href="system_8c.html#a866c4b0425665030c89933c11752b1fe">sumup_large_ints</a></div><div class="ttdeci">void sumup_large_ints(int n, int *src, int64_t *res)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00192">system.c:192</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_ad7d4bd341445fe424000de03798b35e8"><div class="ttname"><a href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a></div><div class="ttdeci">#define qsort_openmp</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00014">test_exchange.c:14</a></div></div>
<div class="ttc" id="atimestep_8h_html"><div class="ttname"><a href="timestep_8h.html">timestep.h</a></div></div>
<div class="ttc" id="autils_8h_html"><div class="ttname"><a href="utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="azeldovich_8c_html_a953067f6751c09a3d2e7554c74fcbf6d"><div class="ttname"><a href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a></div><div class="ttdeci">static enum TransferType ptype</div><div class="ttdef"><b>Definition:</b> <a href="zeldovich_8c_source.html#l00113">zeldovich.c:146</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
