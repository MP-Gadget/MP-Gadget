<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/fof.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fof.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="forcetree_8h_source.html">forcetree.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="paramset_8h_source.html">utils/paramset.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timestep_8h_source.html">timestep.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slotsmanager_8h_source.html">slotsmanager.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fof.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h__incl.svg" width="2055" height="635"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h__dep__incl.svg" width="1463" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="fof_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBaseGroup.html">BaseGroup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structGroup.html">Group</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFOFGroups.html">FOFGroups</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a48a1edd6dcf1fcfd877dc0b1a8b1bea4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structFOFGroups.html">FOFGroups</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#a48a1edd6dcf1fcfd877dc0b1a8b1bea4">FOFGroups</a></td></tr>
<tr class="separator:a48a1edd6dcf1fcfd877dc0b1a8b1bea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6c49b36d075d061975ada82ecc78763c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#a6c49b36d075d061975ada82ecc78763c">set_fof_params</a> (<a class="el" href="structParameterSet.html">ParameterSet</a> *ps)</td></tr>
<tr class="separator:a6c49b36d075d061975ada82ecc78763c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96820d22f0ab2a61425e423da2121fd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#a96820d22f0ab2a61425e423da2121fd6">fof_init</a> (double DMMeanSeparation)</td></tr>
<tr class="separator:a96820d22f0ab2a61425e423da2121fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef0df27f65ad2e5a95f66ae4e970da23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFOFGroups.html">FOFGroups</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#aef0df27f65ad2e5a95f66ae4e970da23">fof_fof</a> (<a class="el" href="structDomainDecomp.html">DomainDecomp</a> *ddecomp, const int StoreGrNr, MPI_Comm Comm)</td></tr>
<tr class="separator:aef0df27f65ad2e5a95f66ae4e970da23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ae2d0c5765a217f7bb5a1a7fe261d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#ab9ae2d0c5765a217f7bb5a1a7fe261d4">fof_finish</a> (<a class="el" href="structFOFGroups.html">FOFGroups</a> *fof)</td></tr>
<tr class="separator:ab9ae2d0c5765a217f7bb5a1a7fe261d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac636ce7b1a72cfabfee3a11fadc0aeb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#ac636ce7b1a72cfabfee3a11fadc0aeb5">fof_seed</a> (<a class="el" href="structFOFGroups.html">FOFGroups</a> *fof, <a class="el" href="structActiveParticles.html">ActiveParticles</a> *act, double atime, MPI_Comm Comm)</td></tr>
<tr class="separator:ac636ce7b1a72cfabfee3a11fadc0aeb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d0e2572ef5e373fe12edd44a94ce92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#a38d0e2572ef5e373fe12edd44a94ce92">fof_save_groups</a> (<a class="el" href="structFOFGroups.html">FOFGroups</a> *fof, const char *OutputDir, const char *FOFFileBase, int num, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, double atime, const double *MassTable, int MetalReturnOn, int BlackholeOn, MPI_Comm Comm)</td></tr>
<tr class="separator:a38d0e2572ef5e373fe12edd44a94ce92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa985d617a622b54361bd8c756076b11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fof_8h.html#aaa985d617a622b54361bd8c756076b11">fof_save_particles</a> (<a class="el" href="structFOFGroups.html">FOFGroups</a> *fof, const char *OutputDir, const char *FOFFileBase, int num, int SaveParticles, <a class="el" href="structCosmology.html">Cosmology</a> *<a class="el" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, double atime, const double *MassTable, int MetalReturnOn, int BlackholeOn, MPI_Comm Comm)</td></tr>
<tr class="separator:aaa985d617a622b54361bd8c756076b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a48a1edd6dcf1fcfd877dc0b1a8b1bea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a1edd6dcf1fcfd877dc0b1a8b1bea4">&#9670;&nbsp;</a></span>FOFGroups</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structFOFGroups.html">FOFGroups</a> <a class="el" href="structFOFGroups.html">FOFGroups</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab9ae2d0c5765a217f7bb5a1a7fe261d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9ae2d0c5765a217f7bb5a1a7fe261d4">&#9670;&nbsp;</a></span>fof_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fof_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l00257">257</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Finished computing FoF groups.  (presently allocated=%g MB)\n&quot;</span>,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="mymalloc_8h.html#ae51745d10f51ca300ad484ab4ecf7908">mymalloc_usedbytes</a>() / (1024.0 * 1024.0));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/MISC&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    MPI_Type_free(&amp;<a class="code" href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="afof_8c_html_aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6"><div class="ttname"><a href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a></div><div class="ttdeci">static MPI_Datatype MPI_TYPE_GROUP</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00142">fof.c:142</a></div></div>
<div class="ttc" id="amymalloc_8h_html_ae51745d10f51ca300ad484ab4ecf7908"><div class="ttname"><a href="mymalloc_8h.html#ae51745d10f51ca300ad484ab4ecf7908">mymalloc_usedbytes</a></div><div class="ttdeci">#define mymalloc_usedbytes()</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00032">mymalloc.h:32</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="astructFOFGroups_html_a2d0285df13a54af4ca09a6eaf28ea4b1"><div class="ttname"><a href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">FOFGroups::Group</a></div><div class="ttdeci">struct Group * Group</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00063">fof.h:63</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="fof_8c_source.html#l00142">MPI_TYPE_GROUP</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00032">mymalloc_usedbytes</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, and <a class="el" href="test__fof_8c_source.html#l00071">test_fof()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_ab9ae2d0c5765a217f7bb5a1a7fe261d4_cgraph.svg" width="491" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_ab9ae2d0c5765a217f7bb5a1a7fe261d4_icgraph.svg" width="316" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aef0df27f65ad2e5a95f66ae4e970da23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef0df27f65ad2e5a95f66ae4e970da23">&#9670;&nbsp;</a></span>fof_fof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFOFGroups.html">FOFGroups</a> fof_fof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDomainDecomp.html">DomainDecomp</a> *&#160;</td>
          <td class="paramname"><em>ddecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>StoreGrNr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l00151">151</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Begin to compute FoF group catalogues. (allocated: %g MB)\n&quot;</span>,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="mymalloc_8h.html#ae51745d10f51ca300ad484ab4ecf7908">mymalloc_usedbytes</a>() / (1024.0 * 1024.0));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Comoving linking length: %g\n&quot;</span>, <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a4151c49228e3e5998d1ac91a8bda8da8">FOFHaloComovingLinkingLength</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">struct </span><a class="code" href="structfof__particle__list.html">fof_particle_list</a> * HaloLabel = (<span class="keyword">struct </span><a class="code" href="structfof__particle__list.html">fof_particle_list</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;HaloLabel&quot;</span>, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a> * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structfof__particle__list.html">fof_particle_list</a>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">/* HaloLabel stores the MinID and MinIDTask of particles, this pair serves as a halo label. */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        HaloLabel[i].<a class="code" href="structfof__particle__list.html#a10c0ead10aeb6f1b026953493bfe3315">Pindex</a> = i;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">/* We only need a tree containing primary linking particles only. No moments*/</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="structForceTree.html">ForceTree</a> dmtree = {0};</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="forcetree_8c.html#aa01061828cef34bc4c55ef9eaa7c03f5">force_tree_rebuild_mask</a>(&amp;dmtree, ddecomp, <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a8c7053a8994f92828d960f92ba4b1613">FOFPrimaryLinkTypes</a>, 0, NULL);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/* Fill FOFP_List of primary */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="fof_8c.html#aced1373e68ad94bf601be61f535f4060">fof_label_primary</a>(HaloLabel, &amp;dmtree, Comm);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(Comm);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Group finding done.\n&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/Primary&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">/* Fill FOFP_List of secondary */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="fof_8c.html#acdac83ed649364bfe1f14e9c572c7f2f">fof_label_secondary</a>(HaloLabel, &amp;dmtree);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;dmtree);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(Comm);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Attached gas and star particles to nearest dm particles.\n&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/Secondary&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">/* sort HaloLabel according to MinID, because we need that for compiling catalogues */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a>(HaloLabel, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structfof__particle__list.html">fof_particle_list</a>), <a class="code" href="fof_8c.html#a4fd8c8871c1c94283ddae866a4fd437a">fof_compare_HaloLabel_MinID</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">int</span> NgroupsExt = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i ++) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span>(i == 0 || HaloLabel[i].<a class="code" href="structfof__particle__list.html#a8df88add6c36c83e3e5d3347df615d7f">MinID</a> != HaloLabel[i - 1].<a class="code" href="structfof__particle__list.html#a8df88add6c36c83e3e5d3347df615d7f">MinID</a>) NgroupsExt ++;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">/* The first round is to eliminate groups that are too short. */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">/* We create the smaller &#39;BaseGroup&#39; data set for this. */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">struct </span><a class="code" href="structBaseGroup.html">BaseGroup</a> * base = (<span class="keyword">struct </span><a class="code" href="structBaseGroup.html">BaseGroup</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;BaseGroup&quot;</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structBaseGroup.html">BaseGroup</a>) * NgroupsExt);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    NgroupsExt = <a class="code" href="fof_8c.html#a66eb3a35378e322fe0019ffc66c34653">fof_compile_base</a>(base, NgroupsExt, HaloLabel, Comm);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(Comm);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Compiled local group data and catalogue.\n&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/Compile&quot;</span>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="fof_8c.html#aeb034bb4fc0f2305d7afb911c7347579">fof_assign_grnr</a>(base, NgroupsExt, Comm);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">/*Store the group number in the particle struct*/</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span>(StoreGrNr) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">        #pragma omp parallel for</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; i++)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[i].<a class="code" href="structBaseGroup.html#aab1afcc30c625a6f2ae8e5c2cc40cf5c">GrNr</a> = -1; <span class="comment">/* will mark particles that are not in any group */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        int64_t start = 0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; NgroupsExt; i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">for</span>(;start &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; start++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">if</span> (HaloLabel[start].<a class="code" href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">MinID</a> &gt;= base[i].<a class="code" href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">MinID</a>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">for</span>(;start &lt; <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>; start++) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keywordflow">if</span> (HaloLabel[start].<a class="code" href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">MinID</a> != base[i].<a class="code" href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">MinID</a>)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <a class="code" href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a>[HaloLabel[start].<a class="code" href="structfof__particle__list.html#a10c0ead10aeb6f1b026953493bfe3315">Pindex</a>].GrNr = base[i].<a class="code" href="structBaseGroup.html#aab1afcc30c625a6f2ae8e5c2cc40cf5c">GrNr</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/*Initialise the Group object from the BaseGroup*/</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="structFOFGroups.html">FOFGroups</a> fof;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    MPI_Type_contiguous(<span class="keyword">sizeof</span>(fof.<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[0]), MPI_BYTE, &amp;<a class="code" href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    MPI_Type_commit(&amp;<a class="code" href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    fof.<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a> = <a class="code" href="fof_8c.html#a1991d3902683f7524ca4fb711ae8955a">fof_alloc_group</a>(base, NgroupsExt);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(base);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="fof_8c.html#a16942d501e7ac23fdccef42ef0f3b63b">fof_compile_catalogue</a>(&amp;fof, NgroupsExt, HaloLabel, Comm);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(Comm);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Finished FoF. Group properties are now allocated.. (presently allocated=%g MB)\n&quot;</span>,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="mymalloc_8h.html#ae51745d10f51ca300ad484ab4ecf7908">mymalloc_usedbytes</a>() / (1024.0 * 1024.0));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/Prop&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(HaloLabel);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> fof;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="ttc" id="afof_8c_html_a16942d501e7ac23fdccef42ef0f3b63b"><div class="ttname"><a href="fof_8c.html#a16942d501e7ac23fdccef42ef0f3b63b">fof_compile_catalogue</a></div><div class="ttdeci">static void fof_compile_catalogue(FOFGroups *fof, const int NgroupsExt, struct fof_particle_list *HaloLabel, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00835">fof.c:835</a></div></div>
<div class="ttc" id="afof_8c_html_a1991d3902683f7524ca4fb711ae8955a"><div class="ttname"><a href="fof_8c.html#a1991d3902683f7524ca4fb711ae8955a">fof_alloc_group</a></div><div class="ttdeci">static struct Group * fof_alloc_group(const struct BaseGroup *base, const int NgroupsExt)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00819">fof.c:819</a></div></div>
<div class="ttc" id="afof_8c_html_a4fd8c8871c1c94283ddae866a4fd437a"><div class="ttname"><a href="fof_8c.html#a4fd8c8871c1c94283ddae866a4fd437a">fof_compare_HaloLabel_MinID</a></div><div class="ttdeci">static int fof_compare_HaloLabel_MinID(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01404">fof.c:1404</a></div></div>
<div class="ttc" id="afof_8c_html_a66eb3a35378e322fe0019ffc66c34653"><div class="ttname"><a href="fof_8c.html#a66eb3a35378e322fe0019ffc66c34653">fof_compile_base</a></div><div class="ttdeci">static int fof_compile_base(struct BaseGroup *base, int NgroupsExt, struct fof_particle_list *HaloLabel, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00761">fof.c:761</a></div></div>
<div class="ttc" id="afof_8c_html_acdac83ed649364bfe1f14e9c572c7f2f"><div class="ttname"><a href="fof_8c.html#acdac83ed649364bfe1f14e9c572c7f2f">fof_label_secondary</a></div><div class="ttdeci">static void fof_label_secondary(struct fof_particle_list *HaloLabel, ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01207">fof.c:1207</a></div></div>
<div class="ttc" id="afof_8c_html_aced1373e68ad94bf601be61f535f4060"><div class="ttname"><a href="fof_8c.html#aced1373e68ad94bf601be61f535f4060">fof_label_primary</a></div><div class="ttdeci">void fof_label_primary(struct fof_particle_list *HaloLabel, ForceTree *tree, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00369">fof.c:369</a></div></div>
<div class="ttc" id="afof_8c_html_aeb034bb4fc0f2305d7afb911c7347579"><div class="ttname"><a href="fof_8c.html#aeb034bb4fc0f2305d7afb911c7347579">fof_assign_grnr</a></div><div class="ttdeci">static void fof_assign_grnr(struct BaseGroup *base, const int NgroupsExt, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01062">fof.c:1062</a></div></div>
<div class="ttc" id="afof_8c_html_af36e943612e1e4fece5b4b9cd1e2a94c"><div class="ttname"><a href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a></div><div class="ttdeci">struct FOFParams fof_params</div></div>
<div class="ttc" id="aforcetree_8c_html_aa01061828cef34bc4c55ef9eaa7c03f5"><div class="ttname"><a href="forcetree_8c.html#aa01061828cef34bc4c55ef9eaa7c03f5">force_tree_rebuild_mask</a></div><div class="ttdeci">void force_tree_rebuild_mask(ForceTree *tree, DomainDecomp *ddecomp, int mask, const int HybridNuGrav, const char *EmergencyOutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00161">forcetree.c:161</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aaa26dfea4b696133a8bc35c5e0c56037"><div class="ttname"><a href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a></div><div class="ttdeci">void force_tree_free(ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l01409">forcetree.c:1409</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a3eb707b32b6ac69f2df085e4bc098cc4"><div class="ttname"><a href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a></div><div class="ttdeci">#define mymalloc(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00015">mymalloc.h:15</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8h_html_a2748566f4c443ee77aa831e63dbb5ebe"><div class="ttname"><a href="partmanager_8h.html#a2748566f4c443ee77aa831e63dbb5ebe">P</a></div><div class="ttdeci">#define P</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00088">partmanager.h:88</a></div></div>
<div class="ttc" id="astructBaseGroup_html"><div class="ttname"><a href="structBaseGroup.html">BaseGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00013">fof.h:13</a></div></div>
<div class="ttc" id="astructBaseGroup_html_a0e67684d09dd036317c12a7a0b0dcbaf"><div class="ttname"><a href="structBaseGroup.html#a0e67684d09dd036317c12a7a0b0dcbaf">BaseGroup::MinID</a></div><div class="ttdeci">MyIDType MinID</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00018">fof.h:18</a></div></div>
<div class="ttc" id="astructBaseGroup_html_aab1afcc30c625a6f2ae8e5c2cc40cf5c"><div class="ttname"><a href="structBaseGroup.html#aab1afcc30c625a6f2ae8e5c2cc40cf5c">BaseGroup::GrNr</a></div><div class="ttdeci">int GrNr</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00017">fof.h:17</a></div></div>
<div class="ttc" id="astructFOFGroups_html"><div class="ttname"><a href="structFOFGroups.html">FOFGroups</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00061">fof.h:62</a></div></div>
<div class="ttc" id="astructFOFParams_html_a4151c49228e3e5998d1ac91a8bda8da8"><div class="ttname"><a href="structFOFParams.html#a4151c49228e3e5998d1ac91a8bda8da8">FOFParams::FOFHaloComovingLinkingLength</a></div><div class="ttdeci">double FOFHaloComovingLinkingLength</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00043">fof.c:43</a></div></div>
<div class="ttc" id="astructFOFParams_html_a8c7053a8994f92828d960f92ba4b1613"><div class="ttname"><a href="structFOFParams.html#a8c7053a8994f92828d960f92ba4b1613">FOFParams::FOFPrimaryLinkTypes</a></div><div class="ttdeci">int FOFPrimaryLinkTypes</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00045">fof.c:45</a></div></div>
<div class="ttc" id="astructForceTree_html"><div class="ttname"><a href="structForceTree.html">ForceTree</a></div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00076">forcetree.h:76</a></div></div>
<div class="ttc" id="astructfof__particle__list_html"><div class="ttname"><a href="structfof__particle__list.html">fof_particle_list</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00090">fof.c:91</a></div></div>
<div class="ttc" id="astructfof__particle__list_html_a10c0ead10aeb6f1b026953493bfe3315"><div class="ttname"><a href="structfof__particle__list.html#a10c0ead10aeb6f1b026953493bfe3315">fof_particle_list::Pindex</a></div><div class="ttdeci">int Pindex</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00094">fof.c:94</a></div></div>
<div class="ttc" id="astructfof__particle__list_html_a8df88add6c36c83e3e5d3347df615d7f"><div class="ttname"><a href="structfof__particle__list.html#a8df88add6c36c83e3e5d3347df615d7f">fof_particle_list::MinID</a></div><div class="ttdeci">MyIDType MinID</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00092">fof.c:92</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="asystem_8h_html_a2ca58d338cd52c808ec1a86073940c49"><div class="ttname"><a href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a></div><div class="ttdeci">#define MPIU_Barrier(comm)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00103">system.h:103</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_ad7d4bd341445fe424000de03798b35e8"><div class="ttname"><a href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a></div><div class="ttdeci">#define qsort_openmp</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00014">test_exchange.c:14</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fof_8c_source.html#l00819">fof_alloc_group()</a>, <a class="el" href="fof_8c_source.html#l01062">fof_assign_grnr()</a>, <a class="el" href="fof_8c_source.html#l01404">fof_compare_HaloLabel_MinID()</a>, <a class="el" href="fof_8c_source.html#l00761">fof_compile_base()</a>, <a class="el" href="fof_8c_source.html#l00835">fof_compile_catalogue()</a>, <a class="el" href="fof_8c_source.html#l00369">fof_label_primary()</a>, <a class="el" href="fof_8c_source.html#l01207">fof_label_secondary()</a>, <a class="el" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <a class="el" href="fof_8c_source.html#l00043">FOFParams::FOFHaloComovingLinkingLength</a>, <a class="el" href="fof_8c_source.html#l00045">FOFParams::FOFPrimaryLinkTypes</a>, <a class="el" href="forcetree_8c_source.html#l01409">force_tree_free()</a>, <a class="el" href="forcetree_8c_source.html#l00161">force_tree_rebuild_mask()</a>, <a class="el" href="fof_8h_source.html#l00017">BaseGroup::GrNr</a>, <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="fof_8c_source.html#l00092">fof_particle_list::MinID</a>, <a class="el" href="fof_8h_source.html#l00018">BaseGroup::MinID</a>, <a class="el" href="fof_8c_source.html#l00142">MPI_TYPE_GROUP</a>, <a class="el" href="system_8h_source.html#l00103">MPIU_Barrier</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="mymalloc_8h_source.html#l00032">mymalloc_usedbytes</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8h_source.html#l00088">P</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="fof_8c_source.html#l00094">fof_particle_list::Pindex</a>, <a class="el" href="test__exchange_8c_source.html#l00014">qsort_openmp</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, <a class="el" href="run_8c_source.html#l00652">runfof()</a>, and <a class="el" href="test__fof_8c_source.html#l00071">test_fof()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_aef0df27f65ad2e5a95f66ae4e970da23_cgraph.svg" width="1060" height="1858"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_aef0df27f65ad2e5a95f66ae4e970da23_icgraph.svg" width="299" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a96820d22f0ab2a61425e423da2121fd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96820d22f0ab2a61425e423da2121fd6">&#9670;&nbsp;</a></span>fof_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fof_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DMMeanSeparation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l00066">66</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a4151c49228e3e5998d1ac91a8bda8da8">FOFHaloComovingLinkingLength</a> = <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#afde0e92f357bb16f0cb59e5a002e2b6d">FOFHaloLinkingLength</a> * DMMeanSeparation;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="ttc" id="astructFOFParams_html_afde0e92f357bb16f0cb59e5a002e2b6d"><div class="ttname"><a href="structFOFParams.html#afde0e92f357bb16f0cb59e5a002e2b6d">FOFParams::FOFHaloLinkingLength</a></div><div class="ttdeci">double FOFHaloLinkingLength</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00042">fof.c:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <a class="el" href="fof_8c_source.html#l00043">FOFParams::FOFHaloComovingLinkingLength</a>, and <a class="el" href="fof_8c_source.html#l00042">FOFParams::FOFHaloLinkingLength</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00086">init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_a96820d22f0ab2a61425e423da2121fd6_icgraph.svg" width="387" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a38d0e2572ef5e373fe12edd44a94ce92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38d0e2572ef5e373fe12edd44a94ce92">&#9670;&nbsp;</a></span>fof_save_groups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fof_save_groups </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>OutputDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>FOFFileBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>MassTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MetalReturnOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackholeOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l01113">1113</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;{</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="fof_8h.html#aaa985d617a622b54361bd8c756076b11">fof_save_particles</a>(fof, OutputDir, FOFFileBase, num, <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#aaea39a65a97b83babfdb976fdf11cbf5">FOFSaveParticles</a>, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, atime, MassTable, MetalReturnOn, BlackholeOn, Comm);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;}</div>
<div class="ttc" id="afof_8h_html_aaa985d617a622b54361bd8c756076b11"><div class="ttname"><a href="fof_8h.html#aaa985d617a622b54361bd8c756076b11">fof_save_particles</a></div><div class="ttdeci">void fof_save_particles(FOFGroups *fof, const char *OutputDir, const char *FOFFileBase, int num, int SaveParticles, Cosmology *CP, double atime, const double *MassTable, int MetalReturnOn, int BlackholeOn, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00032">fofpetaio.c:32</a></div></div>
<div class="ttc" id="apower_8c_html_aaca257a58f3e957a7db5fc91431eadf5"><div class="ttname"><a href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a></div><div class="ttdeci">static Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="power_8c_source.html#l00027">power.c:27</a></div></div>
<div class="ttc" id="astructFOFParams_html_aaea39a65a97b83babfdb976fdf11cbf5"><div class="ttname"><a href="structFOFParams.html#aaea39a65a97b83babfdb976fdf11cbf5">FOFParams::FOFSaveParticles</a></div><div class="ttdeci">int FOFSaveParticles</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00039">fof.c:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <a class="el" href="fofpetaio_8c_source.html#l00032">fof_save_particles()</a>, and <a class="el" href="fof_8c_source.html#l00039">FOFParams::FOFSaveParticles</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>, and <a class="el" href="run_8c_source.html#l00652">runfof()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_a38d0e2572ef5e373fe12edd44a94ce92_cgraph.svg" width="1895" height="1423"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_a38d0e2572ef5e373fe12edd44a94ce92_icgraph.svg" width="352" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aaa985d617a622b54361bd8c756076b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa985d617a622b54361bd8c756076b11">&#9670;&nbsp;</a></span>fof_save_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fof_save_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>OutputDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>FOFFileBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SaveParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCosmology.html">Cosmology</a> *&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>MassTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MetalReturnOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlackholeOn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fofpetaio_8c_source.html#l00032">32</a> of file <a class="el" href="fofpetaio_8c_source.html">fofpetaio.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                                                                                                                                                                                                  {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">struct </span><a class="code" href="structIOTable.html">IOTable</a> FOFIOTable = {0};</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">char</span> * fname = <a class="code" href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a>(<span class="stringliteral">&quot;%s/%s_%03d&quot;</span>, OutputDir, FOFFileBase, num);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Saving particle groups into %s\n&quot;</span>, fname);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="fofpetaio_8c.html#a733f38fec62d160ef64ab50ba9010d37">fof_register_io_blocks</a>(MetalReturnOn, BlackholeOn, &amp;FOFIOTable);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">/* sort the groups according to group-number */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="mpsort_8h.html#a585edcde90f736f146da84960a41401f">mpsort_mpi</a>(fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>, fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structGroup.html">Group</a>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <a class="code" href="fofpetaio_8c.html#abdd22faea7567c76dc09d1196fcdcbb1">fof_radix_Group_GrNr</a>, 8, NULL, Comm);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    BigFile bf = {0};</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span>(0 != big_file_mpi_create(&amp;bf, fname, Comm)) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Failed to open file at %s\n&quot;</span>, fname);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(fname);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconversions.html">conversions</a> conv = {0};</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    conv.<a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a> = <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    conv.<a class="code" href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">hubble</a> = <a class="code" href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a>(<a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(Comm);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="fofpetaio_8c.html#a6dc37f7fd4902e660ff7fd21f3565fff">fof_write_header</a>(&amp;bf, fof-&gt;<a class="code" href="structFOFGroups.html#ab2ab288906223aa744c9e07ecd12c61f">TotNgroups</a>, <a class="code" href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">atime</a>, MassTable, <a class="code" href="power_8c.html#aaca257a58f3e957a7db5fc91431eadf5">CP</a>, Comm);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; FOFIOTable.<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>; i ++) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">/* only process the particle blocks */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">char</span> blockname[128];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = FOFIOTable.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        BigArray array = {0};</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> == <a class="code" href="petaio_8h.html#a4e5345f6d90e069890abef6a26f69263">PTYPE_FOF_GROUP</a>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            sprintf(blockname, <span class="stringliteral">&quot;FOFGroups/%s&quot;</span>, FOFIOTable.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="fofpetaio_8c.html#a061f2af250c42035ff82a2b14c4abfe5">build_buffer_fof</a>(fof, &amp;array, &amp;FOFIOTable.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i], &amp;conv);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Writing Block %s\n&quot;</span>, blockname);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a>(&amp;bf, blockname, &amp;array, 1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <a class="code" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a>(&amp;array);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a>(&amp;FOFIOTable);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/IO/WriteFOF&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span>(SaveParticles) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">struct </span><a class="code" href="structIOTable.html">IOTable</a> <a class="code" href="structIOTable.html">IOTable</a> = {0};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">register_io_blocks</a>(&amp;<a class="code" href="structIOTable.html">IOTable</a>, 1, MetalReturnOn);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keyword">struct </span><a class="code" href="structpart__manager__type.html">part_manager_type</a> halo_pman = {0};</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">struct </span><a class="code" href="structslots__manager__type.html">slots_manager_type</a> halo_sman = {0};</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="fofpetaio_8c.html#a1acbf084a8ae3acf80bc22e10715a5de">fof_distribute_particles</a>(&amp;halo_pman, &amp;halo_sman, Comm)) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(halo_sman.<a class="code" href="structslots__manager__type.html#a5eac0624edf04d75ec4c7f6e366d4a0c">Base</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(halo_pman.<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a>(&amp;<a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">int</span> * selection = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;Selection&quot;</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * halo_pman.<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">int</span> ptype_offset[6]={0};</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordtype">int</span> ptype_count[6]={0};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">petaio_build_selection</a>(selection, ptype_offset, ptype_count, halo_pman.<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>, halo_pman.<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>, NULL);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/IO/argind&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="structIOTable.html">IOTable</a>.<a class="code" href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">used</a>; i ++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="comment">/* only process the particle blocks */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordtype">char</span> blockname[128];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a> = <a class="code" href="structIOTable.html">IOTable</a>.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">ptype</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            BigArray array = {0};</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">if</span>(ptype &lt; 6 &amp;&amp; ptype &gt;= 0) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                sprintf(blockname, <span class="stringliteral">&quot;%d/%s&quot;</span>, <a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>, <a class="code" href="structIOTable.html">IOTable</a>.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i].<a class="code" href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">name</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <a class="code" href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">petaio_build_buffer</a>(&amp;array, &amp;<a class="code" href="structIOTable.html">IOTable</a>.<a class="code" href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">ent</a>[i], selection + ptype_offset[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], ptype_count[<a class="code" href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a>], halo_pman.<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>, &amp;halo_sman, &amp;conv);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Writing Block %s\n&quot;</span>, blockname);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <a class="code" href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a>(&amp;bf, blockname, &amp;array, 1);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <a class="code" href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a>(&amp;array);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(selection);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(halo_sman.<a class="code" href="structslots__manager__type.html#a5eac0624edf04d75ec4c7f6e366d4a0c">Base</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(halo_pman.<a class="code" href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">Base</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/IO/WriteParticles&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a>(&amp;<a class="code" href="structIOTable.html">IOTable</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    big_file_mpi_close(&amp;bf, Comm);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Group catalogues saved.\n&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="acosmology_8c_html_ab425f16e6fe06110e2fb4944065b81bb"><div class="ttname"><a href="cosmology_8c.html#ab425f16e6fe06110e2fb4944065b81bb">hubble_function</a></div><div class="ttdeci">double hubble_function(const Cosmology *CP, double a)</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8c_source.html#l00058">cosmology.c:58</a></div></div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
<div class="ttc" id="afofpetaio_8c_html_a061f2af250c42035ff82a2b14c4abfe5"><div class="ttname"><a href="fofpetaio_8c.html#a061f2af250c42035ff82a2b14c4abfe5">build_buffer_fof</a></div><div class="ttdeci">static void build_buffer_fof(FOFGroups *fof, BigArray *array, IOTableEntry *ent, struct conversions *conv)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00333">fofpetaio.c:333</a></div></div>
<div class="ttc" id="afofpetaio_8c_html_a1acbf084a8ae3acf80bc22e10715a5de"><div class="ttname"><a href="fofpetaio_8c.html#a1acbf084a8ae3acf80bc22e10715a5de">fof_distribute_particles</a></div><div class="ttdeci">static int fof_distribute_particles(struct part_manager_type *halo_pman, struct slots_manager_type *halo_sman, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00249">fofpetaio.c:249</a></div></div>
<div class="ttc" id="afofpetaio_8c_html_a6dc37f7fd4902e660ff7fd21f3565fff"><div class="ttname"><a href="fofpetaio_8c.html#a6dc37f7fd4902e660ff7fd21f3565fff">fof_write_header</a></div><div class="ttdeci">static void fof_write_header(BigFile *bf, int64_t TotNgroups, const double atime, const double *MassTable, Cosmology *CP, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00347">fofpetaio.c:347</a></div></div>
<div class="ttc" id="afofpetaio_8c_html_a733f38fec62d160ef64ab50ba9010d37"><div class="ttname"><a href="fofpetaio_8c.html#a733f38fec62d160ef64ab50ba9010d37">fof_register_io_blocks</a></div><div class="ttdeci">static void fof_register_io_blocks(int MetalReturnOn, int BlackHoleOn, struct IOTable *IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00468">fofpetaio.c:468</a></div></div>
<div class="ttc" id="afofpetaio_8c_html_abdd22faea7567c76dc09d1196fcdcbb1"><div class="ttname"><a href="fofpetaio_8c.html#abdd22faea7567c76dc09d1196fcdcbb1">fof_radix_Group_GrNr</a></div><div class="ttdeci">static void fof_radix_Group_GrNr(const void *a, void *radix, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="fofpetaio_8c_source.html#l00026">fofpetaio.c:26</a></div></div>
<div class="ttc" id="ampsort_8h_html_a585edcde90f736f146da84960a41401f"><div class="ttname"><a href="mpsort_8h.html#a585edcde90f736f146da84960a41401f">mpsort_mpi</a></div><div class="ttdeci">#define mpsort_mpi(base, nmemb, elsize, radix, rsize, arg, comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpsort_8h_source.html#l00026">mpsort.h:26</a></div></div>
<div class="ttc" id="apetaio_8c_html_a00bc8b1ba2ab1de94d983b08b14580c7"><div class="ttname"><a href="petaio_8c.html#a00bc8b1ba2ab1de94d983b08b14580c7">petaio_destroy_buffer</a></div><div class="ttdeci">void petaio_destroy_buffer(BigArray *array)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00557">petaio.c:557</a></div></div>
<div class="ttc" id="apetaio_8c_html_a329a32cec3055c120a2b868dc53df379"><div class="ttname"><a href="petaio_8c.html#a329a32cec3055c120a2b868dc53df379">destroy_io_blocks</a></div><div class="ttdeci">void destroy_io_blocks(struct IOTable *IOTable)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l01034">petaio.c:1034</a></div></div>
<div class="ttc" id="apetaio_8c_html_a6d0888c0dbd0c70b0de352d0352c9906"><div class="ttname"><a href="petaio_8c.html#a6d0888c0dbd0c70b0de352d0352c9906">register_io_blocks</a></div><div class="ttdeci">void register_io_blocks(struct IOTable *IOTable, int WriteGroupID, int MetalReturnOn)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00909">petaio.c:909</a></div></div>
<div class="ttc" id="apetaio_8c_html_aacb623e82f8c6aa12d46c1c6e010bd9f"><div class="ttname"><a href="petaio_8c.html#aacb623e82f8c6aa12d46c1c6e010bd9f">petaio_build_selection</a></div><div class="ttdeci">void petaio_build_selection(int *selection, int *ptype_offset, int *ptype_count, const struct particle_data *Parts, const int NumPart, int(*select_func)(int i, const struct particle_data *Parts))</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00113">petaio.c:113</a></div></div>
<div class="ttc" id="apetaio_8c_html_ad7b91d2323ffc8919df52d90c9f3b6f2"><div class="ttname"><a href="petaio_8c.html#ad7b91d2323ffc8919df52d90c9f3b6f2">petaio_build_buffer</a></div><div class="ttdeci">void petaio_build_buffer(BigArray *array, IOTableEntry *ent, const int *selection, const int NumSelection, struct particle_data *Parts, struct slots_manager_type *SlotsManager, struct conversions *conv)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00521">petaio.c:521</a></div></div>
<div class="ttc" id="apetaio_8c_html_af6f495a272ad8ddce896b809aa18ad16"><div class="ttname"><a href="petaio_8c.html#af6f495a272ad8ddce896b809aa18ad16">petaio_save_block</a></div><div class="ttdeci">void petaio_save_block(BigFile *bf, const char *blockname, BigArray *array, int verbose)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00587">petaio.c:587</a></div></div>
<div class="ttc" id="apetaio_8h_html_a4e5345f6d90e069890abef6a26f69263"><div class="ttname"><a href="petaio_8h.html#a4e5345f6d90e069890abef6a26f69263">PTYPE_FOF_GROUP</a></div><div class="ttdeci">#define PTYPE_FOF_GROUP</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00066">petaio.h:66</a></div></div>
<div class="ttc" id="astring_8c_html_a787c3b0717214d830c69b7e8785a3e33"><div class="ttname"><a href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a></div><div class="ttdeci">char * fastpm_strdup_printf(const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00041">string.c:41</a></div></div>
<div class="ttc" id="astructFOFGroups_html_a457c36ab779b7af5964a3534cd238ab6"><div class="ttname"><a href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">FOFGroups::Ngroups</a></div><div class="ttdeci">int Ngroups</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00066">fof.h:66</a></div></div>
<div class="ttc" id="astructFOFGroups_html_ab2ab288906223aa744c9e07ecd12c61f"><div class="ttname"><a href="structFOFGroups.html#ab2ab288906223aa744c9e07ecd12c61f">FOFGroups::TotNgroups</a></div><div class="ttdeci">int64_t TotNgroups</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00067">fof.h:67</a></div></div>
<div class="ttc" id="astructGroup_html"><div class="ttname"><a href="structGroup.html">Group</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00025">fof.h:26</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_ab5ee266f94a60e5b12aab7c40b267c87"><div class="ttname"><a href="structIOTableEntry.html#ab5ee266f94a60e5b12aab7c40b267c87">IOTableEntry::ptype</a></div><div class="ttdeci">int ptype</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00052">petaio.h:52</a></div></div>
<div class="ttc" id="astructIOTableEntry_html_ae8210949ad522cfbf6342e4b8caeefc2"><div class="ttname"><a href="structIOTableEntry.html#ae8210949ad522cfbf6342e4b8caeefc2">IOTableEntry::name</a></div><div class="ttdeci">char name[64]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00051">petaio.h:51</a></div></div>
<div class="ttc" id="astructIOTable_html"><div class="ttname"><a href="structIOTable.html">IOTable</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00060">petaio.h:60</a></div></div>
<div class="ttc" id="astructIOTable_html_a5653cce54984987c97ee9473ad06c76d"><div class="ttname"><a href="structIOTable.html#a5653cce54984987c97ee9473ad06c76d">IOTable::used</a></div><div class="ttdeci">int used</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00062">petaio.h:62</a></div></div>
<div class="ttc" id="astructIOTable_html_aa59c489dda5e12b28ac676fec4935194"><div class="ttname"><a href="structIOTable.html#aa59c489dda5e12b28ac676fec4935194">IOTable::ent</a></div><div class="ttdeci">IOTableEntry * ent</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00061">petaio.h:61</a></div></div>
<div class="ttc" id="astructconversions_html"><div class="ttname"><a href="structconversions.html">conversions</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00039">petaio.h:40</a></div></div>
<div class="ttc" id="astructconversions_html_a5c554fbb955309fd8d5df4588baa9e35"><div class="ttname"><a href="structconversions.html#a5c554fbb955309fd8d5df4588baa9e35">conversions::atime</a></div><div class="ttdeci">double atime</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00041">petaio.h:41</a></div></div>
<div class="ttc" id="astructconversions_html_afe2ede2f433be43288e55c55dff47e70"><div class="ttname"><a href="structconversions.html#afe2ede2f433be43288e55c55dff47e70">conversions::hubble</a></div><div class="ttdeci">double hubble</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00042">petaio.h:42</a></div></div>
<div class="ttc" id="astructpart__manager__type_html"><div class="ttname"><a href="structpart__manager__type.html">part_manager_type</a></div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00073">partmanager.h:73</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a4dcf875204ca1e4c7cbcfe313ca6dea9"><div class="ttname"><a href="structpart__manager__type.html#a4dcf875204ca1e4c7cbcfe313ca6dea9">part_manager_type::Base</a></div><div class="ttdeci">struct particle_data * Base</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00074">partmanager.h:74</a></div></div>
<div class="ttc" id="astructslots__manager__type_html"><div class="ttname"><a href="structslots__manager__type.html">slots_manager_type</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00111">slotsmanager.h:111</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a5eac0624edf04d75ec4c7f6e366d4a0c"><div class="ttname"><a href="structslots__manager__type.html#a5eac0624edf04d75ec4c7f6e366d4a0c">slots_manager_type::Base</a></div><div class="ttdeci">char * Base</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00113">slotsmanager.h:113</a></div></div>
<div class="ttc" id="azeldovich_8c_html_a953067f6751c09a3d2e7554c74fcbf6d"><div class="ttname"><a href="zeldovich_8c.html#a953067f6751c09a3d2e7554c74fcbf6d">ptype</a></div><div class="ttdeci">static enum TransferType ptype</div><div class="ttdef"><b>Definition:</b> <a href="zeldovich_8c_source.html#l00113">zeldovich.c:146</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="petaio_8h_source.html#l00041">conversions::atime</a>, <a class="el" href="partmanager_8h_source.html#l00074">part_manager_type::Base</a>, <a class="el" href="slotsmanager_8h_source.html#l00113">slots_manager_type::Base</a>, <a class="el" href="fofpetaio_8c_source.html#l00333">build_buffer_fof()</a>, <a class="el" href="power_8c_source.html#l00027">CP</a>, <a class="el" href="petaio_8c_source.html#l01034">destroy_io_blocks()</a>, <a class="el" href="endrun_8c_source.html#l00147">endrun()</a>, <a class="el" href="petaio_8h_source.html#l00061">IOTable::ent</a>, <a class="el" href="string_8c_source.html#l00041">fastpm_strdup_printf()</a>, <a class="el" href="fofpetaio_8c_source.html#l00249">fof_distribute_particles()</a>, <a class="el" href="fofpetaio_8c_source.html#l00026">fof_radix_Group_GrNr()</a>, <a class="el" href="fofpetaio_8c_source.html#l00468">fof_register_io_blocks()</a>, <a class="el" href="fofpetaio_8c_source.html#l00347">fof_write_header()</a>, <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="petaio_8h_source.html#l00042">conversions::hubble</a>, <a class="el" href="cosmology_8c_source.html#l00058">hubble_function()</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="system_8h_source.html#l00103">MPIU_Barrier</a>, <a class="el" href="mpsort_8h_source.html#l00026">mpsort_mpi</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="petaio_8h_source.html#l00051">IOTableEntry::name</a>, <a class="el" href="fof_8h_source.html#l00066">FOFGroups::Ngroups</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="petaio_8c_source.html#l00521">petaio_build_buffer()</a>, <a class="el" href="petaio_8c_source.html#l00113">petaio_build_selection()</a>, <a class="el" href="petaio_8c_source.html#l00557">petaio_destroy_buffer()</a>, <a class="el" href="petaio_8c_source.html#l00587">petaio_save_block()</a>, <a class="el" href="petaio_8h_source.html#l00052">IOTableEntry::ptype</a>, <a class="el" href="zeldovich_8c_source.html#l00146">ptype</a>, <a class="el" href="petaio_8h_source.html#l00066">PTYPE_FOF_GROUP</a>, <a class="el" href="petaio_8c_source.html#l00909">register_io_blocks()</a>, <a class="el" href="fof_8h_source.html#l00067">FOFGroups::TotNgroups</a>, <a class="el" href="petaio_8h_source.html#l00062">IOTable::used</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="fof_8c_source.html#l01113">fof_save_groups()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_aaa985d617a622b54361bd8c756076b11_cgraph.svg" width="1740" height="1588"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_aaa985d617a622b54361bd8c756076b11_icgraph.svg" width="542" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac636ce7b1a72cfabfee3a11fadc0aeb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac636ce7b1a72cfabfee3a11fadc0aeb5">&#9670;&nbsp;</a></span>fof_seed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fof_seed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFOFGroups.html">FOFGroups</a> *&#160;</td>
          <td class="paramname"><em>fof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structActiveParticles.html">ActiveParticles</a> *&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>Comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l01290">1290</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;{</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordtype">int</span> i, j, n, ntot;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    MPI_Comm_size(Comm, &amp;<a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordtype">char</span> * Marked = (<span class="keywordtype">char</span> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;SeedMark&quot;</span>, fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordtype">int</span> Nexport = 0;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+:Nexport)</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>; i++)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        Marked[i] =</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            (fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#ae5e53fabd8ee14e6d5d241cbeead40fd">Mass</a> &gt;= <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a600de2d30b210af82ea5959eca5877d7">MinFoFMassForNewSeed</a>)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        &amp;&amp;  (fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#ab4a981290e80ae095c99afd766cf8407">MassType</a>[4] &gt;= <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#abaaa6ba512883ffe78bc5f0167c5e82e">MinMStarForNewSeed</a>)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        &amp;&amp;  (fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#acddad36834af94c1a68682836ac370bf">LenType</a>[5] == 0)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        &amp;&amp;  (fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i].<a class="code" href="structGroup.html#a94c2dc2ae0f6f2befda3ad71816067f2">seed_index</a> &gt;= 0);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span>(Marked[i]) Nexport ++;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keyword">struct </span><a class="code" href="structGroup.html">Group</a> * ExportGroups = (<span class="keyword">struct </span><a class="code" href="structGroup.html">Group</a> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;Export&quot;</span>, <span class="keyword">sizeof</span>(fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[0]) * Nexport);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    j = 0;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; fof-&gt;<a class="code" href="structFOFGroups.html#a457c36ab779b7af5964a3534cd238ab6">Ngroups</a>; i ++) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">if</span>(Marked[i]) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            ExportGroups[j] = fof-&gt;<a class="code" href="structFOFGroups.html#a2d0285df13a54af4ca09a6eaf28ea4b1">Group</a>[i];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            j++;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(Marked);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="test__exchange_8c.html#ad7d4bd341445fe424000de03798b35e8">qsort_openmp</a>(ExportGroups, Nexport, <span class="keyword">sizeof</span>(ExportGroups[0]), <a class="code" href="fof_8c.html#aa0b509a412ea6c943cf657d4c68a9cf2">cmp_seed_task</a>);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordtype">int</span> * Send_count = <a class="code" href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a>(<span class="stringliteral">&quot;Send_count&quot;</span>, <span class="keywordtype">int</span>, <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">int</span> * Recv_count = <a class="code" href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a>(<span class="stringliteral">&quot;Recv_count&quot;</span>, <span class="keywordtype">int</span>, <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    memset(Send_count, 0, <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; Nexport; i++) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        Send_count[ExportGroups[i].<a class="code" href="structGroup.html#acc4dfc0c265b718f07f9f407c4f75589">seed_task</a>]++;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    MPI_Alltoall(Send_count, 1, MPI_INT, Recv_count, 1, MPI_INT, Comm);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordtype">int</span> Nimport = 0;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">for</span>(j = 0;  j &lt; <a class="code" href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>; j++)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        Nimport += Recv_count[j];</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keyword">struct </span><a class="code" href="structGroup.html">Group</a> * ImportGroups = (<span class="keyword">struct </span><a class="code" href="structGroup.html">Group</a> *)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;ImportGroups&quot;</span>, Nimport * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structGroup.html">Group</a>));</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="system_8c.html#a3ceeaa7b959adb85bf1cfc731bc5c7ec">MPI_Alltoallv_smart</a>(ExportGroups, Send_count, NULL, <a class="code" href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a>,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                        ImportGroups, Recv_count, NULL, <a class="code" href="fof_8c.html#aca1f7f4ea3a3a3c9a3bf4fddee5ed0d6">MPI_TYPE_GROUP</a>,</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        Comm);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(ExportGroups);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a>(Recv_count);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <a class="code" href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a>(Send_count);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    MPI_Allreduce(&amp;Nimport, &amp;ntot, 1, MPI_INT, MPI_SUM, Comm);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Making %d new black hole particles.\n&quot;</span>, ntot);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">/* Do we have enough black hole slots to create this many black holes?</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">     * If not, allocate more slots. */</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span>(Nimport + <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[5].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a> &gt; <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[5].<a class="code" href="structslot__info.html#a7b67ebbddce987acdd80262a51f2e8c6">maxsize</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordtype">int</span> *ActiveParticle_tmp=NULL;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="comment">/* This is only called on a PM step, so the condition should never be true*/</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">if</span>(act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            ActiveParticle_tmp = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;ActiveParticle_tmp&quot;</span>, act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            memmove(ActiveParticle_tmp, act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>, act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="comment">/*Now we can extend the slots! */</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        int64_t atleast[6];</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        int64_t i;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; 6; i++)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            atleast[i] = <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[i].<a class="code" href="structslot__info.html#a7b67ebbddce987acdd80262a51f2e8c6">maxsize</a>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        atleast[5] += ntot*1.1;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <a class="code" href="slotsmanager_8c.html#a0effa6d52d74a3ca0b91c1cae3b72b5e">slots_reserve</a>(1, atleast, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="comment">/*And now we need our memory back in the right place*/</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">if</span>(ActiveParticle_tmp) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a> = (<span class="keywordtype">int</span> *) <a class="code" href="mymalloc_8h.html#a3eb707b32b6ac69f2df085e4bc098cc4">mymalloc</a>(<span class="stringliteral">&quot;ActiveParticle&quot;</span>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> + <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">MaxPart</a> - <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>));</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            memmove(act-&gt;<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>, ActiveParticle_tmp, act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(ActiveParticle_tmp);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    MPI_Comm_rank(Comm, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">for</span>(n = 0; n &lt; Nimport; n++)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="fof_8c.html#a6facaa206c5d998cae9a8be178b7dbf9">fof_seed_make_one</a>(&amp;ImportGroups[n], <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>, atime);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(ImportGroups);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/FOF/Seeding&quot;</span>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
<div class="ttc" id="afof_8c_html_a6facaa206c5d998cae9a8be178b7dbf9"><div class="ttname"><a href="fof_8c.html#a6facaa206c5d998cae9a8be178b7dbf9">fof_seed_make_one</a></div><div class="ttdeci">static void fof_seed_make_one(struct Group *g, int ThisTask, const double atime)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01396">fof.c:1396</a></div></div>
<div class="ttc" id="afof_8c_html_aa0b509a412ea6c943cf657d4c68a9cf2"><div class="ttname"><a href="fof_8c.html#aa0b509a412ea6c943cf657d4c68a9cf2">cmp_seed_task</a></div><div class="ttdeci">static int cmp_seed_task(const void *c1, const void *c2)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01282">fof.c:1282</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a52bc2c6ec78b17bb6d42957cbf642f15"><div class="ttname"><a href="mymalloc_8h.html#a52bc2c6ec78b17bb6d42957cbf642f15">ta_malloc</a></div><div class="ttdeci">#define ta_malloc(name, type, nele)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00025">mymalloc.h:25</a></div></div>
<div class="ttc" id="amymalloc_8h_html_a84e2115e90e9c22e11d9663c019fc8bc"><div class="ttname"><a href="mymalloc_8h.html#a84e2115e90e9c22e11d9663c019fc8bc">ta_free</a></div><div class="ttdeci">#define ta_free(p)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00028">mymalloc.h:28</a></div></div>
<div class="ttc" id="amymalloc_8h_html_ac576b6f19b635b512399d6afb8c20d99"><div class="ttname"><a href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a></div><div class="ttdeci">#define mymalloc2(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00016">mymalloc.h:16</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a0effa6d52d74a3ca0b91c1cae3b72b5e"><div class="ttname"><a href="slotsmanager_8c.html#a0effa6d52d74a3ca0b91c1cae3b72b5e">slots_reserve</a></div><div class="ttdeci">size_t slots_reserve(int where, int64_t atleast[6], struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00475">slotsmanager.c:475</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a1b0b230f3890d70bae976516719b7d07"><div class="ttname"><a href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticles::ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00013">timestep.h:13</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a847ab898fdabc62a4723c7c3a66038d4"><div class="ttname"><a href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">ActiveParticles::NumActiveParticle</a></div><div class="ttdeci">int64_t NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00012">timestep.h:12</a></div></div>
<div class="ttc" id="astructFOFParams_html_a600de2d30b210af82ea5959eca5877d7"><div class="ttname"><a href="structFOFParams.html#a600de2d30b210af82ea5959eca5877d7">FOFParams::MinFoFMassForNewSeed</a></div><div class="ttdeci">double MinFoFMassForNewSeed</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00040">fof.c:40</a></div></div>
<div class="ttc" id="astructFOFParams_html_abaaa6ba512883ffe78bc5f0167c5e82e"><div class="ttname"><a href="structFOFParams.html#abaaa6ba512883ffe78bc5f0167c5e82e">FOFParams::MinMStarForNewSeed</a></div><div class="ttdeci">double MinMStarForNewSeed</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00041">fof.c:41</a></div></div>
<div class="ttc" id="astructGroup_html_a94c2dc2ae0f6f2befda3ad71816067f2"><div class="ttname"><a href="structGroup.html#a94c2dc2ae0f6f2befda3ad71816067f2">Group::seed_index</a></div><div class="ttdeci">int seed_index</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00056">fof.h:56</a></div></div>
<div class="ttc" id="astructGroup_html_ab4a981290e80ae095c99afd766cf8407"><div class="ttname"><a href="structGroup.html#ab4a981290e80ae095c99afd766cf8407">Group::MassType</a></div><div class="ttdeci">double MassType[6]</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00030">fof.h:30</a></div></div>
<div class="ttc" id="astructGroup_html_acc4dfc0c265b718f07f9f407c4f75589"><div class="ttname"><a href="structGroup.html#acc4dfc0c265b718f07f9f407c4f75589">Group::seed_task</a></div><div class="ttdeci">int seed_task</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00057">fof.h:57</a></div></div>
<div class="ttc" id="astructGroup_html_acddad36834af94c1a68682836ac370bf"><div class="ttname"><a href="structGroup.html#acddad36834af94c1a68682836ac370bf">Group::LenType</a></div><div class="ttdeci">int LenType[6]</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00029">fof.h:29</a></div></div>
<div class="ttc" id="astructGroup_html_ae5e53fabd8ee14e6d5d241cbeead40fd"><div class="ttname"><a href="structGroup.html#ae5e53fabd8ee14e6d5d241cbeead40fd">Group::Mass</a></div><div class="ttdeci">double Mass</div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00031">fof.h:31</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a5e24abb34f2c8998d8b35c217477d580"><div class="ttname"><a href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">part_manager_type::MaxPart</a></div><div class="ttdeci">int64_t MaxPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00078">partmanager.h:78</a></div></div>
<div class="ttc" id="astructslot__info_html_a7b67ebbddce987acdd80262a51f2e8c6"><div class="ttname"><a href="structslot__info.html#a7b67ebbddce987acdd80262a51f2e8c6">slot_info::maxsize</a></div><div class="ttdeci">int64_t maxsize</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00011">slotsmanager.h:11</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
<div class="ttc" id="asystem_8c_html_a3ceeaa7b959adb85bf1cfc731bc5c7ec"><div class="ttname"><a href="system_8c.html#a3ceeaa7b959adb85bf1cfc731bc5c7ec">MPI_Alltoallv_smart</a></div><div class="ttdeci">int MPI_Alltoallv_smart(void *sendbuf, int *sendcnts, int *sdispls, MPI_Datatype sendtype, void *recvbuf, int *recvcnts, int *rdispls, MPI_Datatype recvtype, MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00278">system.c:278</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a675acdcd149f5993271a1fdc11673b65"><div class="ttname"><a href="test__exchange_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a></div><div class="ttdeci">int NTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="timestep_8h_source.html#l00013">ActiveParticles::ActiveParticle</a>, <a class="el" href="fof_8c_source.html#l01282">cmp_seed_task()</a>, <a class="el" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <a class="el" href="fof_8c_source.html#l01396">fof_seed_make_one()</a>, <a class="el" href="fof_8h_source.html#l00063">FOFGroups::Group</a>, <a class="el" href="slotsmanager_8h_source.html#l00112">slots_manager_type::info</a>, <a class="el" href="fof_8h_source.html#l00029">Group::LenType</a>, <a class="el" href="fof_8h_source.html#l00031">Group::Mass</a>, <a class="el" href="fof_8h_source.html#l00030">Group::MassType</a>, <a class="el" href="partmanager_8h_source.html#l00078">part_manager_type::MaxPart</a>, <a class="el" href="slotsmanager_8h_source.html#l00011">slot_info::maxsize</a>, <a class="el" href="endrun_8c_source.html#l00175">message()</a>, <a class="el" href="fof_8c_source.html#l00040">FOFParams::MinFoFMassForNewSeed</a>, <a class="el" href="fof_8c_source.html#l00041">FOFParams::MinMStarForNewSeed</a>, <a class="el" href="system_8c_source.html#l00278">MPI_Alltoallv_smart()</a>, <a class="el" href="fof_8c_source.html#l00142">MPI_TYPE_GROUP</a>, <a class="el" href="mymalloc_8h_source.html#l00019">myfree</a>, <a class="el" href="mymalloc_8h_source.html#l00015">mymalloc</a>, <a class="el" href="mymalloc_8h_source.html#l00016">mymalloc2</a>, <a class="el" href="fof_8h_source.html#l00066">FOFGroups::Ngroups</a>, <a class="el" href="test__exchange_8c_source.html#l00023">NTask</a>, <a class="el" href="timestep_8h_source.html#l00012">ActiveParticles::NumActiveParticle</a>, <a class="el" href="partmanager_8h_source.html#l00076">part_manager_type::NumPart</a>, <a class="el" href="partmanager_8c_source.html#l00011">PartManager</a>, <a class="el" href="test__exchange_8c_source.html#l00014">qsort_openmp</a>, <a class="el" href="fof_8h_source.html#l00056">Group::seed_index</a>, <a class="el" href="fof_8h_source.html#l00057">Group::seed_task</a>, <a class="el" href="slotsmanager_8h_source.html#l00012">slot_info::size</a>, <a class="el" href="slotsmanager_8c_source.html#l00475">slots_reserve()</a>, <a class="el" href="slotsmanager_8c_source.html#l00007">SlotsManager</a>, <a class="el" href="mymalloc_8h_source.html#l00028">ta_free</a>, <a class="el" href="mymalloc_8h_source.html#l00025">ta_malloc</a>, <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>, and <a class="el" href="walltime_8h_source.html#l00008">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c_source.html#l00284">run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_ac636ce7b1a72cfabfee3a11fadc0aeb5_cgraph.svg" width="1262" height="316"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_ac636ce7b1a72cfabfee3a11fadc0aeb5_icgraph.svg" width="283" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6c49b36d075d061975ada82ecc78763c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c49b36d075d061975ada82ecc78763c">&#9670;&nbsp;</a></span>set_fof_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_fof_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParameterSet.html">ParameterSet</a> *&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fof_8c_source.html#l00050">50</a> of file <a class="el" href="fof_8c_source.html">fof.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#aaea39a65a97b83babfdb976fdf11cbf5">FOFSaveParticles</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;FOFSaveParticles&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#afde0e92f357bb16f0cb59e5a002e2b6d">FOFHaloLinkingLength</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;FOFHaloLinkingLength&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#aa9a09f7dfe48d2c7c166d9df2830b8a4">FOFHaloMinLength</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;FOFHaloMinLength&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a600de2d30b210af82ea5959eca5877d7">MinFoFMassForNewSeed</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MinFoFMassForNewSeed&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#abaaa6ba512883ffe78bc5f0167c5e82e">MinMStarForNewSeed</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MinMStarForNewSeed&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#a8c7053a8994f92828d960f92ba4b1613">FOFPrimaryLinkTypes</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;FOFPrimaryLinkTypes&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>.<a class="code" href="structFOFParams.html#aa077c14b490dd81de4e0fa8b6111e508">FOFSecondaryLinkTypes</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;FOFSecondaryLinkTypes&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    MPI_Bcast(&amp;<a class="code" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structFOFParams.html">FOFParams</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="aparamset_8c_html_a6228c17649c46aef53e74cd7ccb93fb0"><div class="ttname"><a href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a></div><div class="ttdeci">int param_get_int(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00368">paramset.c:368</a></div></div>
<div class="ttc" id="astructFOFParams_html"><div class="ttname"><a href="structFOFParams.html">FOFParams</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00037">fof.c:38</a></div></div>
<div class="ttc" id="astructFOFParams_html_aa077c14b490dd81de4e0fa8b6111e508"><div class="ttname"><a href="structFOFParams.html#aa077c14b490dd81de4e0fa8b6111e508">FOFParams::FOFSecondaryLinkTypes</a></div><div class="ttdeci">int FOFSecondaryLinkTypes</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00046">fof.c:46</a></div></div>
<div class="ttc" id="astructFOFParams_html_aa9a09f7dfe48d2c7c166d9df2830b8a4"><div class="ttname"><a href="structFOFParams.html#aa9a09f7dfe48d2c7c166d9df2830b8a4">FOFParams::FOFHaloMinLength</a></div><div class="ttdeci">int FOFHaloMinLength</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00044">fof.c:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fof_8c.html#af36e943612e1e4fece5b4b9cd1e2a94c">fof_params</a>, <a class="el" href="fof_8c_source.html#l00042">FOFParams::FOFHaloLinkingLength</a>, <a class="el" href="fof_8c_source.html#l00044">FOFParams::FOFHaloMinLength</a>, <a class="el" href="fof_8c_source.html#l00045">FOFParams::FOFPrimaryLinkTypes</a>, <a class="el" href="fof_8c_source.html#l00039">FOFParams::FOFSaveParticles</a>, <a class="el" href="fof_8c_source.html#l00046">FOFParams::FOFSecondaryLinkTypes</a>, <a class="el" href="fof_8c_source.html#l00040">FOFParams::MinFoFMassForNewSeed</a>, <a class="el" href="fof_8c_source.html#l00041">FOFParams::MinMStarForNewSeed</a>, <a class="el" href="paramset_8c_source.html#l00336">param_get_double()</a>, <a class="el" href="paramset_8c_source.html#l00368">param_get_int()</a>, and <a class="el" href="test__exchange_8c_source.html#l00023">ThisTask</a>.</p>

<p class="reference">Referenced by <a class="el" href="gadget_2params_8c_source.html#l00359">read_parameter_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_a6c49b36d075d061975ada82ecc78763c_cgraph.svg" width="791" height="130"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="fof_8h_a6c49b36d075d061975ada82ecc78763c_icgraph.svg" width="438" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
