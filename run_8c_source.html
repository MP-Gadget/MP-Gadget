<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: libgadget/run.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.1.dev1-76bc7d4726-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8db5bc7a24c620673ff2e44953ca6f6c.html">libgadget</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">run.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="run_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">    1</a></span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="string_8h.html">string.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html">utils.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="walltime_8h.html">walltime.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gravity_8h.html">gravity.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="density_8h.html">density.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="domain_8h.html">domain.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="run_8h.html">run.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="init_8h.html">init.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cooling_8h.html">cooling.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="checkpoint_8h.html">checkpoint.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="petaio_8h.html">petaio.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="petapm_8h.html">petapm.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timestep_8h.html">timestep.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="drift_8h.html">drift.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="forcetree_8h.html">forcetree.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="blackhole_8h.html">blackhole.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hydra_8h.html">hydra.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sfr__eff_8h.html">sfr_eff.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="metal__return_8h.html">metal_return.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slotsmanager_8h.html">slotsmanager.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hci_8h.html">hci.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fof_8h.html">fof.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cooling__qso__lightup_8h.html">cooling_qso_lightup.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lightcone_8h.html">lightcone.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timefac_8h.html">timefac.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="neutrinos__lra_8h.html">neutrinos_lra.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stats_8h.html">stats.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structClockTable.html">ClockTable</a> <a class="code" href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">Clocks</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structrun__params.html">   45</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structrun__params.html">run_params</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structrun__params.html#ab19d5268dd01d7a2ac48489c0cb0df95">   47</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#ab19d5268dd01d7a2ac48489c0cb0df95">SlotsIncreaseFactor</a>; <span class="comment">/* !&lt; What percentage to increase the slot allocation by when requested*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structrun__params.html#a1634ca118e6f917177ec1db22310f6d0">   48</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a1634ca118e6f917177ec1db22310f6d0">OutputDebugFields</a>;      <span class="comment">/* Flag whether to include a lot of debug output in snapshots*/</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">   50</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">RandomParticleOffset</a>; <span class="comment">/* If &gt; 0, a random shift of max RandomParticleOffset * BoxSize is applied to every particle</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">                                  * every time a full domain decomposition is done. The box is periodic and the offset</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">                                  * is subtracted on output, so this only affects the internal gravity solver.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">                                  * The purpose of this is to avoid correlated errors in the tree code, which occur when</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">                                  * the tree opening conditions are similar in every timestep and accumulate over a</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">                                  * long period of time. Upstream Arepo says this substantially improves momentum conservation,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">                                  * and it has the side-effect of guarding against periodicity bugs.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">                                  */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/* Cosmology */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">   59</a></span>&#160;    <a class="code" href="structCosmology.html">Cosmology</a> <a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/* Code options */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">   62</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">CoolingOn</a>;  <span class="comment">/* if cooling is enabled */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structrun__params.html#a5b739219a9e9cb1042bb7ab2e28bce98">   63</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a5b739219a9e9cb1042bb7ab2e28bce98">HydroOn</a>;  <span class="comment">/*  if hydro force is enabled */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structrun__params.html#a44c95cdbb3636975f9e0fb0d6f47b949">   64</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a44c95cdbb3636975f9e0fb0d6f47b949">DensityOn</a>;  <span class="comment">/*  if SPH density computation is enabled */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">   65</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">TreeGravOn</a>;     <span class="comment">/* tree gravity force is enabled*/</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">   67</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>;  <span class="comment">/* if black holes are enabled */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">   68</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a>;  <span class="comment">/* if star formation is enabled */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">   69</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a>; <span class="comment">/* If late return of metals from AGB stars is enabled*/</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">   70</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">LightconeOn</a>;    <span class="comment">/* Enable the light cone module,</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">                           which writes a list of particles to a file as they cross a light cone*/</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structrun__params.html#afaa0f8c8fbf3117e10ecfcfcbf4085b9">   73</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#afaa0f8c8fbf3117e10ecfcfcbf4085b9">MaxDomainTimeBinDepth</a>; <span class="comment">/* We should redo domain decompositions every timestep, after the timestep hierarchy gets deeper than this.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">                                  Essentially forces a domain decompositon every 2^MaxDomainTimeBinDepth timesteps.*/</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">   75</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">/* parameters determining output frequency */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structrun__params.html#ab9316029bbb13493628c2c3ad897f7c5">   77</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#ab9316029bbb13493628c2c3ad897f7c5">PairwiseActiveFraction</a>; <span class="comment">/* Fraction of particles active for which we do a pairwise computation instead of a tree*/</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">/* parameters determining output frequency */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structrun__params.html#ad0886392c89d4ea973eb708d39108303">   80</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#ad0886392c89d4ea973eb708d39108303">AutoSnapshotTime</a>;    </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structrun__params.html#a746498a1812101686266ebbbb6092084">   81</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#a746498a1812101686266ebbbb6092084">TimeBetweenSeedingSearch</a>; <span class="comment">/*Factor to multiply TimeInit by to find the next seeding check.*/</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">   83</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">TimeMax</a>;         </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">   85</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">/* variables that keep track of cumulative CPU consumption */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structrun__params.html#a1e13b59dd08195b44de3c83d47ec1897">   89</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#a1e13b59dd08195b44de3c83d47ec1897">TimeLimitCPU</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">   92</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">enum</span> <a class="code" href="gravity_8h.html#afb6e6af8351f539b8c7d6e3a83f322bc">ShortRangeForceWindowType</a> <a class="code" href="structrun__params.html#a3b130ce4a4b8d01bd62166f7f145a298">ShortRangeForceWindowType</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">/* some filenames */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">   96</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>[100],</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">   97</a></span>&#160;         <a class="code" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">FOFFileBase</a>[100];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">   99</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">SnapshotWithFOF</a>; <span class="comment">/*Flag that doing FOF for snapshot outputs is on*/</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">  101</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">RandomSeed</a>; <span class="comment">/*Initial seed for the random number table*/</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="run_8c.html#ac375cbba056f17379640791c81947612">  102</a></span>&#160;} <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/*Set the global parameters*/</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="run_8c.html#a5cf63750ffcbf4a841f300b3887a3727">  106</a></span>&#160;<a class="code" href="run_8c.html#a5cf63750ffcbf4a841f300b3887a3727">set_all_global_params</a>(<a class="code" href="structParameterSet.html">ParameterSet</a> * ps)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">/* Start reading the values */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a>(ps, <span class="stringliteral">&quot;OutputDir&quot;</span>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <span class="keyword">sizeof</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a>(ps, <span class="stringliteral">&quot;FOFFileBase&quot;</span>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">FOFFileBase</a>, <span class="keyword">sizeof</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">FOFFileBase</a>));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">CMBTemperature</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;CMBTemperature&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a443cf4ce10b4d5a2b242d4a2f9078866">RadiationOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;RadiationOn&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;Omega0&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;OmegaBaryon&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;OmegaLambda&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a38009c7acc85c095a49eb23af5180d9b">Omega_fld</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;Omega_fld&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">OmegaLambda</a> &gt; 0 &amp;&amp; <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a38009c7acc85c095a49eb23af5180d9b">Omega_fld</a> &gt; 0)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Cannot have OmegaLambda and Omega_fld (evolving dark energy) at the same time!\n&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af37a1c97e02105a06e1dcb9112f1db5b">w0_fld</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps,<span class="stringliteral">&quot;w0_fld&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a10a2776043457f88c4bf314fcc399221">wa_fld</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps,<span class="stringliteral">&quot;wa_fld&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a121b6c180aa46cff6bc708a78b4ebce7">Omega_ur</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;Omega_ur&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">HubbleParam</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;HubbleParam&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a1634ca118e6f917177ec1db22310f6d0">OutputDebugFields</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;OutputDebugFields&quot;</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">TimeMax</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;TimeMax&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;Asmth&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3b130ce4a4b8d01bd62166f7f145a298">ShortRangeForceWindowType</a> = (<span class="keyword">enum</span> <a class="code" href="gravity_8h.html#afb6e6af8351f539b8c7d6e3a83f322bc">ShortRangeForceWindowType</a>) <a class="code" href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a>(ps, <span class="stringliteral">&quot;ShortRangeForceWindowType&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;Nmesh&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">CoolingOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;CoolingOn&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a5b739219a9e9cb1042bb7ab2e28bce98">HydroOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;HydroOn&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a44c95cdbb3636975f9e0fb0d6f47b949">DensityOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;DensityOn&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">TreeGravOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;TreeGravOn&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">LightconeOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;LightconeOn&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;FastParticleType&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ab9316029bbb13493628c2c3ad897f7c5">PairwiseActiveFraction</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;PairwiseActiveFraction&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a1e13b59dd08195b44de3c83d47ec1897">TimeLimitCPU</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;TimeLimitCPU&quot;</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ad0886392c89d4ea973eb708d39108303">AutoSnapshotTime</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;AutoSnapshotTime&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a746498a1812101686266ebbbb6092084">TimeBetweenSeedingSearch</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;TimeBetweenSeedingSearch&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">RandomParticleOffset</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;RandomParticleOffset&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">/* Convert to a fraction of the box, from a fraction of a PM mesh cell*/</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">RandomParticleOffset</a> /= <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ab19d5268dd01d7a2ac48489c0cb0df95">SlotsIncreaseFactor</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;SlotsIncreaseFactor&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">SnapshotWithFOF</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;SnapshotWithFOF&quot;</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">RandomSeed</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;RandomSeed&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;BlackHoleOn&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;StarformationOn&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;MetalReturnOn&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afaa0f8c8fbf3117e10ecfcfcbf4085b9">MaxDomainTimeBinDepth</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;MaxDomainTimeBinDepth&quot;</span>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">/*Massive neutrino parameters*/</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;MassiveNuLinRespOn&quot;</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a17dd6ac8ee1e3bf0469904d0ff5f67d5">HybridNeutrinosOn</a> = <a class="code" href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a>(ps, <span class="stringliteral">&quot;HybridNeutrinosOn&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ae9e96a98294e31d5d2ab18e244e8fa33">MNu</a>[0] = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MNue&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ae9e96a98294e31d5d2ab18e244e8fa33">MNu</a>[1] = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MNum&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ae9e96a98294e31d5d2ab18e244e8fa33">MNu</a>[2] = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;MNut&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a5c6cde04880e3be264f528e8b7dd5c8d">HybridVcrit</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;Vcrit&quot;</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#acae4b7f6fe916eb7913dbe60eab18b4f">HybridNuPartTime</a> = <a class="code" href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a>(ps, <span class="stringliteral">&quot;NuPartTime&quot;</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a> &amp;&amp; !<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a443cf4ce10b4d5a2b242d4a2f9078866">RadiationOn</a>)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(2, <span class="stringliteral">&quot;You have enabled (kspace) massive neutrinos without radiation, but this will give an inconsistent cosmology!\n&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">/*End massive neutrino parameters*/</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a> != 0 &amp;&amp; <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">CoolingOn</a> == 0)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;You try to use the code with star formation enabled,\n&quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                          <span class="stringliteral">&quot;but you did not switch on cooling.\nThis mode is not supported.\n&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    MPI_Bcast(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>, <span class="keyword">sizeof</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>), MPI_BYTE, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="run_8c.html#a0ad0c5dc6cd8a823b1c4b3605c3a3cb1">  182</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="run_8c.html#a0ad0c5dc6cd8a823b1c4b3605c3a3cb1">find_last_snapshot</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">int</span> RestartSnapNum = <a class="code" href="checkpoint_8c.html#afa525d0629e73e8e9676075503f5bac7">find_last_snapnum</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Last Snapshot number is %d.\n&quot;</span>, RestartSnapNum);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> RestartSnapNum;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="run_8c.html#aee4609880c9e92e1c421c4bd238589fd">  194</a></span>&#160;<a class="code" href="run_8c.html#aee4609880c9e92e1c421c4bd238589fd">begrun</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> RestartSnapNum, <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * head)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="petapm_8c.html#a0a833f7a3fd985cc3cb305751ecb1dfb">petapm_module_init</a>(omp_get_max_threads());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="petaio_8c.html#a89fdd3f9913ac2a32579155754096620">petaio_init</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="walltime_8c.html#a03a816f38593bc4adf06efed9fe49697">walltime_init</a>(&amp;<a class="code" href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">Clocks</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    *head = <a class="code" href="petaio_8c.html#a302a6962b9f0b858b487fd3e6a24cf76">petaio_read_header</a>(RestartSnapNum, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">/*Set Nmesh to triple the mean grid spacing of the dark matter by default.*/</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>  &lt; 0)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a> = 3*pow(2, (<span class="keywordtype">int</span>)(log(head-&gt;<a class="code" href="structheader__data.html#afd7952ed03fc314454e077e755851558">NTotal</a>[1])/3./log(2)) );</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(head-&gt;<a class="code" href="structheader__data.html#ad4f7e1387f12a061d7cd6181213e8ed8">neutrinonk</a> &lt;= 0)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        head-&gt;<a class="code" href="structheader__data.html#ad4f7e1387f12a061d7cd6181213e8ed8">neutrinonk</a> = <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="slotsmanager_8c.html#ac101f8cc9a2090608d269ce503b7b887">slots_init</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ab19d5268dd01d7a2ac48489c0cb0df95">SlotsIncreaseFactor</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">MaxPart</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">/* Enable the slots: stars and BHs are allocated if there are some,</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">     * or if some will form*/</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span>(head-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[0] &gt; 0)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="slotsmanager_8c.html#a2528e7745039275b8e7eab8561ca9a74">slots_set_enabled</a>(0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structsph__particle__data.html">sph_particle_data</a>), <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a> || head-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[4] &gt; 0)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="slotsmanager_8c.html#a2528e7745039275b8e7eab8561ca9a74">slots_set_enabled</a>(4, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structstar__particle__data.html">star_particle_data</a>), <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a> || head-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[5] &gt; 0)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="slotsmanager_8c.html#a2528e7745039275b8e7eab8561ca9a74">slots_set_enabled</a>(5, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structbh__particle__data.html">bh_particle_data</a>), <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structUnitSystem.html">UnitSystem</a> units = <a class="code" href="unitsystem_8c.html#a8e84fa363556fc79a5cf9f70e381c6be">get_unitsystem</a>(head-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a>, head-&gt;<a class="code" href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">UnitMass_in_g</a>, head-&gt;<a class="code" href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">UnitVelocity_in_cm_per_s</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">/* convert some physical input parameters to internal units */</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="cosmology_8c.html#ad74d8dc147725a08ba7044a64d81fba0">init_cosmology</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, head-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, units);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="cosmology_8c.html#a3bd6ee61b8a336eed081224546393158">check_units</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, units);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">char</span> * pidfile = <a class="code" href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a>(<span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <span class="stringliteral">&quot;PIDs.txt&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="system_8c.html#a3b4cc1b74fe2de47b0090b2ad113a9fd">MPIU_write_pids</a>(pidfile);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(pidfile);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="forcetree_8c.html#aa58562a96bb05cdba9466ecedafece27">init_forcetree_params</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="sfr__eff_8c.html#a17ba6f2251e04bc57005d00cc09640c8">init_cooling_and_star_formation</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">CoolingOn</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, head-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>[0], head-&gt;<a class="code" href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">BoxSize</a>, units);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="gravity_8c.html#a6468e8acac791552c30b0381857e573f">gravshort_fill_ntab</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3b130ce4a4b8d01bd62166f7f145a298">ShortRangeForceWindowType</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="system_8c.html#a8b72dc2f38f4ed61f16276a9c12bbe87">set_random_numbers</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">RandomSeed</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">LightconeOn</a>)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="lightcone_8c.html#ae800971a34ef4e03eaa354cf28888c1d">lightcone_init</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, head-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, head-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="init_8c.html#aefa558832e90f57e2c3785480ebbea3e">init_timeline</a>(RestartSnapNum, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">TimeMax</a>, head, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">SnapshotWithFOF</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">/* Get the nk and do allocation. */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">MassiveNuLinRespOn</a>)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="neutrinos__lra_8c.html#a08c4fc5d722bdb43dd32a0f4fef3d0a8">init_neutrinos_lra</a>(head-&gt;<a class="code" href="structheader__data.html#ad4f7e1387f12a061d7cd6181213e8ed8">neutrinonk</a>, head-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">TimeMax</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af03043a56ad2b2b697762d127b8b906b">ONu</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ab98e5d1db0ac5adc89510264da3ab443">UnitTime_in_s</a>, <a class="code" href="physconst_8h.html#a5a80b30e136f7032873530b2a44e224b">CM_PER_MPC</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">/* ... read initial model and initialise the times*/</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> ti_init = <a class="code" href="init_8c.html#ac2e8594acf366f237632083d743efb0a">init</a>(RestartSnapNum, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, head, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span>(RestartSnapNum &lt; 0) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="structDomainDecomp.html">DomainDecomp</a> ddecomp[1] = {0};</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="domain_8c.html#a60c51b92b4bd66165bb14fab993da4f0">domain_decompose_full</a>(ddecomp); <span class="comment">/* do initial domain decomposition (gives equal numbers of particles) so density() is safe*/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">/* On first run, generate smoothing lengths and set initial entropies based on CMB temperature*/</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="init_8c.html#a713a74e1e0ca55699bc6581763bae177">setup_smoothinglengths</a>(RestartSnapNum, ddecomp, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, <a class="code" href="sfr__eff_8c.html#aa4503d203fa143d76d004c0719415562">get_MinEgySpec</a>(), units.<a class="code" href="structUnitSystem.html#a3ebe1ddf4cba3793bcf24181184ff418">UnitInternalEnergy_in_cgs</a>, ti_init, head-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, head-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[0]);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="domain_8c.html#a51697ea7b337be78d74e6d5acc9cad68">domain_free</a>(ddecomp);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">/* When we restart, validate the SPH properties of the particles.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">         * This also allows us to increase MinEgySpec on a restart if we choose.*/</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="init_8c.html#a5490a5c3a899d73926b3c5290b805c6a">check_density_entropy</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, <a class="code" href="sfr__eff_8c.html#aa4503d203fa143d76d004c0719415562">get_MinEgySpec</a>(), head-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> ti_init;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/* Small function to decide - collectively - whether to use pairwise gravity this step*/</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="run_8c.html#a2904574467d5ae303174dc9ccebc82da">  267</a></span>&#160;<a class="code" href="run_8c.html#a2904574467d5ae303174dc9ccebc82da">use_pairwise_gravity</a>(<a class="code" href="structActiveParticles.html">ActiveParticles</a> * Act, <span class="keyword">struct</span> <a class="code" href="structpart__manager__type.html">part_manager_type</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;{</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">/* Find total number of active particles*/</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    int64_t total_active, total_particle;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    MPI_Allreduce(&amp;Act-&gt;<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>, &amp;total_active, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    MPI_Allreduce(&amp;<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>, &amp;total_particle, 1, <a class="code" href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a>, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">/* Since the pairwise step is O(N^2) and tree is O(NlogN) we should scale the condition like O(N)*/</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> total_active &lt; <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ab9316029bbb13493628c2c3ad897f7c5">PairwiseActiveFraction</a> * total_particle;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="run_8c.html#a89690448ef43a8d624b963382b7503ed">  284</a></span>&#160;<a class="code" href="run_8c.html#a89690448ef43a8d624b963382b7503ed">run</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> RestartSnapNum, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> ti_init, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * header)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">/*Number of timesteps performed this run*/</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> NumCurrentTiStep = 0;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">/*Is gas physics enabled?*/</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">int</span> GasEnabled = <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#a29b1b6c4eae612eca7f1125a0c854436">enabled</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="structHCIManager.html">HCIManager</a> HCI_DEFAULT_MANAGER[1] = {0};</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="hci_8c.html#aacbd388585d5ed8cd917420f80c6508f">hci_init</a>(HCI_DEFAULT_MANAGER, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a1e13b59dd08195b44de3c83d47ec1897">TimeLimitCPU</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ad0886392c89d4ea973eb708d39108303">AutoSnapshotTime</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">SnapshotWithFOF</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structUnitSystem.html">UnitSystem</a> units = <a class="code" href="unitsystem_8c.html#a8e84fa363556fc79a5cf9f70e381c6be">get_unitsystem</a>(header-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a>, header-&gt;<a class="code" href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">UnitMass_in_g</a>, header-&gt;<a class="code" href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">UnitVelocity_in_cm_per_s</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span> SnapshotFileCount = RestartSnapNum;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> MinEgySpec = <a class="code" href="sfr__eff_8c.html#aa4503d203fa143d76d004c0719415562">get_MinEgySpec</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structPetaPM.html">PetaPM</a> pm = {0};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="gravity_8h.html#af9af33c424ac5a2f9c10b697977f657e">gravpm_init_periodic</a>(&amp;pm, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="structDomainDecomp.html">DomainDecomp</a> ddecomp[1] = {0};</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">/* Stored scale factor of the next black hole seeding check*/</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">double</span> TimeNextSeedingCheck = header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">struct </span><a class="code" href="structOutputFD.html">OutputFD</a> fds;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="stats_8c.html#ae30f4f36cdd6dacf0862d499a11d6d88">open_outputfiles</a>(RestartSnapNum, &amp;fds, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="stats_8c.html#a82cc2058393193cc90894aa756a9d8b2">write_cpu_log</a>(NumCurrentTiStep, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, fds.<a class="code" href="structOutputFD.html#ae53f8603f102e700c37467c8fd3d1595">FdCPU</a>, <a class="code" href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">Clocks</a>.<a class="code" href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ElapsedTime</a>); <span class="comment">/* produce some CPU usage info */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="structDriftKickTimes.html">DriftKickTimes</a> times = <a class="code" href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a>(ti_init);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">double</span> atime = <a class="code" href="timestep_8c.html#a359495157e1978aa5922615da9432a4d">get_atime</a>(times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">while</span>(1) <span class="comment">/* main loop */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">/* Find next synchronization point and the timebins active during this timestep.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">         * Note that on startup, P[i].TimeBin == 0 for all particles,</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">         * all bins except the zeroth are inactive and so we return 0 from this function.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">         * This ensures we run the force calculation for the first timestep.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Next = <a class="code" href="timestep_8c.html#aa7119c29751fcd9275f395e6ea08965f">find_next_kick</a>(times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>, times.<a class="code" href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">mintimebin</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Last = times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a> = Ti_Next;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">/*Convert back to floating point time*/</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordtype">double</span> newatime = <a class="code" href="timestep_8c.html#a359495157e1978aa5922615da9432a4d">get_atime</a>(times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span>(newatime &lt; atime)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;Negative timestep: %g New Time: %g Old time %g!\n&quot;</span>, newatime - atime, newatime, atime);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        atime = newatime;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">/* Compute the list of particles that cross a lightcone and write it to disc.*/</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">LightconeOn</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="lightcone_8c.html#a8c81fa9921177eede8a1c25c0365fd6b">lightcone_compute</a>(atime, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, Ti_Last, Ti_Next);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordtype">int</span> is_PM = <a class="code" href="timestep_8c.html#a1da56439eb88b453b1ae0122f15d8dc1">is_PM_timestep</a>(&amp;times);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="structSyncPoint.html">SyncPoint</a> * next_sync; <span class="comment">/* if we are out of planned sync points, terminate */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="structSyncPoint.html">SyncPoint</a> * planned_sync; <span class="comment">/* NULL; if the step is not a planned sync point. */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        next_sync = <a class="code" href="timebinmgr_8c.html#a4a7f3606a4cb958089f232db3fc51dd2">find_next_sync_point</a>(times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        planned_sync = <a class="code" href="timebinmgr_8c.html#aa1c832d9a92b9e906dbae0c9a7be298c">find_current_sync_point</a>(times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="structHCIAction.html">HCIAction</a> action[1];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="hci_8c.html#adf575054e41280d79cdcad95d436b33d">hci_action_init</a>(action); <span class="comment">/* init to no action */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordtype">int</span> stop = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">/* query HCI requests only on PM step; where kick and drifts are synced */</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            stop = <a class="code" href="hci_8c.html#ab140bce619153b809e0fea49a2e1d081">hci_query</a>(HCI_DEFAULT_MANAGER, action);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">if</span>(action-&gt;<a class="code" href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">type</a> == <a class="code" href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28">HCI_TERMINATE</a>) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Human triggered termination.\n&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordtype">double</span> rel_random_shift[3] = {0};</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span>(NumCurrentTiStep &gt; 0 &amp;&amp; is_PM  &amp;&amp; <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">RandomParticleOffset</a> &gt; 0) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <a class="code" href="partmanager_8c.html#ad1574c3cad1cf90a7b1eb1f7a3b1486a">update_random_offset</a>(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, rel_random_shift, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">RandomParticleOffset</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordtype">int</span> extradomain = <a class="code" href="timestep_8c.html#a896d6e80e5dd9d14008709479a0f8a66">is_timebin_active</a>(times.<a class="code" href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">mintimebin</a> + <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afaa0f8c8fbf3117e10ecfcfcbf4085b9">MaxDomainTimeBinDepth</a>, times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">/* drift and ddecomp decomposition */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">/* at first step this is a noop */</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span>(extradomain || is_PM) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="comment">/* Sync positions of all particles */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="drift_8c.html#a5dc18d2303c140777f7f219b21d0f00b">drift_all_particles</a>(Ti_Last, times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, rel_random_shift);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="comment">/* full decomposition rebuilds the domain, needs keys.*/</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="domain_8c.html#a60c51b92b4bd66165bb14fab993da4f0">domain_decompose_full</a>(ddecomp);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">/* FIXME: add a parameter for ddecomp_decompose_incremental */</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="comment">/* currently we drift all particles every step */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">/* If it is not a PM step, do a shorter version</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">             * of the ddecomp decomp which just exchanges particles.*/</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keyword">struct </span><a class="code" href="structDriftData.html">DriftData</a> drift;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            drift.<a class="code" href="structDriftData.html#a505a8878f34f4d9773a75b0307d1afc8">CP</a> = &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            drift.<a class="code" href="structDriftData.html#a491144ae99df44e97e83827a75060c84">ti0</a> = Ti_Last;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            drift.<a class="code" href="structDriftData.html#a8c5d44c35b74f9bec127072192ccc83e">ti1</a> = times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="domain_8c.html#ab9d61207bd4c34d7cae1fd42a2c3a4c0">domain_maintain</a>(ddecomp, &amp;drift);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="timestep_8c.html#ace9e5cdcc776609e46189b2268155ca7">update_lastactive_drift</a>(&amp;times);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="structActiveParticles.html">ActiveParticles</a> Act = {0};</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="timestep_8c.html#a8102740bf0615adc840060e1101d6d3e">rebuild_activelist</a>(&amp;Act, &amp;times, NumCurrentTiStep, atime);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="system_8c.html#a8b72dc2f38f4ed61f16276a9c12bbe87">set_random_numbers</a>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">RandomSeed</a> + times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">/* Are the particle neutrinos gravitating this timestep?</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">         * If so we need to add them to the tree.*/</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordtype">int</span> HybridNuTracer = <a class="code" href="cosmology_8c.html#aa31001806d9df0add7801b015acab587">hybrid_nu_tracer</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, atime);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">/* Collective: total number of active particles must be small enough*/</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordtype">int</span> pairwisestep = <a class="code" href="run_8c.html#a2904574467d5ae303174dc9ccebc82da">use_pairwise_gravity</a>(&amp;Act, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * GradRho = NULL;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="sfr__eff_8c.html#aefebad1cdf9c3fe278031e2b78d69859">sfr_need_to_compute_sph_grad_rho</a>())</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            GradRho = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;SPH_GradRho&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * 3 * <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">/* Need to rebuild the force tree because all TopLeaves are out of date.*/</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="structForceTree.html">ForceTree</a> Tree = {0};</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a>(&amp;Tree, ddecomp, HybridNuTracer, !pairwisestep &amp;&amp; <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">TreeGravOn</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">/* density() happens before gravity because it also initializes the predicted variables.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">        * This ensures that prediction consistently uses the grav and hydro accel from the</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">        * timestep before this one, which matches Gadget-2/3. It was tested to make a small difference,</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">        * since prediction is only really used for artificial viscosity.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">        *</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">        * Doing it first also means the density is up to date for</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">        * adaptive gravitational softenings. */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span>(GasEnabled)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">/*Allocate the memory for predicted SPH data.*/</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> sph_predicted = <a class="code" href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a>(<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a44c95cdbb3636975f9e0fb0d6f47b949">DensityOn</a>)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>(&amp;Act, 1, <a class="code" href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a>(), <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, MinEgySpec, times, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;sph_predicted, GradRho, &amp;Tree);  <span class="comment">/* computes density, and pressure */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">            /***** update smoothing lengths in tree *****/</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <a class="code" href="forcetree_8c.html#a965954b38afd36a3ce1047406d23cc22">force_update_hmax</a>(Act.<a class="code" href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticle</a>, Act.<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a>, &amp;Tree, ddecomp);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">            /***** hydro forces *****/</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(MPI_COMM_WORLD);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="comment">/* adds hydrodynamical accelerations  and computes du/dt  */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a5b739219a9e9cb1042bb7ab2e28bce98">HydroOn</a>)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <a class="code" href="hydra_8c.html#aab8e916e02126d7f36d2065cc5678dec">hydro_force</a>(&amp;Act, atime, &amp;sph_predicted, MinEgySpec, times, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;Tree);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">/* Scratch data cannot be used checkpoint because FOF does an exchange.*/</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <a class="code" href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a>(&amp;sph_predicted);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">/* The opening criterion for the gravtree</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">        * uses the *total* gravitational acceleration</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">        * from the last timestep, GravPM+GravAccel.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">        * So we must compute GravAccel for this timestep</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">        * before gravpm_force() writes the PM acc. for</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">        * this timestep to GravPM. Note initially both</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">        * are zero and so the tree is opened maximally</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">        * on the first timestep.*/</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> rho0 = <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Omega0</a> * 3 * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> / (8 * M_PI * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">TreeGravOn</a>) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="comment">/* Do a short range pairwise only step if desired*/</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span>(pairwisestep) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="keyword">struct </span><a class="code" href="structgravshort__tree__params.html">gravshort_tree_params</a> gtp = <a class="code" href="gravity_8h.html#a28832a959ccb4e3dfb9899826df012fa">get_gravshort_treepar</a>();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <a class="code" href="gravity_8h.html#a6e195525506b0c8f2638fda43cb8fa1f">grav_short_pair</a>(&amp;Act, &amp;pm, &amp;Tree, gtp.<a class="code" href="structgravshort__tree__params.html#a2de5c53741627e04b9a7c45a58ff9df9">Rcut</a>, rho0, HybridNuTracer, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <a class="code" href="gravity_8h.html#af372a315ec289670ceaf43db26a36b43">grav_short_tree</a>(&amp;Act, &amp;pm, &amp;Tree, rho0, HybridNuTracer, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">/* We use the total gravitational acc.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">        * to open the tree and total acc for the timestep.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">        * Note that any of (GravAccel, GravPM,</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">        * HydroAccel) may change much faster than</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">        * the total acc.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">        * We do the same as Gadget-2, but one could</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">        * instead use short-range tree acc. only</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">        * for opening angle or short-range timesteps,</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">        * or include hydro in the opening angle.*/</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span>(is_PM)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <a class="code" href="gravity_8h.html#ad95fd36f6f2e0ca8664796f845d5326c">gravpm_force</a>(&amp;pm, &amp;Tree, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, atime, units.<a class="code" href="structUnitSystem.html#ac9bf5677cfdf7a47b50d40a7e975941b">UnitLength_in_cm</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, header-&gt;<a class="code" href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">TimeIC</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">/* compute and output energy statistics if desired. */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">if</span>(fds.<a class="code" href="structOutputFD.html#a77f5a9cff4366e1a94acbf1f424bd64e">FdEnergy</a>)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="stats_8c.html#aaaf6ae611911a7f7217602b29171c1cd">energy_statistics</a>(fds.<a class="code" href="structOutputFD.html#a77f5a9cff4366e1a94acbf1f424bd64e">FdEnergy</a>, atime, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a>(MPI_COMM_WORLD);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Forces computed.\n&quot;</span>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">/* Update velocity to Ti_Current; this synchronizes TiKick and TiDrift for the active particles</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">         * and sets Ti_Kick in the times structure.*/</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <a class="code" href="timestep_8c.html#a02c7db8f2f113f9e606ec6a500074f8c">apply_PM_half_kick</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;times);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">/* Need a scale factor for entropy and velocity limiters*/</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="timestep_8c.html#a8cd9d7c91611cbf3493edfa7d5491be9">apply_half_kick</a>(&amp;Act, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;times, atime, MinEgySpec);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">/* Cooling and extra physics show up as a source term in the evolution equations.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">         * Formally you can write the structure of the partial differential equations:</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">           dU/dt +  div(F) = S</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">         * where the cooling, BH and SFR are the source term S.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">         * The extra physics is done after the kick, using a Strang split operator.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">         * Gadget3/Arepo tries to follow the general operator splitting ansatz (often called Strang splitting).</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">         * Here you alternate the evolution under the operator generating the time evolution of the homogenous system (ie, without S)</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">         * with the operator generating the time evolution under the source function alone.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">         * This means to advance the full system by dt, you first evolve dU/dt = S</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">         * by dt, and then dU/dt +  div(F) = 0 by dt.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">         * [Actually, for second-order convergence in time, you should rather evolve S for dt/2, then the homogenous part for dt, and then S again for dt/2.]</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">         * The operator-split approach offers a number of practical advantages when the source function is stiff.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">         * You can, for example, solve dU/dt = S in a robust and stable fashion with an implict solver, whereas the Gadget2 approach is severely challenged</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">         * and either requires an artficial clipping of the maximum allowed cooling rate, or a severe reduction of the timestep, otherwise the</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">         * predicted entropy due to cooling someting during the timestep can become severely wrong. Also, the source term approach can be easily</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">         * used to treat effectively instantaneous injections of energy (like from BHs), which is again hard to properly incorporate in the</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">         * time-integration approach where you want to have a &quot;full&quot; dU/dt all times. (Volker Springel 2020).</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">if</span>(GasEnabled)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="comment">/* Do this before sfr and bh so the gas hsml always contains DesNumNgb neighbours.*/</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a>) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="keywordtype">double</span> AvgGasMass = <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#ac818659114fd72f09039b088e43e8624">OmegaBaryon</a> * 3 * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Hubble</a> / (8 * M_PI * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>) * pow(<a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, 3) / header-&gt;<a class="code" href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">NTotalInit</a>[0];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <a class="code" href="metal__return_8c.html#a7c817252ab7c0f679fea71bde6dea852">metal_return</a>(&amp;Act, ddecomp, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, atime, AvgGasMass);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="comment">/* this will find new black hole seed halos.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">             * Note: the FOF code does not know about garbage particles,</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">             * so ensure we do not have garbage present when we call this.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">             * Also a good idea to only run it on a PM step.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">             * This does not break the tree because the new black holes do not move or change mass, just type.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">             * It does not matter that the velocities are half a step off because they are not used in the FoF code.*/</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (is_PM &amp;&amp; ((<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a> &amp;&amp; atime &gt;= TimeNextSeedingCheck) ||</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                (<a class="code" href="cooling__qso__lightup_8c.html#aa0169ec1bb01295a97a9468d22420b39">during_helium_reionization</a>(1/atime - 1) &amp;&amp; <a class="code" href="cooling__qso__lightup_8c.html#a4cde900ae1d3de8cacd08a43caf30dc8">need_change_helium_ionization_fraction</a>(atime)))) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="comment">/* Seeding: builds its own tree.*/</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <a class="code" href="structFOFGroups.html">FOFGroups</a> fof = <a class="code" href="fof_8c.html#aef0df27f65ad2e5a95f66ae4e970da23">fof_fof</a>(ddecomp, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a> &amp;&amp; atime &gt;= TimeNextSeedingCheck) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    <a class="code" href="fof_8c.html#ac636ce7b1a72cfabfee3a11fadc0aeb5">fof_seed</a>(&amp;fof, &amp;Act, atime, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    TimeNextSeedingCheck = atime * <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a746498a1812101686266ebbbb6092084">TimeBetweenSeedingSearch</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="cooling__qso__lightup_8c.html#aa0169ec1bb01295a97a9468d22420b39">during_helium_reionization</a>(1/atime - 1)) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    <span class="comment">/* Helium reionization by switching on quasar bubbles*/</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <a class="code" href="cooling__qso__lightup_8c.html#a42cfb86673e895125f77c946b7db8ced">do_heiii_reionization</a>(atime, &amp;fof, ddecomp, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, units.<a class="code" href="structUnitSystem.html#a3ebe1ddf4cba3793bcf24181184ff418">UnitInternalEnergy_in_cgs</a>, fds.<a class="code" href="structOutputFD.html#a4f82c5e9afe142b5eda1bf51bdf43b36">FdHelium</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <a class="code" href="fof_8c.html#ab9ae2d0c5765a217f7bb5a1a7fe261d4">fof_finish</a>(&amp;fof);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">if</span>(is_PM) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="comment">/*Rebuild the force tree we freed in gravpm to save memory. Means might be two trees during FOF.*/</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <a class="code" href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a>(&amp;Tree, ddecomp, HybridNuTracer, 0, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="comment">/* Black hole accretion and feedback */</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <a class="code" href="blackhole_8c.html#a19ebdf3d7cd6405d5936aabf3a3f230b">blackhole</a>(&amp;Act, atime, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;Tree, units, fds.<a class="code" href="structOutputFD.html#a0060c1e25e1d1e47f2188eddd6d93a39">FdBlackHoles</a>, fds.<a class="code" href="structOutputFD.html#a1813f7e1b110c626db21805b508f7953">FdBlackholeDetails</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">            /**** radiative cooling and star formation *****/</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#ae8339c67fd53fd55a040096664460677">CoolingOn</a>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <a class="code" href="sfr__eff_8c.html#abc5b151d356619b98a8ded72cc9426c7">cooling_and_starformation</a>(&amp;Act, atime, <a class="code" href="timebinmgr_8c.html#a716e51b694540af2851fb51c081bcf5d">get_dloga_for_bin</a>(times.<a class="code" href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">mintimebin</a>, times.<a class="code" href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">Ti_Current</a>), &amp;Tree, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, GradRho, fds.<a class="code" href="structOutputFD.html#a7e48b9018143ed051104f68a04628c79">FdSfr</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">/* We don&#39;t need this timestep&#39;s tree anymore.*/</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;Tree);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">if</span>(GradRho) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(GradRho);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            GradRho = NULL;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="comment">/* If a snapshot is requested, write it.         *</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">         * We only attempt to output on sync points. This is the only chance where all variables are</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">         * synchronized in a consistent state in a K(KDDK)^mK scheme.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordtype">int</span> WriteSnapshot = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordtype">int</span> WriteFOF = 0;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">if</span>(planned_sync) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            WriteSnapshot |= planned_sync-&gt;<a class="code" href="structSyncPoint.html#af86f979490f9dd8cf7e9488f2c68503c">write_snapshot</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            WriteFOF |= planned_sync-&gt;<a class="code" href="structSyncPoint.html#a4423ca022f08153c9ae086784e97565b">write_fof</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span>(is_PM) { <span class="comment">/* the if here is unnecessary but to signify checkpointing occurs only at PM steps. */</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            WriteSnapshot |= action-&gt;<a class="code" href="structHCIAction.html#a60b86f3851076753015f6025945edf91">write_snapshot</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            WriteFOF |= action-&gt;<a class="code" href="structHCIAction.html#abb818915ca3d7aafac9c53731fef4475">write_fof</a>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span>(WriteSnapshot || WriteFOF) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="comment">/* Get a new snapshot*/</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            SnapshotFileCount++;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="comment">/* The accel may have created garbage -- collect them before writing a snapshot.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">             * If we do collect, reset active list size.*/</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordtype">int</span> compact[6] = {0};</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="slotsmanager_8c.html#a82d3ca06acff364846599d31e2c8f83b">slots_gc</a>(compact, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>, <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>))</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                Act.<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="structFOFGroups.html">FOFGroups</a> fof = {0};</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span>(WriteFOF) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="comment">/* Compute FOF and assign GrNr so it can be written in checkpoint.*/</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            fof = <a class="code" href="fof_8c.html#aef0df27f65ad2e5a95f66ae4e970da23">fof_fof</a>(ddecomp, 1, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">/* WriteFOF just reminds the checkpoint code to save GroupID*/</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span>(WriteSnapshot)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="checkpoint_8c.html#a233c8fd1567fc34773a92294a6d8de7b">write_checkpoint</a>(SnapshotFileCount, WriteFOF, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a>, atime, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a1634ca118e6f917177ec1db22310f6d0">OutputDebugFields</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">/* Save FOF tables after checkpoint so that if there is a FOF save bug we have particle tables available to debug it*/</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span>(WriteFOF) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <a class="code" href="fof_8c.html#a38d0e2572ef5e373fe12edd44a94ce92">fof_save_groups</a>(&amp;fof, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">FOFFileBase</a>, SnapshotFileCount, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, atime, header-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="fof_8c.html#ab9ae2d0c5765a217f7bb5a1a7fe261d4">fof_finish</a>(&amp;fof);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <a class="code" href="stats_8c.html#a82cc2058393193cc90894aa756a9d8b2">write_cpu_log</a>(NumCurrentTiStep, atime, fds.<a class="code" href="structOutputFD.html#ae53f8603f102e700c37467c8fd3d1595">FdCPU</a>, <a class="code" href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">Clocks</a>.<a class="code" href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ElapsedTime</a>);    <span class="comment">/* produce some CPU usage info */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="mymalloc_8h.html#afaf046f010cd01115a573a59e1e73e01">report_memory_usage</a>(<span class="stringliteral">&quot;RUN&quot;</span>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span>(!next_sync || stop) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="comment">/* out of sync points, or a requested stop, the run has finally finished! Yay.*/</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">if</span>(action-&gt;<a class="code" href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">type</a> == <a class="code" href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1ad0062d755a44738b16a821b96f493d54">HCI_TIMEOUT</a>)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Stopping: not enough time for another PM step before TimeLimitCPU is reached.\n&quot;</span>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">/* more steps to go. */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">/* assign new timesteps to the active particles,</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">         * now that we know they have synched TiKick and TiDrift,</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">         * and advance the PM timestep.*/</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> asmth = <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a> * <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a> / <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordtype">int</span> badtimestep = <a class="code" href="timestep_8c.html#a7f8bb9951920bdc3a2138d91f1cfc61c">find_timesteps</a>(&amp;Act, &amp;times, atime, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, asmth, NumCurrentTiStep == 0);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span>(badtimestep) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;bad timestep spotted: terminating and saving snapshot.\n&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="checkpoint_8c.html#a9b7b2e06591ff6f1fb5735a65f1efd78">dump_snapshot</a>(<span class="stringliteral">&quot;TIMESTEP-DUMP&quot;</span>, atime, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Ending due to bad timestep&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">/* Update velocity and ti_kick to the new step, with the newly computed step size */</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="timestep_8c.html#a8cd9d7c91611cbf3493edfa7d5491be9">apply_half_kick</a>(&amp;Act, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;times, atime, MinEgySpec);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <a class="code" href="timestep_8c.html#a02c7db8f2f113f9e606ec6a500074f8c">apply_PM_half_kick</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;times);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">/* We can now free the active list: the new step have new active particles*/</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="timestep_8c.html#aec3f9fb84aa5cda053a144da6588ffcd">free_activelist</a>(&amp;Act);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        NumCurrentTiStep++;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="stats_8c.html#a997347b9c3f08a2f1258a8b7ee5b4e08">close_outputfiles</a>(&amp;fds);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">/* Run various checks on the gravity code. Check that the short-range/long-range force split is working.*/</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="run_8c.html#ab1d8bf99f794003fa95002043fe3b47c">  646</a></span>&#160;<a class="code" href="run_8c.html#ab1d8bf99f794003fa95002043fe3b47c">runtests</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> RestartSnapNum, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Current, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * header)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;{</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="run_8h.html#aa438e424237818b7728b98cd764e45d1">run_gravity_test</a>(RestartSnapNum, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>, Ti_Current, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, header);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="run_8c.html#a02ef4c629cc0fea15dce527f09ea672f">  652</a></span>&#160;<a class="code" href="run_8c.html#a02ef4c629cc0fea15dce527f09ea672f">runfof</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> RestartSnapNum, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a> Ti_Current, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * header)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;{</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="structPetaPM.html">PetaPM</a> pm = {0};</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="gravity_8h.html#af9af33c424ac5a2f9c10b697977f657e">gravpm_init_periodic</a>(&amp;pm, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="structDomainDecomp.html">DomainDecomp</a> ddecomp[1] = {0};</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/* ... read in initial model */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="domain_8c.html#a60c51b92b4bd66165bb14fab993da4f0">domain_decompose_full</a>(ddecomp); <span class="comment">/* do initial domain decomposition (gives equal numbers of particles) */</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="structDriftKickTimes.html">DriftKickTimes</a> times = <a class="code" href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a>(Ti_Current);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">/*FoF needs a tree*/</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">int</span> HybridNuGrav = <a class="code" href="cosmology_8c.html#aa31001806d9df0add7801b015acab587">hybrid_nu_tracer</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">/* Regenerate the star formation rate for the FOF table.*/</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">StarformationOn</a>) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="structActiveParticles.html">ActiveParticles</a> Act = {0};</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        Act.<a class="code" href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">NumActiveParticle</a> = <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">NumPart</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> * GradRho = NULL;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="sfr__eff_8c.html#aefebad1cdf9c3fe278031e2b78d69859">sfr_need_to_compute_sph_grad_rho</a>()) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="structForceTree.html">ForceTree</a> gasTree = {0};</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            GradRho = (<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a> *) <a class="code" href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a>(<span class="stringliteral">&quot;SPH_GradRho&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a>) * 3 * <a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="comment">/*Allocate the memory for predicted SPH data.*/</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keyword">struct </span><a class="code" href="structsph__pred__data.html">sph_pred_data</a> sph_predicted = <a class="code" href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a>(<a class="code" href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a>-&gt;<a class="code" href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">info</a>[0].<a class="code" href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">size</a>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <a class="code" href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a>(&amp;gasTree, ddecomp, HybridNuGrav, 0, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">/* computes GradRho with a treewalk. No hsml update as we are reading from a snapshot.*/</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <a class="code" href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a>(&amp;Act, 0, 0, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, <a class="code" href="sfr__eff_8c.html#aa4503d203fa143d76d004c0719415562">get_MinEgySpec</a>(), times, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, &amp;sph_predicted, GradRho, &amp;gasTree);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;gasTree);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <a class="code" href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a>(&amp;sph_predicted);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="structForceTree.html">ForceTree</a> Tree = {0};</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="sfr__eff_8c.html#abc5b151d356619b98a8ded72cc9426c7">cooling_and_starformation</a>(&amp;Act, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, 0, &amp;Tree, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, GradRho, NULL);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span>(GradRho)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <a class="code" href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a>(GradRho);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="structFOFGroups.html">FOFGroups</a> fof = <a class="code" href="fof_8c.html#aef0df27f65ad2e5a95f66ae4e970da23">fof_fof</a>(ddecomp, 1, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="fof_8c.html#a38d0e2572ef5e373fe12edd44a94ce92">fof_save_groups</a>(&amp;fof, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">FOFFileBase</a>, RestartSnapNum, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, header-&gt;<a class="code" href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">MassTable</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a97fe2321295536715f83b483210d6edb">MetalReturnOn</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">BlackHoleOn</a>, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="fof_8c.html#ab9ae2d0c5765a217f7bb5a1a7fe261d4">fof_finish</a>(&amp;fof);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="run_8c.html#afc20ced36c74991ca5c2004510c6c628">  691</a></span>&#160;<a class="code" href="run_8c.html#afc20ced36c74991ca5c2004510c6c628">runpower</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structheader__data.html">header_data</a> * header)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;{</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="structPetaPM.html">PetaPM</a> pm = {0};</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="gravity_8h.html#af9af33c424ac5a2f9c10b697977f657e">gravpm_init_periodic</a>(&amp;pm, <a class="code" href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a>-&gt;<a class="code" href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">BoxSize</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">Asmth</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">Nmesh</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>.<a class="code" href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">GravInternal</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="structDomainDecomp.html">DomainDecomp</a> ddecomp[1] = {0};</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">/* ... read in initial model */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="domain_8c.html#a60c51b92b4bd66165bb14fab993da4f0">domain_decompose_full</a>(ddecomp); <span class="comment">/* do initial domain decomposition (gives equal numbers of particles) */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">/*PM needs a tree*/</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="structForceTree.html">ForceTree</a> Tree = {0};</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">int</span> HybridNuGrav = <a class="code" href="cosmology_8c.html#aa31001806d9df0add7801b015acab587">hybrid_nu_tracer</a>(&amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a>(&amp;Tree, ddecomp, HybridNuGrav, 1, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="gravity_8h.html#ad95fd36f6f2e0ca8664796f845d5326c">gravpm_force</a>(&amp;pm, &amp;Tree, &amp;<a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">CP</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, header-&gt;<a class="code" href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">UnitLength_in_cm</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">OutputDir</a>, header-&gt;<a class="code" href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">TimeSnapshot</a>, <a class="code" href="run_8c.html#ac375cbba056f17379640791c81947612">All</a>.<a class="code" href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">FastParticleType</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a>(&amp;Tree);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="ttc" id="ablackhole_8c_html_a19ebdf3d7cd6405d5936aabf3a3f230b"><div class="ttname"><a href="blackhole_8c.html#a19ebdf3d7cd6405d5936aabf3a3f230b">blackhole</a></div><div class="ttdeci">void blackhole(const ActiveParticles *act, double atime, Cosmology *CP, ForceTree *tree, const struct UnitSystem units, FILE *FdBlackHoles, FILE *FdBlackholeDetails)</div><div class="ttdef"><b>Definition:</b> <a href="blackhole_8c_source.html#l00516">blackhole.c:516</a></div></div>
<div class="ttc" id="ablackhole_8h_html"><div class="ttname"><a href="blackhole_8h.html">blackhole.h</a></div></div>
<div class="ttc" id="acheckpoint_8c_html_a233c8fd1567fc34773a92294a6d8de7b"><div class="ttname"><a href="checkpoint_8c.html#a233c8fd1567fc34773a92294a6d8de7b">write_checkpoint</a></div><div class="ttdeci">void write_checkpoint(int snapnum, int WriteGroupID, int MetalReturnOn, double Time, const Cosmology *CP, const char *OutputDir, const int OutputDebugFields)</div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8c_source.html#l00024">checkpoint.c:24</a></div></div>
<div class="ttc" id="acheckpoint_8c_html_a9b7b2e06591ff6f1fb5735a65f1efd78"><div class="ttname"><a href="checkpoint_8c.html#a9b7b2e06591ff6f1fb5735a65f1efd78">dump_snapshot</a></div><div class="ttdeci">void dump_snapshot(const char *dump, const double Time, const Cosmology *CP, const char *OutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8c_source.html#l00052">checkpoint.c:52</a></div></div>
<div class="ttc" id="acheckpoint_8c_html_afa525d0629e73e8e9676075503f5bac7"><div class="ttname"><a href="checkpoint_8c.html#afa525d0629e73e8e9676075503f5bac7">find_last_snapnum</a></div><div class="ttdeci">int find_last_snapnum(const char *OutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="checkpoint_8c_source.html#l00063">checkpoint.c:63</a></div></div>
<div class="ttc" id="acheckpoint_8h_html"><div class="ttname"><a href="checkpoint_8h.html">checkpoint.h</a></div></div>
<div class="ttc" id="acooling_8h_html"><div class="ttname"><a href="cooling_8h.html">cooling.h</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a42cfb86673e895125f77c946b7db8ced"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a42cfb86673e895125f77c946b7db8ced">do_heiii_reionization</a></div><div class="ttdeci">void do_heiii_reionization(double atime, FOFGroups *fof, DomainDecomp *ddecomp, Cosmology *CP, double uu_in_cgs, FILE *FdHelium)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00640">cooling_qso_lightup.c:640</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_a4cde900ae1d3de8cacd08a43caf30dc8"><div class="ttname"><a href="cooling__qso__lightup_8c.html#a4cde900ae1d3de8cacd08a43caf30dc8">need_change_helium_ionization_fraction</a></div><div class="ttdeci">int need_change_helium_ionization_fraction(double atime)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00657">cooling_qso_lightup.c:657</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8c_html_aa0169ec1bb01295a97a9468d22420b39"><div class="ttname"><a href="cooling__qso__lightup_8c.html#aa0169ec1bb01295a97a9468d22420b39">during_helium_reionization</a></div><div class="ttdeci">int during_helium_reionization(double redshift)</div><div class="ttdef"><b>Definition:</b> <a href="cooling__qso__lightup_8c_source.html#l00667">cooling_qso_lightup.c:667</a></div></div>
<div class="ttc" id="acooling__qso__lightup_8h_html"><div class="ttname"><a href="cooling__qso__lightup_8h.html">cooling_qso_lightup.h</a></div></div>
<div class="ttc" id="acosmology_8c_html_a3bd6ee61b8a336eed081224546393158"><div class="ttname"><a href="cosmology_8c.html#a3bd6ee61b8a336eed081224546393158">check_units</a></div><div class="ttdeci">void check_units(const Cosmology *CP, const struct UnitSystem units)</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8c_source.html#l00260">cosmology.c:260</a></div></div>
<div class="ttc" id="acosmology_8c_html_aa31001806d9df0add7801b015acab587"><div class="ttname"><a href="cosmology_8c.html#aa31001806d9df0add7801b015acab587">hybrid_nu_tracer</a></div><div class="ttdeci">int hybrid_nu_tracer(const Cosmology *CP, double atime)</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8c_source.html#l00053">cosmology.c:53</a></div></div>
<div class="ttc" id="acosmology_8c_html_ad74d8dc147725a08ba7044a64d81fba0"><div class="ttname"><a href="cosmology_8c.html#ad74d8dc147725a08ba7044a64d81fba0">init_cosmology</a></div><div class="ttdeci">void init_cosmology(Cosmology *CP, const double TimeBegin, const struct UnitSystem units)</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8c_source.html#l00015">cosmology.c:15</a></div></div>
<div class="ttc" id="adensity_8c_html_a6af534268ae11ed2bad17f5300af23bc"><div class="ttname"><a href="density_8c.html#a6af534268ae11ed2bad17f5300af23bc">slots_allocate_sph_pred_data</a></div><div class="ttdeci">struct sph_pred_data slots_allocate_sph_pred_data(int nsph)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00554">density.c:654</a></div></div>
<div class="ttc" id="adensity_8c_html_ab4c7ec2e7345138dfdd37b64f3f4554a"><div class="ttname"><a href="density_8c.html#ab4c7ec2e7345138dfdd37b64f3f4554a">slots_free_sph_pred_data</a></div><div class="ttdeci">void slots_free_sph_pred_data(struct sph_pred_data *sph_scratch)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00665">density.c:665</a></div></div>
<div class="ttc" id="adensity_8c_html_ac49d34dfc3f4e37cac0953d5bc1417a4"><div class="ttname"><a href="density_8c.html#ac49d34dfc3f4e37cac0953d5bc1417a4">density</a></div><div class="ttdeci">void density(const ActiveParticles *act, int update_hsml, int DoEgyDensity, int BlackHoleOn, double MinEgySpec, const DriftKickTimes times, Cosmology *CP, struct sph_pred_data *SPH_predicted, MyFloat *GradRho, const ForceTree *const tree)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00203">density.c:203</a></div></div>
<div class="ttc" id="adensity_8h_html"><div class="ttname"><a href="density_8h.html">density.h</a></div></div>
<div class="ttc" id="adomain_8c_html_a51697ea7b337be78d74e6d5acc9cad68"><div class="ttname"><a href="domain_8c.html#a51697ea7b337be78d74e6d5acc9cad68">domain_free</a></div><div class="ttdeci">void domain_free(DomainDecomp *ddecomp)</div><div class="ttdef"><b>Definition:</b> <a href="domain_8c_source.html#l00320">domain.c:320</a></div></div>
<div class="ttc" id="adomain_8c_html_a60c51b92b4bd66165bb14fab993da4f0"><div class="ttname"><a href="domain_8c.html#a60c51b92b4bd66165bb14fab993da4f0">domain_decompose_full</a></div><div class="ttdeci">void domain_decompose_full(DomainDecomp *ddecomp)</div><div class="ttdef"><b>Definition:</b> <a href="domain_8c_source.html#l00155">domain.c:155</a></div></div>
<div class="ttc" id="adomain_8c_html_ab9d61207bd4c34d7cae1fd42a2c3a4c0"><div class="ttname"><a href="domain_8c.html#ab9d61207bd4c34d7cae1fd42a2c3a4c0">domain_maintain</a></div><div class="ttdeci">void domain_maintain(DomainDecomp *ddecomp, struct DriftData *drift)</div><div class="ttdef"><b>Definition:</b> <a href="domain_8c_source.html#l00234">domain.c:234</a></div></div>
<div class="ttc" id="adomain_8h_html"><div class="ttname"><a href="domain_8h.html">domain.h</a></div></div>
<div class="ttc" id="adrift_8c_html_a5dc18d2303c140777f7f219b21d0f00b"><div class="ttname"><a href="drift_8c.html#a5dc18d2303c140777f7f219b21d0f00b">drift_all_particles</a></div><div class="ttdeci">void drift_all_particles(inttime_t ti0, inttime_t ti1, Cosmology *CP, const double random_shift[3])</div><div class="ttdef"><b>Definition:</b> <a href="drift_8c_source.html#l00091">drift.c:91</a></div></div>
<div class="ttc" id="adrift_8h_html"><div class="ttname"><a href="drift_8h.html">drift.h</a></div></div>
<div class="ttc" id="aendrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00175">endrun.c:175</a></div></div>
<div class="ttc" id="aendrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00147">endrun.c:147</a></div></div>
<div class="ttc" id="afof_8c_html_a38d0e2572ef5e373fe12edd44a94ce92"><div class="ttname"><a href="fof_8c.html#a38d0e2572ef5e373fe12edd44a94ce92">fof_save_groups</a></div><div class="ttdeci">void fof_save_groups(FOFGroups *fof, const char *OutputDir, const char *FOFFileBase, int num, Cosmology *CP, double atime, const double *MassTable, int MetalReturnOn, int BlackholeOn, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01113">fof.c:1113</a></div></div>
<div class="ttc" id="afof_8c_html_ab9ae2d0c5765a217f7bb5a1a7fe261d4"><div class="ttname"><a href="fof_8c.html#ab9ae2d0c5765a217f7bb5a1a7fe261d4">fof_finish</a></div><div class="ttdeci">void fof_finish(FOFGroups *fof)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00257">fof.c:257</a></div></div>
<div class="ttc" id="afof_8c_html_ac636ce7b1a72cfabfee3a11fadc0aeb5"><div class="ttname"><a href="fof_8c.html#ac636ce7b1a72cfabfee3a11fadc0aeb5">fof_seed</a></div><div class="ttdeci">void fof_seed(FOFGroups *fof, ActiveParticles *act, double atime, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l01290">fof.c:1290</a></div></div>
<div class="ttc" id="afof_8c_html_aef0df27f65ad2e5a95f66ae4e970da23"><div class="ttname"><a href="fof_8c.html#aef0df27f65ad2e5a95f66ae4e970da23">fof_fof</a></div><div class="ttdeci">FOFGroups fof_fof(DomainDecomp *ddecomp, const int StoreGrNr, MPI_Comm Comm)</div><div class="ttdef"><b>Definition:</b> <a href="fof_8c_source.html#l00151">fof.c:151</a></div></div>
<div class="ttc" id="afof_8h_html"><div class="ttname"><a href="fof_8h.html">fof.h</a></div></div>
<div class="ttc" id="aforcetree_8c_html_a5156dae3aae56140d6e9ae0ab58867cc"><div class="ttname"><a href="forcetree_8c.html#a5156dae3aae56140d6e9ae0ab58867cc">force_tree_rebuild</a></div><div class="ttdeci">void force_tree_rebuild(ForceTree *tree, DomainDecomp *ddecomp, const int HybridNuGrav, const int DoMoments, const char *EmergencyOutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00140">forcetree.c:140</a></div></div>
<div class="ttc" id="aforcetree_8c_html_a965954b38afd36a3ce1047406d23cc22"><div class="ttname"><a href="forcetree_8c.html#a965954b38afd36a3ce1047406d23cc22">force_update_hmax</a></div><div class="ttdeci">void force_update_hmax(int *activeset, int size, ForceTree *tree, DomainDecomp *ddecomp)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l01271">forcetree.c:1271</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aa58562a96bb05cdba9466ecedafece27"><div class="ttname"><a href="forcetree_8c.html#aa58562a96bb05cdba9466ecedafece27">init_forcetree_params</a></div><div class="ttdeci">void init_forcetree_params(const int FastParticleType)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00043">forcetree.c:43</a></div></div>
<div class="ttc" id="aforcetree_8c_html_aaa26dfea4b696133a8bc35c5e0c56037"><div class="ttname"><a href="forcetree_8c.html#aaa26dfea4b696133a8bc35c5e0c56037">force_tree_free</a></div><div class="ttdeci">void force_tree_free(ForceTree *tree)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l01409">forcetree.c:1409</a></div></div>
<div class="ttc" id="aforcetree_8h_html"><div class="ttname"><a href="forcetree_8h.html">forcetree.h</a></div></div>
<div class="ttc" id="agravity_8c_html_a6468e8acac791552c30b0381857e573f"><div class="ttname"><a href="gravity_8c.html#a6468e8acac791552c30b0381857e573f">gravshort_fill_ntab</a></div><div class="ttdeci">void gravshort_fill_ntab(const enum ShortRangeForceWindowType ShortRangeForceWindowType, const double Asmth)</div><div class="ttdef"><b>Definition:</b> <a href="gravity_8c_source.html#l00023">gravity.c:23</a></div></div>
<div class="ttc" id="agravity_8h_html"><div class="ttname"><a href="gravity_8h.html">gravity.h</a></div></div>
<div class="ttc" id="agravity_8h_html_a28832a959ccb4e3dfb9899826df012fa"><div class="ttname"><a href="gravity_8h.html#a28832a959ccb4e3dfb9899826df012fa">get_gravshort_treepar</a></div><div class="ttdeci">struct gravshort_tree_params get_gravshort_treepar(void)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00055">gravshort-tree.c:60</a></div></div>
<div class="ttc" id="agravity_8h_html_a6e195525506b0c8f2638fda43cb8fa1f"><div class="ttname"><a href="gravity_8h.html#a6e195525506b0c8f2638fda43cb8fa1f">grav_short_pair</a></div><div class="ttdeci">void grav_short_pair(const ActiveParticles *act, PetaPM *pm, ForceTree *tree, double Rcut, double rho0, int NeutrinoTracer, int FastParticleType)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-pair_8c_source.html#l00024">gravshort-pair.c:24</a></div></div>
<div class="ttc" id="agravity_8h_html_ad95fd36f6f2e0ca8664796f845d5326c"><div class="ttname"><a href="gravity_8h.html#ad95fd36f6f2e0ca8664796f845d5326c">gravpm_force</a></div><div class="ttdeci">void gravpm_force(PetaPM *pm, ForceTree *tree, Cosmology *CP, double Time, double UnitLength_in_cm, const char *PowerOutputDir, double TimeIC, int FastParticleType)</div><div class="ttdef"><b>Definition:</b> <a href="gravpm_8c_source.html#l00062">gravpm.c:62</a></div></div>
<div class="ttc" id="agravity_8h_html_af372a315ec289670ceaf43db26a36b43"><div class="ttname"><a href="gravity_8h.html#af372a315ec289670ceaf43db26a36b43">grav_short_tree</a></div><div class="ttdeci">void grav_short_tree(const ActiveParticles *act, PetaPM *pm, ForceTree *tree, double rho0, int NeutrinoTracer, int FastParticleType)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00105">gravshort-tree.c:105</a></div></div>
<div class="ttc" id="agravity_8h_html_af9af33c424ac5a2f9c10b697977f657e"><div class="ttname"><a href="gravity_8h.html#af9af33c424ac5a2f9c10b697977f657e">gravpm_init_periodic</a></div><div class="ttdeci">void gravpm_init_periodic(PetaPM *pm, double BoxSize, double Asmth, int Nmesh, double G)</div><div class="ttdef"><b>Definition:</b> <a href="gravpm_8c_source.html#l00053">gravpm.c:53</a></div></div>
<div class="ttc" id="agravity_8h_html_afb6e6af8351f539b8c7d6e3a83f322bc"><div class="ttname"><a href="gravity_8h.html#afb6e6af8351f539b8c7d6e3a83f322bc">ShortRangeForceWindowType</a></div><div class="ttdeci">ShortRangeForceWindowType</div><div class="ttdef"><b>Definition:</b> <a href="gravity_8h_source.html#l00023">gravity.h:23</a></div></div>
<div class="ttc" id="ahci_8c_html_aacbd388585d5ed8cd917420f80c6508f"><div class="ttname"><a href="hci_8c.html#aacbd388585d5ed8cd917420f80c6508f">hci_init</a></div><div class="ttdeci">void hci_init(HCIManager *manager, char *prefix, double WallClockTimeLimit, double AutoCheckPointTime, int FOFEnabled)</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00025">hci.c:25</a></div></div>
<div class="ttc" id="ahci_8c_html_ab140bce619153b809e0fea49a2e1d081"><div class="ttname"><a href="hci_8c.html#ab140bce619153b809e0fea49a2e1d081">hci_query</a></div><div class="ttdeci">int hci_query(HCIManager *manager, HCIAction *action)</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00152">hci.c:152</a></div></div>
<div class="ttc" id="ahci_8c_html_adf575054e41280d79cdcad95d436b33d"><div class="ttname"><a href="hci_8c.html#adf575054e41280d79cdcad95d436b33d">hci_action_init</a></div><div class="ttdeci">void hci_action_init(HCIAction *action)</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00038">hci.c:38</a></div></div>
<div class="ttc" id="ahci_8h_html"><div class="ttname"><a href="hci_8h.html">hci.h</a></div></div>
<div class="ttc" id="ahci_8h_html_aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28"><div class="ttname"><a href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28">HCI_TERMINATE</a></div><div class="ttdeci">@ HCI_TERMINATE</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00026">hci.h:26</a></div></div>
<div class="ttc" id="ahci_8h_html_aab3c66bd8d0f209c23a32209638ccbe1ad0062d755a44738b16a821b96f493d54"><div class="ttname"><a href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1ad0062d755a44738b16a821b96f493d54">HCI_TIMEOUT</a></div><div class="ttdeci">@ HCI_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00023">hci.h:23</a></div></div>
<div class="ttc" id="ahydra_8c_html_aab8e916e02126d7f36d2065cc5678dec"><div class="ttname"><a href="hydra_8c.html#aab8e916e02126d7f36d2065cc5678dec">hydro_force</a></div><div class="ttdeci">void hydro_force(const ActiveParticles *act, const double atime, struct sph_pred_data *SPH_predicted, double MinEgySpec, const DriftKickTimes times, Cosmology *CP, const ForceTree *const tree)</div><div class="ttdef"><b>Definition:</b> <a href="hydra_8c_source.html#l00147">hydra.c:147</a></div></div>
<div class="ttc" id="ahydra_8c_html_ad2e04e2dce31315c1541bbea55f33d2a"><div class="ttname"><a href="hydra_8c.html#ad2e04e2dce31315c1541bbea55f33d2a">DensityIndependentSphOn</a></div><div class="ttdeci">int DensityIndependentSphOn(void)</div><div class="ttdef"><b>Definition:</b> <a href="hydra_8c_source.html#l00049">hydra.c:49</a></div></div>
<div class="ttc" id="ahydra_8h_html"><div class="ttname"><a href="hydra_8h.html">hydra.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a5490a5c3a899d73926b3c5290b805c6a"><div class="ttname"><a href="init_8c.html#a5490a5c3a899d73926b3c5290b805c6a">check_density_entropy</a></div><div class="ttdeci">void check_density_entropy(Cosmology *CP, const double MinEgySpec, const double atime)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00344">init.c:344</a></div></div>
<div class="ttc" id="ainit_8c_html_a713a74e1e0ca55699bc6581763bae177"><div class="ttname"><a href="init_8c.html#a713a74e1e0ca55699bc6581763bae177">setup_smoothinglengths</a></div><div class="ttdeci">void setup_smoothinglengths(int RestartSnapNum, DomainDecomp *ddecomp, Cosmology *CP, int BlackHoleOn, double MinEgySpec, double uu_in_cgs, const inttime_t Ti_Current, const double atime, const int64_t NTotGasInit)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00439">init.c:439</a></div></div>
<div class="ttc" id="ainit_8c_html_ac2e8594acf366f237632083d743efb0a"><div class="ttname"><a href="init_8c.html#ac2e8594acf366f237632083d743efb0a">init</a></div><div class="ttdeci">inttime_t init(int RestartSnapNum, const char *OutputDir, struct header_data *header, Cosmology *CP)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00086">init.c:86</a></div></div>
<div class="ttc" id="ainit_8c_html_aefa558832e90f57e2c3785480ebbea3e"><div class="ttname"><a href="init_8c.html#aefa558832e90f57e2c3785480ebbea3e">init_timeline</a></div><div class="ttdeci">void init_timeline(int RestartSnapNum, double TimeMax, const struct header_data *header, const int SnapshotWithFOF)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00056">init.c:56</a></div></div>
<div class="ttc" id="ainit_8h_html"><div class="ttname"><a href="init_8h.html">init.h</a></div></div>
<div class="ttc" id="alightcone_8c_html_a8c81fa9921177eede8a1c25c0365fd6b"><div class="ttname"><a href="lightcone_8c.html#a8c81fa9921177eede8a1c25c0365fd6b">lightcone_compute</a></div><div class="ttdeci">void lightcone_compute(double a, double BoxSize, Cosmology *CP, inttime_t ti_curr, inttime_t ti_next)</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00177">lightcone.c:177</a></div></div>
<div class="ttc" id="alightcone_8c_html_ae800971a34ef4e03eaa354cf28888c1d"><div class="ttname"><a href="lightcone_8c.html#ae800971a34ef4e03eaa354cf28888c1d">lightcone_init</a></div><div class="ttdeci">void lightcone_init(Cosmology *CP, double timeBegin, const double UnitLength_in_cm, const char *OutputDir)</div><div class="ttdef"><b>Definition:</b> <a href="lightcone_8c_source.html#l00091">lightcone.c:91</a></div></div>
<div class="ttc" id="alightcone_8h_html"><div class="ttname"><a href="lightcone_8h.html">lightcone.h</a></div></div>
<div class="ttc" id="ametal__return_8c_html_a7c817252ab7c0f679fea71bde6dea852"><div class="ttname"><a href="metal__return_8c.html#a7c817252ab7c0f679fea71bde6dea852">metal_return</a></div><div class="ttdeci">void metal_return(const ActiveParticles *act, DomainDecomp *const ddecomp, Cosmology *CP, const double atime, const double AvgGasMass)</div><div class="ttdef"><b>Definition:</b> <a href="metal__return_8c_source.html#l00517">metal_return.c:517</a></div></div>
<div class="ttc" id="ametal__return_8h_html"><div class="ttname"><a href="metal__return_8h.html">metal_return.h</a></div></div>
<div class="ttc" id="amymalloc_8h_html_ac576b6f19b635b512399d6afb8c20d99"><div class="ttname"><a href="mymalloc_8h.html#ac576b6f19b635b512399d6afb8c20d99">mymalloc2</a></div><div class="ttdeci">#define mymalloc2(name, size)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00016">mymalloc.h:16</a></div></div>
<div class="ttc" id="amymalloc_8h_html_af469c2f7e504a771f5d8a91ac9623240"><div class="ttname"><a href="mymalloc_8h.html#af469c2f7e504a771f5d8a91ac9623240">myfree</a></div><div class="ttdeci">#define myfree(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00019">mymalloc.h:19</a></div></div>
<div class="ttc" id="amymalloc_8h_html_afaf046f010cd01115a573a59e1e73e01"><div class="ttname"><a href="mymalloc_8h.html#afaf046f010cd01115a573a59e1e73e01">report_memory_usage</a></div><div class="ttdeci">#define report_memory_usage(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00030">mymalloc.h:30</a></div></div>
<div class="ttc" id="aneutrinos__lra_8c_html_a08c4fc5d722bdb43dd32a0f4fef3d0a8"><div class="ttname"><a href="neutrinos__lra_8c.html#a08c4fc5d722bdb43dd32a0f4fef3d0a8">init_neutrinos_lra</a></div><div class="ttdeci">void init_neutrinos_lra(const int nk_in, const double TimeTransfer, const double TimeMax, const double Omega0, const _omega_nu *const omnu, const double UnitTime_in_s, const double UnitLength_in_cm)</div><div class="ttdef"><b>Definition:</b> <a href="neutrinos__lra_8c_source.html#l00450">neutrinos_lra.c:450</a></div></div>
<div class="ttc" id="aneutrinos__lra_8h_html"><div class="ttname"><a href="neutrinos__lra_8h.html">neutrinos_lra.h</a></div></div>
<div class="ttc" id="aparamset_8c_html_a1ae36a31d95a8e2a9d2812bb9ecc9d49"><div class="ttname"><a href="paramset_8c.html#a1ae36a31d95a8e2a9d2812bb9ecc9d49">param_get_double</a></div><div class="ttdeci">double param_get_double(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00336">paramset.c:336</a></div></div>
<div class="ttc" id="aparamset_8c_html_a1f6042209e35f2497db00411eb03a495"><div class="ttname"><a href="paramset_8c.html#a1f6042209e35f2497db00411eb03a495">param_get_string2</a></div><div class="ttdeci">void param_get_string2(ParameterSet *ps, const char *name, char *dst, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00355">paramset.c:355</a></div></div>
<div class="ttc" id="aparamset_8c_html_a6228c17649c46aef53e74cd7ccb93fb0"><div class="ttname"><a href="paramset_8c.html#a6228c17649c46aef53e74cd7ccb93fb0">param_get_int</a></div><div class="ttdeci">int param_get_int(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00368">paramset.c:368</a></div></div>
<div class="ttc" id="aparamset_8c_html_abcc62489086c3bb14a61b90765e8d706"><div class="ttname"><a href="paramset_8c.html#abcc62489086c3bb14a61b90765e8d706">param_get_enum</a></div><div class="ttdeci">int param_get_enum(ParameterSet *ps, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00378">paramset.c:378</a></div></div>
<div class="ttc" id="apartmanager_8c_html_a6cef44682776e476d8f9f1b9e1f9fe16"><div class="ttname"><a href="partmanager_8c.html#a6cef44682776e476d8f9f1b9e1f9fe16">PartManager</a></div><div class="ttdeci">struct part_manager_type PartManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00001">partmanager.c:11</a></div></div>
<div class="ttc" id="apartmanager_8c_html_ad1574c3cad1cf90a7b1eb1f7a3b1486a"><div class="ttname"><a href="partmanager_8c.html#ad1574c3cad1cf90a7b1eb1f7a3b1486a">update_random_offset</a></div><div class="ttdeci">void update_random_offset(struct part_manager_type *PartManager, double *rel_random_shift, double RandomParticleOffset)</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8c_source.html#l00043">partmanager.c:43</a></div></div>
<div class="ttc" id="apetaio_8c_html_a302a6962b9f0b858b487fd3e6a24cf76"><div class="ttname"><a href="petaio_8c.html#a302a6962b9f0b858b487fd3e6a24cf76">petaio_read_header</a></div><div class="ttdeci">struct header_data petaio_read_header(int num, const char *OutputDir, Cosmology *CP)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00207">petaio.c:219</a></div></div>
<div class="ttc" id="apetaio_8c_html_a89fdd3f9913ac2a32579155754096620"><div class="ttname"><a href="petaio_8c.html#a89fdd3f9913ac2a32579155754096620">petaio_init</a></div><div class="ttdeci">void petaio_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8c_source.html#l00088">petaio.c:88</a></div></div>
<div class="ttc" id="apetaio_8h_html"><div class="ttname"><a href="petaio_8h.html">petaio.h</a></div></div>
<div class="ttc" id="apetapm_8c_html_a0a833f7a3fd985cc3cb305751ecb1dfb"><div class="ttname"><a href="petapm_8c.html#a0a833f7a3fd985cc3cb305751ecb1dfb">petapm_module_init</a></div><div class="ttdeci">void petapm_module_init(int Nthreads)</div><div class="ttdef"><b>Definition:</b> <a href="petapm_8c_source.html#l00082">petapm.c:82</a></div></div>
<div class="ttc" id="apetapm_8h_html"><div class="ttname"><a href="petapm_8h.html">petapm.h</a></div></div>
<div class="ttc" id="aphysconst_8h_html_a5a80b30e136f7032873530b2a44e224b"><div class="ttname"><a href="physconst_8h.html#a5a80b30e136f7032873530b2a44e224b">CM_PER_MPC</a></div><div class="ttdeci">#define CM_PER_MPC</div><div class="ttdef"><b>Definition:</b> <a href="physconst_8h_source.html#l00020">physconst.h:20</a></div></div>
<div class="ttc" id="arun_8c_html_a02ef4c629cc0fea15dce527f09ea672f"><div class="ttname"><a href="run_8c.html#a02ef4c629cc0fea15dce527f09ea672f">runfof</a></div><div class="ttdeci">void runfof(const int RestartSnapNum, const inttime_t Ti_Current, const struct header_data *header)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00652">run.c:652</a></div></div>
<div class="ttc" id="arun_8c_html_a0ad0c5dc6cd8a823b1c4b3605c3a3cb1"><div class="ttname"><a href="run_8c.html#a0ad0c5dc6cd8a823b1c4b3605c3a3cb1">find_last_snapshot</a></div><div class="ttdeci">int find_last_snapshot(void)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00182">run.c:182</a></div></div>
<div class="ttc" id="arun_8c_html_a1950f10ea7c36574b9f7e7440070873b"><div class="ttname"><a href="run_8c.html#a1950f10ea7c36574b9f7e7440070873b">Clocks</a></div><div class="ttdeci">static struct ClockTable Clocks</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00001">run.c:38</a></div></div>
<div class="ttc" id="arun_8c_html_a2904574467d5ae303174dc9ccebc82da"><div class="ttname"><a href="run_8c.html#a2904574467d5ae303174dc9ccebc82da">use_pairwise_gravity</a></div><div class="ttdeci">static int use_pairwise_gravity(ActiveParticles *Act, struct part_manager_type *PartManager)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00267">run.c:267</a></div></div>
<div class="ttc" id="arun_8c_html_a5cf63750ffcbf4a841f300b3887a3727"><div class="ttname"><a href="run_8c.html#a5cf63750ffcbf4a841f300b3887a3727">set_all_global_params</a></div><div class="ttdeci">void set_all_global_params(ParameterSet *ps)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00106">run.c:106</a></div></div>
<div class="ttc" id="arun_8c_html_a89690448ef43a8d624b963382b7503ed"><div class="ttname"><a href="run_8c.html#a89690448ef43a8d624b963382b7503ed">run</a></div><div class="ttdeci">void run(const int RestartSnapNum, const inttime_t ti_init, const struct header_data *header)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00284">run.c:284</a></div></div>
<div class="ttc" id="arun_8c_html_ab1d8bf99f794003fa95002043fe3b47c"><div class="ttname"><a href="run_8c.html#ab1d8bf99f794003fa95002043fe3b47c">runtests</a></div><div class="ttdeci">void runtests(const int RestartSnapNum, const inttime_t Ti_Current, const struct header_data *header)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00646">run.c:646</a></div></div>
<div class="ttc" id="arun_8c_html_ac375cbba056f17379640791c81947612"><div class="ttname"><a href="run_8c.html#ac375cbba056f17379640791c81947612">All</a></div><div class="ttdeci">static struct run_params All</div></div>
<div class="ttc" id="arun_8c_html_aee4609880c9e92e1c421c4bd238589fd"><div class="ttname"><a href="run_8c.html#aee4609880c9e92e1c421c4bd238589fd">begrun</a></div><div class="ttdeci">inttime_t begrun(const int RestartSnapNum, struct header_data *head)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00194">run.c:194</a></div></div>
<div class="ttc" id="arun_8c_html_afc20ced36c74991ca5c2004510c6c628"><div class="ttname"><a href="run_8c.html#afc20ced36c74991ca5c2004510c6c628">runpower</a></div><div class="ttdeci">void runpower(const struct header_data *header)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00691">run.c:691</a></div></div>
<div class="ttc" id="arun_8h_html"><div class="ttname"><a href="run_8h.html">run.h</a></div></div>
<div class="ttc" id="arun_8h_html_aa438e424237818b7728b98cd764e45d1"><div class="ttname"><a href="run_8h.html#aa438e424237818b7728b98cd764e45d1">run_gravity_test</a></div><div class="ttdeci">void run_gravity_test(int RestartSnapNum, Cosmology *CP, const double Asmth, const int Nmesh, const int FastParticleType, const inttime_t Ti_Current, const char *OutputDir, const struct header_data *header)</div><div class="ttdef"><b>Definition:</b> <a href="runtests_8c_source.html#l00071">runtests.c:71</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_a17ba6f2251e04bc57005d00cc09640c8"><div class="ttname"><a href="sfr__eff_8c.html#a17ba6f2251e04bc57005d00cc09640c8">init_cooling_and_star_formation</a></div><div class="ttdeci">void init_cooling_and_star_formation(int CoolingOn, int StarformationOn, Cosmology *CP, const double avg_baryon_mass, const double BoxSize, const struct UnitSystem units)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00805">sfr_eff.c:805</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_aa4503d203fa143d76d004c0719415562"><div class="ttname"><a href="sfr__eff_8c.html#aa4503d203fa143d76d004c0719415562">get_MinEgySpec</a></div><div class="ttdeci">double get_MinEgySpec(void)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00797">sfr_eff.c:797</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_abc5b151d356619b98a8ded72cc9426c7"><div class="ttname"><a href="sfr__eff_8c.html#abc5b151d356619b98a8ded72cc9426c7">cooling_and_starformation</a></div><div class="ttdeci">void cooling_and_starformation(ActiveParticles *act, double Time, double dloga, ForceTree *tree, const Cosmology *CP, MyFloat *GradRho, FILE *FdSfr)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00167">sfr_eff.c:167</a></div></div>
<div class="ttc" id="asfr__eff_8c_html_aefebad1cdf9c3fe278031e2b78d69859"><div class="ttname"><a href="sfr__eff_8c.html#aefebad1cdf9c3fe278031e2b78d69859">sfr_need_to_compute_sph_grad_rho</a></div><div class="ttdeci">int sfr_need_to_compute_sph_grad_rho(void)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00952">sfr_eff.c:952</a></div></div>
<div class="ttc" id="asfr__eff_8h_html"><div class="ttname"><a href="sfr__eff_8h.html">sfr_eff.h</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a2528e7745039275b8e7eab8561ca9a74"><div class="ttname"><a href="slotsmanager_8c.html#a2528e7745039275b8e7eab8561ca9a74">slots_set_enabled</a></div><div class="ttdeci">void slots_set_enabled(int ptype, size_t elsize, struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00560">slotsmanager.c:560</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_a82d3ca06acff364846599d31e2c8f83b"><div class="ttname"><a href="slotsmanager_8c.html#a82d3ca06acff364846599d31e2c8f83b">slots_gc</a></div><div class="ttdeci">int slots_gc(int *compact_slots, struct part_manager_type *pman, struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00145">slotsmanager.c:145</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_aa317621b6c60bc95c5f3e33c648e8392"><div class="ttname"><a href="slotsmanager_8c.html#aa317621b6c60bc95c5f3e33c648e8392">SlotsManager</a></div><div class="ttdeci">struct slots_manager_type SlotsManager[1]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00001">slotsmanager.c:7</a></div></div>
<div class="ttc" id="aslotsmanager_8c_html_ac101f8cc9a2090608d269ce503b7b887"><div class="ttname"><a href="slotsmanager_8c.html#ac101f8cc9a2090608d269ce503b7b887">slots_init</a></div><div class="ttdeci">void slots_init(double increase, struct slots_manager_type *sman)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00550">slotsmanager.c:550</a></div></div>
<div class="ttc" id="aslotsmanager_8h_html"><div class="ttname"><a href="slotsmanager_8h.html">slotsmanager.h</a></div></div>
<div class="ttc" id="astats_8c_html_a82cc2058393193cc90894aa756a9d8b2"><div class="ttname"><a href="stats_8c.html#a82cc2058393193cc90894aa756a9d8b2">write_cpu_log</a></div><div class="ttdeci">void write_cpu_log(int NumCurrentTiStep, const double atime, FILE *FdCPU, double ElapsedTime)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8c_source.html#l00165">stats.c:165</a></div></div>
<div class="ttc" id="astats_8c_html_a997347b9c3f08a2f1258a8b7ee5b4e08"><div class="ttname"><a href="stats_8c.html#a997347b9c3f08a2f1258a8b7ee5b4e08">close_outputfiles</a></div><div class="ttdeci">void close_outputfiles(struct OutputFD *fds)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8c_source.html#l00150">stats.c:150</a></div></div>
<div class="ttc" id="astats_8c_html_aaaf6ae611911a7f7217602b29171c1cd"><div class="ttname"><a href="stats_8c.html#aaaf6ae611911a7f7217602b29171c1cd">energy_statistics</a></div><div class="ttdeci">void energy_statistics(FILE *FdEnergy, const double Time, struct part_manager_type *PartManager)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8c_source.html#l00334">stats.c:334</a></div></div>
<div class="ttc" id="astats_8c_html_ae30f4f36cdd6dacf0862d499a11d6d88"><div class="ttname"><a href="stats_8c.html#ae30f4f36cdd6dacf0862d499a11d6d88">open_outputfiles</a></div><div class="ttdeci">void open_outputfiles(int RestartSnapNum, struct OutputFD *fds, const char *OutputDir, int BlackHoleOn, int StarformationOn)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8c_source.html#l00073">stats.c:73</a></div></div>
<div class="ttc" id="astats_8h_html"><div class="ttname"><a href="stats_8h.html">stats.h</a></div></div>
<div class="ttc" id="astring_8c_html_a787c3b0717214d830c69b7e8785a3e33"><div class="ttname"><a href="string_8c.html#a787c3b0717214d830c69b7e8785a3e33">fastpm_strdup_printf</a></div><div class="ttdeci">char * fastpm_strdup_printf(const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="string_8c_source.html#l00041">string.c:41</a></div></div>
<div class="ttc" id="astring_8h_html"><div class="ttname"><a href="string_8h.html">string.h</a></div></div>
<div class="ttc" id="astructActiveParticles_html"><div class="ttname"><a href="structActiveParticles.html">ActiveParticles</a></div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00009">timestep.h:10</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a1b0b230f3890d70bae976516719b7d07"><div class="ttname"><a href="structActiveParticles.html#a1b0b230f3890d70bae976516719b7d07">ActiveParticles::ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00013">timestep.h:13</a></div></div>
<div class="ttc" id="astructActiveParticles_html_a847ab898fdabc62a4723c7c3a66038d4"><div class="ttname"><a href="structActiveParticles.html#a847ab898fdabc62a4723c7c3a66038d4">ActiveParticles::NumActiveParticle</a></div><div class="ttdeci">int64_t NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00012">timestep.h:12</a></div></div>
<div class="ttc" id="astructClockTable_html"><div class="ttname"><a href="structClockTable.html">ClockTable</a></div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00048">walltime.h:48</a></div></div>
<div class="ttc" id="astructClockTable_html_a4cca76e9c7472e9fca344568b1021522"><div class="ttname"><a href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ClockTable::ElapsedTime</a></div><div class="ttdeci">double ElapsedTime</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00054">walltime.h:54</a></div></div>
<div class="ttc" id="astructCosmology_html"><div class="ttname"><a href="structCosmology.html">Cosmology</a></div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00008">cosmology.h:8</a></div></div>
<div class="ttc" id="astructCosmology_html_a0970aac048f04a9ccd8778aaf07a0bbc"><div class="ttname"><a href="structCosmology.html#a0970aac048f04a9ccd8778aaf07a0bbc">Cosmology::GravInternal</a></div><div class="ttdeci">double GravInternal</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00032">cosmology.h:32</a></div></div>
<div class="ttc" id="astructCosmology_html_a10a2776043457f88c4bf314fcc399221"><div class="ttname"><a href="structCosmology.html#a10a2776043457f88c4bf314fcc399221">Cosmology::wa_fld</a></div><div class="ttdeci">double wa_fld</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00017">cosmology.h:17</a></div></div>
<div class="ttc" id="astructCosmology_html_a121b6c180aa46cff6bc708a78b4ebce7"><div class="ttname"><a href="structCosmology.html#a121b6c180aa46cff6bc708a78b4ebce7">Cosmology::Omega_ur</a></div><div class="ttdeci">double Omega_ur</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00018">cosmology.h:18</a></div></div>
<div class="ttc" id="astructCosmology_html_a17dd6ac8ee1e3bf0469904d0ff5f67d5"><div class="ttname"><a href="structCosmology.html#a17dd6ac8ee1e3bf0469904d0ff5f67d5">Cosmology::HybridNeutrinosOn</a></div><div class="ttdeci">int HybridNeutrinosOn</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00028">cosmology.h:28</a></div></div>
<div class="ttc" id="astructCosmology_html_a38009c7acc85c095a49eb23af5180d9b"><div class="ttname"><a href="structCosmology.html#a38009c7acc85c095a49eb23af5180d9b">Cosmology::Omega_fld</a></div><div class="ttdeci">double Omega_fld</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00015">cosmology.h:15</a></div></div>
<div class="ttc" id="astructCosmology_html_a43e0dba956c6dc4fad8b1aaf0fa84248"><div class="ttname"><a href="structCosmology.html#a43e0dba956c6dc4fad8b1aaf0fa84248">Cosmology::Omega0</a></div><div class="ttdeci">double Omega0</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00010">cosmology.h:10</a></div></div>
<div class="ttc" id="astructCosmology_html_a443cf4ce10b4d5a2b242d4a2f9078866"><div class="ttname"><a href="structCosmology.html#a443cf4ce10b4d5a2b242d4a2f9078866">Cosmology::RadiationOn</a></div><div class="ttdeci">int RadiationOn</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00023">cosmology.h:23</a></div></div>
<div class="ttc" id="astructCosmology_html_a4b79dcaa1e1c38d07258c3f539e2cb20"><div class="ttname"><a href="structCosmology.html#a4b79dcaa1e1c38d07258c3f539e2cb20">Cosmology::HubbleParam</a></div><div class="ttdeci">double HubbleParam</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00020">cosmology.h:20</a></div></div>
<div class="ttc" id="astructCosmology_html_a5c6cde04880e3be264f528e8b7dd5c8d"><div class="ttname"><a href="structCosmology.html#a5c6cde04880e3be264f528e8b7dd5c8d">Cosmology::HybridVcrit</a></div><div class="ttdeci">double HybridVcrit</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00029">cosmology.h:29</a></div></div>
<div class="ttc" id="astructCosmology_html_a62b59388eea6cbc92a29697e2e969b34"><div class="ttname"><a href="structCosmology.html#a62b59388eea6cbc92a29697e2e969b34">Cosmology::CMBTemperature</a></div><div class="ttdeci">double CMBTemperature</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00009">cosmology.h:9</a></div></div>
<div class="ttc" id="astructCosmology_html_ab98e5d1db0ac5adc89510264da3ab443"><div class="ttname"><a href="structCosmology.html#ab98e5d1db0ac5adc89510264da3ab443">Cosmology::UnitTime_in_s</a></div><div class="ttdeci">double UnitTime_in_s</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00022">cosmology.h:22</a></div></div>
<div class="ttc" id="astructCosmology_html_ac27ad0bd8a6135a2b7da6c49c375d73e"><div class="ttname"><a href="structCosmology.html#ac27ad0bd8a6135a2b7da6c49c375d73e">Cosmology::OmegaLambda</a></div><div class="ttdeci">double OmegaLambda</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00014">cosmology.h:14</a></div></div>
<div class="ttc" id="astructCosmology_html_ac818659114fd72f09039b088e43e8624"><div class="ttname"><a href="structCosmology.html#ac818659114fd72f09039b088e43e8624">Cosmology::OmegaBaryon</a></div><div class="ttdeci">double OmegaBaryon</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00019">cosmology.h:19</a></div></div>
<div class="ttc" id="astructCosmology_html_acae4b7f6fe916eb7913dbe60eab18b4f"><div class="ttname"><a href="structCosmology.html#acae4b7f6fe916eb7913dbe60eab18b4f">Cosmology::HybridNuPartTime</a></div><div class="ttdeci">double HybridNuPartTime</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00031">cosmology.h:31</a></div></div>
<div class="ttc" id="astructCosmology_html_ad088df185d7995a9c95eb5e87e006ea5"><div class="ttname"><a href="structCosmology.html#ad088df185d7995a9c95eb5e87e006ea5">Cosmology::MassiveNuLinRespOn</a></div><div class="ttdeci">int MassiveNuLinRespOn</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00026">cosmology.h:26</a></div></div>
<div class="ttc" id="astructCosmology_html_ae9e96a98294e31d5d2ab18e244e8fa33"><div class="ttname"><a href="structCosmology.html#ae9e96a98294e31d5d2ab18e244e8fa33">Cosmology::MNu</a></div><div class="ttdeci">double MNu[3]</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00025">cosmology.h:25</a></div></div>
<div class="ttc" id="astructCosmology_html_af03043a56ad2b2b697762d127b8b906b"><div class="ttname"><a href="structCosmology.html#af03043a56ad2b2b697762d127b8b906b">Cosmology::ONu</a></div><div class="ttdeci">_omega_nu ONu</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00024">cosmology.h:24</a></div></div>
<div class="ttc" id="astructCosmology_html_af1c6029696c00e5405054f00e849e972"><div class="ttname"><a href="structCosmology.html#af1c6029696c00e5405054f00e849e972">Cosmology::Hubble</a></div><div class="ttdeci">double Hubble</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00021">cosmology.h:21</a></div></div>
<div class="ttc" id="astructCosmology_html_af37a1c97e02105a06e1dcb9112f1db5b"><div class="ttname"><a href="structCosmology.html#af37a1c97e02105a06e1dcb9112f1db5b">Cosmology::w0_fld</a></div><div class="ttdeci">double w0_fld</div><div class="ttdef"><b>Definition:</b> <a href="cosmology_8h_source.html#l00016">cosmology.h:16</a></div></div>
<div class="ttc" id="astructDomainDecomp_html"><div class="ttname"><a href="structDomainDecomp.html">DomainDecomp</a></div><div class="ttdef"><b>Definition:</b> <a href="domain_8h_source.html#l00033">domain.h:33</a></div></div>
<div class="ttc" id="astructDriftData_html"><div class="ttname"><a href="structDriftData.html">DriftData</a></div><div class="ttdef"><b>Definition:</b> <a href="drift_8h_source.html#l00013">drift.h:14</a></div></div>
<div class="ttc" id="astructDriftData_html_a491144ae99df44e97e83827a75060c84"><div class="ttname"><a href="structDriftData.html#a491144ae99df44e97e83827a75060c84">DriftData::ti0</a></div><div class="ttdeci">inttime_t ti0</div><div class="ttdef"><b>Definition:</b> <a href="drift_8h_source.html#l00015">drift.h:15</a></div></div>
<div class="ttc" id="astructDriftData_html_a505a8878f34f4d9773a75b0307d1afc8"><div class="ttname"><a href="structDriftData.html#a505a8878f34f4d9773a75b0307d1afc8">DriftData::CP</a></div><div class="ttdeci">Cosmology * CP</div><div class="ttdef"><b>Definition:</b> <a href="drift_8h_source.html#l00017">drift.h:17</a></div></div>
<div class="ttc" id="astructDriftData_html_a8c5d44c35b74f9bec127072192ccc83e"><div class="ttname"><a href="structDriftData.html#a8c5d44c35b74f9bec127072192ccc83e">DriftData::ti1</a></div><div class="ttdeci">inttime_t ti1</div><div class="ttdef"><b>Definition:</b> <a href="drift_8h_source.html#l00016">drift.h:16</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html"><div class="ttname"><a href="structDriftKickTimes.html">DriftKickTimes</a></div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00017">timestep.h:18</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_a8cbfa406f883f7f7e6ef53cfa4608f7d"><div class="ttname"><a href="structDriftKickTimes.html#a8cbfa406f883f7f7e6ef53cfa4608f7d">DriftKickTimes::Ti_Current</a></div><div class="ttdeci">inttime_t Ti_Current</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00027">timestep.h:27</a></div></div>
<div class="ttc" id="astructDriftKickTimes_html_ad3b4fe6ff2b0e0be706882c59323621e"><div class="ttname"><a href="structDriftKickTimes.html#ad3b4fe6ff2b0e0be706882c59323621e">DriftKickTimes::mintimebin</a></div><div class="ttdeci">int mintimebin</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8h_source.html#l00020">timestep.h:20</a></div></div>
<div class="ttc" id="astructFOFGroups_html"><div class="ttname"><a href="structFOFGroups.html">FOFGroups</a></div><div class="ttdef"><b>Definition:</b> <a href="fof_8h_source.html#l00061">fof.h:62</a></div></div>
<div class="ttc" id="astructForceTree_html"><div class="ttname"><a href="structForceTree.html">ForceTree</a></div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8h_source.html#l00076">forcetree.h:76</a></div></div>
<div class="ttc" id="astructHCIAction_html"><div class="ttname"><a href="structHCIAction.html">HCIAction</a></div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00030">hci.h:31</a></div></div>
<div class="ttc" id="astructHCIAction_html_a5b7387d5b3a88f5b5389153cc585a07c"><div class="ttname"><a href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">HCIAction::type</a></div><div class="ttdeci">enum HCIActionType type</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00017">hci.h:32</a></div></div>
<div class="ttc" id="astructHCIAction_html_a60b86f3851076753015f6025945edf91"><div class="ttname"><a href="structHCIAction.html#a60b86f3851076753015f6025945edf91">HCIAction::write_snapshot</a></div><div class="ttdeci">int write_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00033">hci.h:33</a></div></div>
<div class="ttc" id="astructHCIAction_html_abb818915ca3d7aafac9c53731fef4475"><div class="ttname"><a href="structHCIAction.html#abb818915ca3d7aafac9c53731fef4475">HCIAction::write_fof</a></div><div class="ttdeci">int write_fof</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00034">hci.h:34</a></div></div>
<div class="ttc" id="astructHCIManager_html"><div class="ttname"><a href="structHCIManager.html">HCIManager</a></div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00004">hci.h:4</a></div></div>
<div class="ttc" id="astructOutputFD_html"><div class="ttname"><a href="structOutputFD.html">OutputFD</a></div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00007">stats.h:8</a></div></div>
<div class="ttc" id="astructOutputFD_html_a0060c1e25e1d1e47f2188eddd6d93a39"><div class="ttname"><a href="structOutputFD.html#a0060c1e25e1d1e47f2188eddd6d93a39">OutputFD::FdBlackHoles</a></div><div class="ttdeci">FILE * FdBlackHoles</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00012">stats.h:12</a></div></div>
<div class="ttc" id="astructOutputFD_html_a1813f7e1b110c626db21805b508f7953"><div class="ttname"><a href="structOutputFD.html#a1813f7e1b110c626db21805b508f7953">OutputFD::FdBlackholeDetails</a></div><div class="ttdeci">FILE * FdBlackholeDetails</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00013">stats.h:13</a></div></div>
<div class="ttc" id="astructOutputFD_html_a4f82c5e9afe142b5eda1bf51bdf43b36"><div class="ttname"><a href="structOutputFD.html#a4f82c5e9afe142b5eda1bf51bdf43b36">OutputFD::FdHelium</a></div><div class="ttdeci">FILE * FdHelium</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00014">stats.h:14</a></div></div>
<div class="ttc" id="astructOutputFD_html_a77f5a9cff4366e1a94acbf1f424bd64e"><div class="ttname"><a href="structOutputFD.html#a77f5a9cff4366e1a94acbf1f424bd64e">OutputFD::FdEnergy</a></div><div class="ttdeci">FILE * FdEnergy</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00009">stats.h:9</a></div></div>
<div class="ttc" id="astructOutputFD_html_a7e48b9018143ed051104f68a04628c79"><div class="ttname"><a href="structOutputFD.html#a7e48b9018143ed051104f68a04628c79">OutputFD::FdSfr</a></div><div class="ttdeci">FILE * FdSfr</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00011">stats.h:11</a></div></div>
<div class="ttc" id="astructOutputFD_html_ae53f8603f102e700c37467c8fd3d1595"><div class="ttname"><a href="structOutputFD.html#ae53f8603f102e700c37467c8fd3d1595">OutputFD::FdCPU</a></div><div class="ttdeci">FILE * FdCPU</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00010">stats.h:10</a></div></div>
<div class="ttc" id="astructParameterSet_html"><div class="ttname"><a href="structParameterSet.html">ParameterSet</a></div><div class="ttdef"><b>Definition:</b> <a href="paramset_8c_source.html#l00095">paramset.c:95</a></div></div>
<div class="ttc" id="astructPetaPM_html"><div class="ttname"><a href="structPetaPM.html">PetaPM</a></div><div class="ttdef"><b>Definition:</b> <a href="petapm_8h_source.html#l00062">petapm.h:62</a></div></div>
<div class="ttc" id="astructSyncPoint_html"><div class="ttname"><a href="structSyncPoint.html">SyncPoint</a></div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00022">timebinmgr.h:23</a></div></div>
<div class="ttc" id="astructSyncPoint_html_a4423ca022f08153c9ae086784e97565b"><div class="ttname"><a href="structSyncPoint.html#a4423ca022f08153c9ae086784e97565b">SyncPoint::write_fof</a></div><div class="ttdeci">int write_fof</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00027">timebinmgr.h:27</a></div></div>
<div class="ttc" id="astructSyncPoint_html_af86f979490f9dd8cf7e9488f2c68503c"><div class="ttname"><a href="structSyncPoint.html#af86f979490f9dd8cf7e9488f2c68503c">SyncPoint::write_snapshot</a></div><div class="ttdeci">int write_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00026">timebinmgr.h:26</a></div></div>
<div class="ttc" id="astructUnitSystem_html"><div class="ttname"><a href="structUnitSystem.html">UnitSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="unitsystem_8h_source.html#l00007">unitsystem.h:7</a></div></div>
<div class="ttc" id="astructUnitSystem_html_a3ebe1ddf4cba3793bcf24181184ff418"><div class="ttname"><a href="structUnitSystem.html#a3ebe1ddf4cba3793bcf24181184ff418">UnitSystem::UnitInternalEnergy_in_cgs</a></div><div class="ttdeci">double UnitInternalEnergy_in_cgs</div><div class="ttdef"><b>Definition:</b> <a href="unitsystem_8h_source.html#l00014">unitsystem.h:14</a></div></div>
<div class="ttc" id="astructUnitSystem_html_ac9bf5677cfdf7a47b50d40a7e975941b"><div class="ttname"><a href="structUnitSystem.html#ac9bf5677cfdf7a47b50d40a7e975941b">UnitSystem::UnitLength_in_cm</a></div><div class="ttdeci">double UnitLength_in_cm</div><div class="ttdef"><b>Definition:</b> <a href="unitsystem_8h_source.html#l00010">unitsystem.h:10</a></div></div>
<div class="ttc" id="astructbh__particle__data_html"><div class="ttname"><a href="structbh__particle__data.html">bh_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00028">slotsmanager.h:28</a></div></div>
<div class="ttc" id="astructgravshort__tree__params_html"><div class="ttname"><a href="structgravshort__tree__params.html">gravshort_tree_params</a></div><div class="ttdef"><b>Definition:</b> <a href="gravity_8h_source.html#l00009">gravity.h:10</a></div></div>
<div class="ttc" id="astructgravshort__tree__params_html_a2de5c53741627e04b9a7c45a58ff9df9"><div class="ttname"><a href="structgravshort__tree__params.html#a2de5c53741627e04b9a7c45a58ff9df9">gravshort_tree_params::Rcut</a></div><div class="ttdeci">double Rcut</div><div class="ttdef"><b>Definition:</b> <a href="gravity_8h_source.html#l00016">gravity.h:16</a></div></div>
<div class="ttc" id="astructheader__data_html"><div class="ttname"><a href="structheader__data.html">header_data</a></div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00013">petaio.h:14</a></div></div>
<div class="ttc" id="astructheader__data_html_a0c7b9fa17aae847e0943fca860b433b8"><div class="ttname"><a href="structheader__data.html#a0c7b9fa17aae847e0943fca860b433b8">header_data::TimeIC</a></div><div class="ttdeci">double TimeIC</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00024">petaio.h:24</a></div></div>
<div class="ttc" id="astructheader__data_html_a3018a9d27eb35ace7191750070e5b738"><div class="ttname"><a href="structheader__data.html#a3018a9d27eb35ace7191750070e5b738">header_data::NTotalInit</a></div><div class="ttdeci">int64_t NTotalInit[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00020">petaio.h:20</a></div></div>
<div class="ttc" id="astructheader__data_html_a3f2592f3de9589278f2729aefc8fe470"><div class="ttname"><a href="structheader__data.html#a3f2592f3de9589278f2729aefc8fe470">header_data::TimeSnapshot</a></div><div class="ttdeci">double TimeSnapshot</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00026">petaio.h:26</a></div></div>
<div class="ttc" id="astructheader__data_html_a688df7c6718763c7e6a31a48d2de0334"><div class="ttname"><a href="structheader__data.html#a688df7c6718763c7e6a31a48d2de0334">header_data::UnitMass_in_g</a></div><div class="ttdeci">double UnitMass_in_g</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00031">petaio.h:31</a></div></div>
<div class="ttc" id="astructheader__data_html_aaa78a996d4b10f0509c26ca61eb4d644"><div class="ttname"><a href="structheader__data.html#aaa78a996d4b10f0509c26ca61eb4d644">header_data::MassTable</a></div><div class="ttdeci">double MassTable[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00022">petaio.h:22</a></div></div>
<div class="ttc" id="astructheader__data_html_ac36f80ed4e241b322d104dfbddea82d5"><div class="ttname"><a href="structheader__data.html#ac36f80ed4e241b322d104dfbddea82d5">header_data::UnitVelocity_in_cm_per_s</a></div><div class="ttdeci">double UnitVelocity_in_cm_per_s</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00032">petaio.h:32</a></div></div>
<div class="ttc" id="astructheader__data_html_acfb3b8eb5b66cb6cde582cd7fdda04d0"><div class="ttname"><a href="structheader__data.html#acfb3b8eb5b66cb6cde582cd7fdda04d0">header_data::UnitLength_in_cm</a></div><div class="ttdeci">double UnitLength_in_cm</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00030">petaio.h:30</a></div></div>
<div class="ttc" id="astructheader__data_html_ad4f7e1387f12a061d7cd6181213e8ed8"><div class="ttname"><a href="structheader__data.html#ad4f7e1387f12a061d7cd6181213e8ed8">header_data::neutrinonk</a></div><div class="ttdeci">int neutrinonk</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00034">petaio.h:34</a></div></div>
<div class="ttc" id="astructheader__data_html_ae28db91028a22d277523890fd51d72c4"><div class="ttname"><a href="structheader__data.html#ae28db91028a22d277523890fd51d72c4">header_data::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00028">petaio.h:28</a></div></div>
<div class="ttc" id="astructheader__data_html_afd7952ed03fc314454e077e755851558"><div class="ttname"><a href="structheader__data.html#afd7952ed03fc314454e077e755851558">header_data::NTotal</a></div><div class="ttdeci">int64_t NTotal[6]</div><div class="ttdef"><b>Definition:</b> <a href="petaio_8h_source.html#l00018">petaio.h:18</a></div></div>
<div class="ttc" id="astructpart__manager__type_html"><div class="ttname"><a href="structpart__manager__type.html">part_manager_type</a></div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00073">partmanager.h:73</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a45e1f95715be50e4081af78f4ee99cb5"><div class="ttname"><a href="structpart__manager__type.html#a45e1f95715be50e4081af78f4ee99cb5">part_manager_type::NumPart</a></div><div class="ttdeci">int64_t NumPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00076">partmanager.h:76</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_a5e24abb34f2c8998d8b35c217477d580"><div class="ttname"><a href="structpart__manager__type.html#a5e24abb34f2c8998d8b35c217477d580">part_manager_type::MaxPart</a></div><div class="ttdeci">int64_t MaxPart</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00078">partmanager.h:78</a></div></div>
<div class="ttc" id="astructpart__manager__type_html_afd51316d545eaf7f3f083aea9616858d"><div class="ttname"><a href="structpart__manager__type.html#afd51316d545eaf7f3f083aea9616858d">part_manager_type::BoxSize</a></div><div class="ttdeci">double BoxSize</div><div class="ttdef"><b>Definition:</b> <a href="partmanager_8h_source.html#l00084">partmanager.h:84</a></div></div>
<div class="ttc" id="astructrun__params_html"><div class="ttname"><a href="structrun__params.html">run_params</a></div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00045">run.c:46</a></div></div>
<div class="ttc" id="astructrun__params_html_a0d9911c8b4c161bc9ae7214226404155"><div class="ttname"><a href="structrun__params.html#a0d9911c8b4c161bc9ae7214226404155">run_params::CP</a></div><div class="ttdeci">Cosmology CP</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00059">run.c:59</a></div></div>
<div class="ttc" id="astructrun__params_html_a1634ca118e6f917177ec1db22310f6d0"><div class="ttname"><a href="structrun__params.html#a1634ca118e6f917177ec1db22310f6d0">run_params::OutputDebugFields</a></div><div class="ttdeci">int OutputDebugFields</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00048">run.c:48</a></div></div>
<div class="ttc" id="astructrun__params_html_a1e13b59dd08195b44de3c83d47ec1897"><div class="ttname"><a href="structrun__params.html#a1e13b59dd08195b44de3c83d47ec1897">run_params::TimeLimitCPU</a></div><div class="ttdeci">double TimeLimitCPU</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00089">run.c:89</a></div></div>
<div class="ttc" id="astructrun__params_html_a238db4daed3c1c1dc006c5713b298175"><div class="ttname"><a href="structrun__params.html#a238db4daed3c1c1dc006c5713b298175">run_params::RandomSeed</a></div><div class="ttdeci">int RandomSeed</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00101">run.c:101</a></div></div>
<div class="ttc" id="astructrun__params_html_a243c7ee5ac37000e6bb37f29b75d72fb"><div class="ttname"><a href="structrun__params.html#a243c7ee5ac37000e6bb37f29b75d72fb">run_params::BlackHoleOn</a></div><div class="ttdeci">int BlackHoleOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00067">run.c:67</a></div></div>
<div class="ttc" id="astructrun__params_html_a3b130ce4a4b8d01bd62166f7f145a298"><div class="ttname"><a href="structrun__params.html#a3b130ce4a4b8d01bd62166f7f145a298">run_params::ShortRangeForceWindowType</a></div><div class="ttdeci">enum ShortRangeForceWindowType ShortRangeForceWindowType</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00092">run.c:93</a></div></div>
<div class="ttc" id="astructrun__params_html_a3c5df87e7673f24a009dd12d0a3d0175"><div class="ttname"><a href="structrun__params.html#a3c5df87e7673f24a009dd12d0a3d0175">run_params::RandomParticleOffset</a></div><div class="ttdeci">double RandomParticleOffset</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00050">run.c:50</a></div></div>
<div class="ttc" id="astructrun__params_html_a42ac1e3c46d3cacd6d452b7ab43fce70"><div class="ttname"><a href="structrun__params.html#a42ac1e3c46d3cacd6d452b7ab43fce70">run_params::FastParticleType</a></div><div class="ttdeci">int FastParticleType</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00075">run.c:75</a></div></div>
<div class="ttc" id="astructrun__params_html_a44c95cdbb3636975f9e0fb0d6f47b949"><div class="ttname"><a href="structrun__params.html#a44c95cdbb3636975f9e0fb0d6f47b949">run_params::DensityOn</a></div><div class="ttdeci">int DensityOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00064">run.c:64</a></div></div>
<div class="ttc" id="astructrun__params_html_a46c6bf0aa969903021103b0e9da84a0f"><div class="ttname"><a href="structrun__params.html#a46c6bf0aa969903021103b0e9da84a0f">run_params::LightconeOn</a></div><div class="ttdeci">int LightconeOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00070">run.c:70</a></div></div>
<div class="ttc" id="astructrun__params_html_a471bfa4a039482a292c09f018ea2f2ae"><div class="ttname"><a href="structrun__params.html#a471bfa4a039482a292c09f018ea2f2ae">run_params::TreeGravOn</a></div><div class="ttdeci">int TreeGravOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00065">run.c:65</a></div></div>
<div class="ttc" id="astructrun__params_html_a48d90739b5988d26747a1888c541d14f"><div class="ttname"><a href="structrun__params.html#a48d90739b5988d26747a1888c541d14f">run_params::Asmth</a></div><div class="ttdeci">double Asmth</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00092">run.c:92</a></div></div>
<div class="ttc" id="astructrun__params_html_a5b739219a9e9cb1042bb7ab2e28bce98"><div class="ttname"><a href="structrun__params.html#a5b739219a9e9cb1042bb7ab2e28bce98">run_params::HydroOn</a></div><div class="ttdeci">int HydroOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00063">run.c:63</a></div></div>
<div class="ttc" id="astructrun__params_html_a746498a1812101686266ebbbb6092084"><div class="ttname"><a href="structrun__params.html#a746498a1812101686266ebbbb6092084">run_params::TimeBetweenSeedingSearch</a></div><div class="ttdeci">double TimeBetweenSeedingSearch</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00081">run.c:81</a></div></div>
<div class="ttc" id="astructrun__params_html_a85b52634ccdd3e7a004e905271c910c8"><div class="ttname"><a href="structrun__params.html#a85b52634ccdd3e7a004e905271c910c8">run_params::FOFFileBase</a></div><div class="ttdeci">char FOFFileBase[100]</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00097">run.c:97</a></div></div>
<div class="ttc" id="astructrun__params_html_a8fa89d593f6e712a572c0f103111837e"><div class="ttname"><a href="structrun__params.html#a8fa89d593f6e712a572c0f103111837e">run_params::Nmesh</a></div><div class="ttdeci">int Nmesh</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00085">run.c:85</a></div></div>
<div class="ttc" id="astructrun__params_html_a97fe2321295536715f83b483210d6edb"><div class="ttname"><a href="structrun__params.html#a97fe2321295536715f83b483210d6edb">run_params::MetalReturnOn</a></div><div class="ttdeci">int MetalReturnOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00069">run.c:69</a></div></div>
<div class="ttc" id="astructrun__params_html_aafd6db3a251356bc8056dce8860f9d9d"><div class="ttname"><a href="structrun__params.html#aafd6db3a251356bc8056dce8860f9d9d">run_params::SnapshotWithFOF</a></div><div class="ttdeci">int SnapshotWithFOF</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00099">run.c:99</a></div></div>
<div class="ttc" id="astructrun__params_html_ab19d5268dd01d7a2ac48489c0cb0df95"><div class="ttname"><a href="structrun__params.html#ab19d5268dd01d7a2ac48489c0cb0df95">run_params::SlotsIncreaseFactor</a></div><div class="ttdeci">double SlotsIncreaseFactor</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00047">run.c:47</a></div></div>
<div class="ttc" id="astructrun__params_html_ab9316029bbb13493628c2c3ad897f7c5"><div class="ttname"><a href="structrun__params.html#ab9316029bbb13493628c2c3ad897f7c5">run_params::PairwiseActiveFraction</a></div><div class="ttdeci">double PairwiseActiveFraction</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00077">run.c:77</a></div></div>
<div class="ttc" id="astructrun__params_html_ad0886392c89d4ea973eb708d39108303"><div class="ttname"><a href="structrun__params.html#ad0886392c89d4ea973eb708d39108303">run_params::AutoSnapshotTime</a></div><div class="ttdeci">double AutoSnapshotTime</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00080">run.c:80</a></div></div>
<div class="ttc" id="astructrun__params_html_ae8339c67fd53fd55a040096664460677"><div class="ttname"><a href="structrun__params.html#ae8339c67fd53fd55a040096664460677">run_params::CoolingOn</a></div><div class="ttdeci">int CoolingOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00062">run.c:62</a></div></div>
<div class="ttc" id="astructrun__params_html_aeec2f3fb137005a99bd885ca48d10aba"><div class="ttname"><a href="structrun__params.html#aeec2f3fb137005a99bd885ca48d10aba">run_params::TimeMax</a></div><div class="ttdeci">double TimeMax</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00083">run.c:83</a></div></div>
<div class="ttc" id="astructrun__params_html_af9672552972da4d3e660b94e9bb5041c"><div class="ttname"><a href="structrun__params.html#af9672552972da4d3e660b94e9bb5041c">run_params::StarformationOn</a></div><div class="ttdeci">int StarformationOn</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00068">run.c:68</a></div></div>
<div class="ttc" id="astructrun__params_html_afaa0f8c8fbf3117e10ecfcfcbf4085b9"><div class="ttname"><a href="structrun__params.html#afaa0f8c8fbf3117e10ecfcfcbf4085b9">run_params::MaxDomainTimeBinDepth</a></div><div class="ttdeci">int MaxDomainTimeBinDepth</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00073">run.c:73</a></div></div>
<div class="ttc" id="astructrun__params_html_afef2bc48cc8a7c5efa4f22dca697281c"><div class="ttname"><a href="structrun__params.html#afef2bc48cc8a7c5efa4f22dca697281c">run_params::OutputDir</a></div><div class="ttdeci">char OutputDir[100]</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00096">run.c:96</a></div></div>
<div class="ttc" id="astructslot__info_html_a29b1b6c4eae612eca7f1125a0c854436"><div class="ttname"><a href="structslot__info.html#a29b1b6c4eae612eca7f1125a0c854436">slot_info::enabled</a></div><div class="ttdeci">int enabled</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00014">slotsmanager.h:14</a></div></div>
<div class="ttc" id="astructslot__info_html_aa651c4c7d01687a0b313076c0266465f"><div class="ttname"><a href="structslot__info.html#aa651c4c7d01687a0b313076c0266465f">slot_info::size</a></div><div class="ttdeci">int64_t size</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00012">slotsmanager.h:12</a></div></div>
<div class="ttc" id="astructslots__manager__type_html_a2b662d46902bf6fffca8b3fa2534a4e4"><div class="ttname"><a href="structslots__manager__type.html#a2b662d46902bf6fffca8b3fa2534a4e4">slots_manager_type::info</a></div><div class="ttdeci">struct slot_info info[6]</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00108">slotsmanager.h:112</a></div></div>
<div class="ttc" id="astructsph__particle__data_html"><div class="ttname"><a href="structsph__particle__data.html">sph_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00079">slotsmanager.h:80</a></div></div>
<div class="ttc" id="astructsph__pred__data_html"><div class="ttname"><a href="structsph__pred__data.html">sph_pred_data</a></div><div class="ttdef"><b>Definition:</b> <a href="density_8h_source.html#l00025">density.h:26</a></div></div>
<div class="ttc" id="astructstar__particle__data_html"><div class="ttname"><a href="structstar__particle__data.html">star_particle_data</a></div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8h_source.html#l00063">slotsmanager.h:64</a></div></div>
<div class="ttc" id="asystem_8c_html_a3b4cc1b74fe2de47b0090b2ad113a9fd"><div class="ttname"><a href="system_8c.html#a3b4cc1b74fe2de47b0090b2ad113a9fd">MPIU_write_pids</a></div><div class="ttdeci">void MPIU_write_pids(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00552">system.c:552</a></div></div>
<div class="ttc" id="asystem_8c_html_a8b72dc2f38f4ed61f16276a9c12bbe87"><div class="ttname"><a href="system_8c.html#a8b72dc2f38f4ed61f16276a9c12bbe87">set_random_numbers</a></div><div class="ttdeci">void set_random_numbers(int seed)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00065">system.c:65</a></div></div>
<div class="ttc" id="asystem_8h_html_a2ca58d338cd52c808ec1a86073940c49"><div class="ttname"><a href="system_8h.html#a2ca58d338cd52c808ec1a86073940c49">MPIU_Barrier</a></div><div class="ttdeci">#define MPIU_Barrier(comm)</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00103">system.h:103</a></div></div>
<div class="ttc" id="asystem_8h_html_abb95c0be39c73f8e6b0978a9a374d92b"><div class="ttname"><a href="system_8h.html#abb95c0be39c73f8e6b0978a9a374d92b">MPI_INT64</a></div><div class="ttdeci">#define MPI_INT64</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00012">system.h:12</a></div></div>
<div class="ttc" id="atest__exchange_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="test__exchange_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="test__exchange_8c_source.html#l00023">test_exchange.c:23</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a4a7f3606a4cb958089f232db3fc51dd2"><div class="ttname"><a href="timebinmgr_8c.html#a4a7f3606a4cb958089f232db3fc51dd2">find_next_sync_point</a></div><div class="ttdeci">SyncPoint * find_next_sync_point(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00174">timebinmgr.c:174</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_a716e51b694540af2851fb51c081bcf5d"><div class="ttname"><a href="timebinmgr_8c.html#a716e51b694540af2851fb51c081bcf5d">get_dloga_for_bin</a></div><div class="ttdeci">double get_dloga_for_bin(int timebin, const inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00279">timebinmgr.c:279</a></div></div>
<div class="ttc" id="atimebinmgr_8c_html_aa1c832d9a92b9e906dbae0c9a7be298c"><div class="ttname"><a href="timebinmgr_8c.html#aa1c832d9a92b9e906dbae0c9a7be298c">find_current_sync_point</a></div><div class="ttdeci">SyncPoint * find_current_sync_point(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00188">timebinmgr.c:188</a></div></div>
<div class="ttc" id="atimefac_8h_html"><div class="ttname"><a href="timefac_8h.html">timefac.h</a></div></div>
<div class="ttc" id="atimestep_8c_html_a02c7db8f2f113f9e606ec6a500074f8c"><div class="ttname"><a href="timestep_8c.html#a02c7db8f2f113f9e606ec6a500074f8c">apply_PM_half_kick</a></div><div class="ttdeci">void apply_PM_half_kick(Cosmology *CP, DriftKickTimes *times)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00373">timestep.c:373</a></div></div>
<div class="ttc" id="atimestep_8c_html_a1da56439eb88b453b1ae0122f15d8dc1"><div class="ttname"><a href="timestep_8c.html#a1da56439eb88b453b1ae0122f15d8dc1">is_PM_timestep</a></div><div class="ttdeci">int is_PM_timestep(const DriftKickTimes *const times)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00160">timestep.c:160</a></div></div>
<div class="ttc" id="atimestep_8c_html_a359495157e1978aa5922615da9432a4d"><div class="ttname"><a href="timestep_8c.html#a359495157e1978aa5922615da9432a4d">get_atime</a></div><div class="ttdeci">double get_atime(const inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00168">timestep.c:168</a></div></div>
<div class="ttc" id="atimestep_8c_html_a46b8fcbd4991e9d216fc8825d5bdfb36"><div class="ttname"><a href="timestep_8c.html#a46b8fcbd4991e9d216fc8825d5bdfb36">init_driftkicktime</a></div><div class="ttdeci">DriftKickTimes init_driftkicktime(inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00133">timestep.c:133</a></div></div>
<div class="ttc" id="atimestep_8c_html_a7f8bb9951920bdc3a2138d91f1cfc61c"><div class="ttname"><a href="timestep_8c.html#a7f8bb9951920bdc3a2138d91f1cfc61c">find_timesteps</a></div><div class="ttdeci">int find_timesteps(const ActiveParticles *act, DriftKickTimes *times, const double atime, int FastParticleType, const Cosmology *CP, const double asmth, const int isFirstTimeStep)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00176">timestep.c:176</a></div></div>
<div class="ttc" id="atimestep_8c_html_a8102740bf0615adc840060e1101d6d3e"><div class="ttname"><a href="timestep_8c.html#a8102740bf0615adc840060e1101d6d3e">rebuild_activelist</a></div><div class="ttdeci">int rebuild_activelist(ActiveParticles *act, const DriftKickTimes *const times, int NumCurrentTiStep, const double Time)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00721">timestep.c:721</a></div></div>
<div class="ttc" id="atimestep_8c_html_a896d6e80e5dd9d14008709479a0f8a66"><div class="ttname"><a href="timestep_8c.html#a896d6e80e5dd9d14008709479a0f8a66">is_timebin_active</a></div><div class="ttdeci">int is_timebin_active(int i, inttime_t current)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00149">timestep.c:149</a></div></div>
<div class="ttc" id="atimestep_8c_html_a8cd9d7c91611cbf3493edfa7d5491be9"><div class="ttname"><a href="timestep_8c.html#a8cd9d7c91611cbf3493edfa7d5491be9">apply_half_kick</a></div><div class="ttdeci">void apply_half_kick(const ActiveParticles *act, Cosmology *CP, DriftKickTimes *times, const double atime, const double MinEgySpec)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00323">timestep.c:323</a></div></div>
<div class="ttc" id="atimestep_8c_html_aa7119c29751fcd9275f395e6ea08965f"><div class="ttname"><a href="timestep_8c.html#aa7119c29751fcd9275f395e6ea08965f">find_next_kick</a></div><div class="ttdeci">inttime_t find_next_kick(inttime_t Ti_Current, int minTimeBin)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00712">timestep.c:712</a></div></div>
<div class="ttc" id="atimestep_8c_html_ace9e5cdcc776609e46189b2268155ca7"><div class="ttname"><a href="timestep_8c.html#ace9e5cdcc776609e46189b2268155ca7">update_lastactive_drift</a></div><div class="ttdeci">void update_lastactive_drift(DriftKickTimes *times)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00309">timestep.c:309</a></div></div>
<div class="ttc" id="atimestep_8c_html_aec3f9fb84aa5cda053a144da6588ffcd"><div class="ttname"><a href="timestep_8c.html#aec3f9fb84aa5cda053a144da6588ffcd">free_activelist</a></div><div class="ttdeci">void free_activelist(ActiveParticles *act)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00795">timestep.c:795</a></div></div>
<div class="ttc" id="atimestep_8h_html"><div class="ttname"><a href="timestep_8h.html">timestep.h</a></div></div>
<div class="ttc" id="atypes_8h_html_ab7f8779710efa655135cf9cbee3137a7"><div class="ttname"><a href="types_8h.html#ab7f8779710efa655135cf9cbee3137a7">inttime_t</a></div><div class="ttdeci">int32_t inttime_t</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00008">types.h:8</a></div></div>
<div class="ttc" id="atypes_8h_html_af1ada7381a1118c6d51bdbb0b5e72811"><div class="ttname"><a href="types_8h.html#af1ada7381a1118c6d51bdbb0b5e72811">MyFloat</a></div><div class="ttdeci">LOW_PRECISION MyFloat</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00019">types.h:19</a></div></div>
<div class="ttc" id="aunitsystem_8c_html_a8e84fa363556fc79a5cf9f70e381c6be"><div class="ttname"><a href="unitsystem_8c.html#a8e84fa363556fc79a5cf9f70e381c6be">get_unitsystem</a></div><div class="ttdeci">struct UnitSystem get_unitsystem(double UnitLength_in_cm, double UnitMass_in_g, double UnitVelocity_in_cm_per_s)</div><div class="ttdef"><b>Definition:</b> <a href="unitsystem_8c_source.html#l00001">unitsystem.c:6</a></div></div>
<div class="ttc" id="autils_8h_html"><div class="ttname"><a href="utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="awalltime_8c_html_a03a816f38593bc4adf06efed9fe49697"><div class="ttname"><a href="walltime_8c.html#a03a816f38593bc4adf06efed9fe49697">walltime_init</a></div><div class="ttdeci">void walltime_init(struct ClockTable *ct)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8c_source.html#l00019">walltime.c:19</a></div></div>
<div class="ttc" id="awalltime_8h_html"><div class="ttname"><a href="walltime_8h.html">walltime.h</a></div></div>
<div class="ttc" id="awalltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00008">walltime.h:8</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
